
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Config
    None




.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ###################5                                                            9750/40000 [00:00<00:00, 97497.54it/s]
    Packets:   ########################################1                                       20078/40000 [00:00<00:00, 100883.58it/s]
    Packets:   ############################################################6                   30306/40000 [00:00<00:00, 101515.35it/s]    Iterations:####                                                                            1/20 [00:00<00:08,  2.32it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.88e+03  0.105  0.0868
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.88e+03  0.105  0.0868

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################6                                                           10348/40000 [00:00<00:00, 103461.11it/s]
    Packets:   #########################################3                                      20696/40000 [00:00<00:00, 99760.72it/s] 
    Packets:   #############################################################3                  30682/40000 [00:00<00:00, 97507.45it/s]    Iterations:########                                                                        2/20 [00:01<00:10,  1.80it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.796e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.796e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.224 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.88e+03    1.1e+04  0.0868  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.224 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.88e+03    1.1e+04  0.0868  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9959.544 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9959.544 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################2                                                           10112/40000 [00:00<00:00, 101113.59it/s]
    Packets:   ########################################5                                       20300/40000 [00:00<00:00, 101557.48it/s]
    Packets:   #############################################################4                  30716/40000 [00:00<00:00, 102745.16it/s]    Iterations:############                                                                    3/20 [00:01<00:09,  1.70it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.173e+42 erg / s
            Luminosity absorbed  = 2.543e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.173e+42 erg / s
            Luminosity absorbed  = 2.543e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.438
            5         1.15e+04   1.08e+04  0.224   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0775
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.438
            5         1.15e+04   1.08e+04  0.224   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0775

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9959.544 K
            Expected t_inner for next iteration = 11338.681 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9959.544 K
            Expected t_inner for next iteration = 11338.681 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################5                                                           10276/40000 [00:00<00:00, 100186.58it/s]
    Packets:   ########################################7                                       20364/40000 [00:00<00:00, 100587.61it/s]
    Packets:   #############################################################                   30524/40000 [00:00<00:00, 101044.44it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.357e+43 erg / s
            Luminosity absorbed  = 4.426e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.357e+43 erg / s
            Luminosity absorbed  = 4.426e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.438   0.497
            5         1.08e+04   1.17e+04   0.166     0.2
            10        1.06e+04   1.14e+04   0.102   0.128
            15        1.02e+04   1.11e+04  0.0775  0.0946
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.438   0.497
            5         1.08e+04   1.17e+04   0.166     0.2
            10        1.06e+04   1.14e+04   0.102   0.128
            15        1.02e+04   1.11e+04  0.0775  0.0946

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11338.681 K
            Expected t_inner for next iteration = 10019.189 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11338.681 K
            Expected t_inner for next iteration = 10019.189 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################6                                                           10314/40000 [00:00<00:00, 103131.98it/s]
    Packets:   #########################################2                                      20628/40000 [00:00<00:00, 102532.25it/s]
    Packets:   ##############################################################4                 31208/40000 [00:00<00:00, 104011.95it/s]    Iterations:####################                                                            5/20 [00:02<00:09,  1.64it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.319e+42 erg / s
            Luminosity absorbed  = 2.651e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.319e+42 erg / s
            Luminosity absorbed  = 2.651e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.497   0.446
            5         1.17e+04   1.09e+04     0.2   0.163
            10        1.14e+04   1.07e+04   0.128   0.102
            15        1.11e+04   1.04e+04  0.0946  0.0762
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.497   0.446
            5         1.17e+04   1.09e+04     0.2   0.163
            10        1.14e+04   1.07e+04   0.128   0.102
            15        1.11e+04   1.04e+04  0.0946  0.0762

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10019.189 K
            Expected t_inner for next iteration = 11305.508 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10019.189 K
            Expected t_inner for next iteration = 11305.508 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################8                                                           10402/40000 [00:00<00:00, 102783.79it/s]
    Packets:   #########################################3                                      20682/40000 [00:00<00:00, 101321.51it/s]
    Packets:   #############################################################9                  30992/40000 [00:00<00:00, 102122.14it/s]    Iterations:########################                                                        6/20 [00:03<00:08,  1.62it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.333e+43 erg / s
            Luminosity absorbed  = 4.445e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.333e+43 erg / s
            Luminosity absorbed  = 4.445e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.446     0.5
            5         1.09e+04   1.16e+04   0.163   0.204
            10        1.07e+04   1.14e+04   0.102   0.124
            15        1.04e+04    1.1e+04  0.0762  0.0948
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.446     0.5
            5         1.09e+04   1.16e+04   0.163   0.204
            10        1.07e+04   1.14e+04   0.102   0.124
            15        1.04e+04    1.1e+04  0.0762  0.0948

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11305.508 K
            Expected t_inner for next iteration = 10077.391 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11305.508 K
            Expected t_inner for next iteration = 10077.391 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################4                                                           10214/40000 [00:00<00:00, 100262.40it/s]
    Packets:   ########################################8                                       20436/40000 [00:00<00:00, 101403.91it/s]
    Packets:   #############################################################2                  30604/40000 [00:00<00:00, 101522.89it/s]    Iterations:############################                                                    7/20 [00:04<00:08,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.545e+42 erg / s
            Luminosity absorbed  = 2.687e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.545e+42 erg / s
            Luminosity absorbed  = 2.687e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04     0.5   0.443
            5         1.16e+04    1.1e+04   0.204   0.164
            10        1.14e+04   1.08e+04   0.124   0.101
            15         1.1e+04   1.04e+04  0.0948  0.0759
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04     0.5   0.443
            5         1.16e+04    1.1e+04   0.204   0.164
            10        1.14e+04   1.08e+04   0.124   0.101
            15         1.1e+04   1.04e+04  0.0948  0.0759

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10077.391 K
            Expected t_inner for next iteration = 11219.973 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10077.391 K
            Expected t_inner for next iteration = 11219.973 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################3                                                           10154/40000 [00:00<00:00, 97160.76it/s]
    Packets:   ########################################9                                       20454/40000 [00:00<00:00, 98352.24it/s]
    Packets:   #############################################################6                  30820/40000 [00:00<00:00, 100689.47it/s]    Iterations:################################                                                8/20 [00:04<00:07,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.191e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.191e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.443   0.505
            5          1.1e+04   1.16e+04   0.164   0.201
            10        1.08e+04   1.14e+04   0.101   0.123
            15        1.04e+04    1.1e+04  0.0759  0.0941
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.443   0.505
            5          1.1e+04   1.16e+04   0.164   0.201
            10        1.08e+04   1.14e+04   0.101   0.123
            15        1.04e+04    1.1e+04  0.0759  0.0941

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11219.973 K
            Expected t_inner for next iteration = 10104.611 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11219.973 K
            Expected t_inner for next iteration = 10104.611 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################1                                                           10076/40000 [00:00<00:00, 94992.98it/s]
    Packets:   ##########################################5                                     21276/40000 [00:00<00:00, 104746.16it/s]
    Packets:   ###############################################################5                31776/40000 [00:00<00:00, 101974.36it/s]    Iterations:####################################                                            9/20 [00:05<00:06,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.588e+42 erg / s
            Luminosity absorbed  = 2.762e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.588e+42 erg / s
            Luminosity absorbed  = 2.762e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.505   0.447
            5         1.16e+04    1.1e+04   0.201   0.164
            10        1.14e+04   1.09e+04   0.123  0.0986
            15         1.1e+04   1.05e+04  0.0941  0.0746
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.505   0.447
            5         1.16e+04    1.1e+04   0.201   0.164
            10        1.14e+04   1.09e+04   0.123  0.0986
            15         1.1e+04   1.05e+04  0.0941  0.0746

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10104.611 K
            Expected t_inner for next iteration = 11222.046 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10104.611 K
            Expected t_inner for next iteration = 11222.046 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################4                                                           10218/40000 [00:00<00:00, 99206.48it/s]
    Packets:   #########################################4                                      20744/40000 [00:00<00:00, 102720.46it/s]
    Packets:   ##############################################################                  31042/40000 [00:00<00:00, 102834.89it/s]    Iterations:########################################                                        10/20 [00:06<00:06,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.309e+43 erg / s
            Luminosity absorbed  = 4.176e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.309e+43 erg / s
            Luminosity absorbed  = 4.176e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.447    0.51
            5          1.1e+04   1.17e+04   0.164   0.196
            10        1.09e+04   1.15e+04  0.0986   0.121
            15        1.05e+04   1.11e+04  0.0746  0.0908
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.447    0.51
            5          1.1e+04   1.17e+04   0.164   0.196
            10        1.09e+04   1.15e+04  0.0986   0.121
            15        1.05e+04   1.11e+04  0.0746  0.0908

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11222.046 K
            Expected t_inner for next iteration = 10095.470 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11222.046 K
            Expected t_inner for next iteration = 10095.470 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################6                                                           10324/40000 [00:00<00:00, 103237.64it/s]
    Packets:   #########################################4                                      20706/40000 [00:00<00:00, 103571.40it/s]
    Packets:   ##############################################################1                 31096/40000 [00:00<00:00, 103715.72it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.575e+42 erg / s
            Luminosity absorbed  = 2.734e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.575e+42 erg / s
            Luminosity absorbed  = 2.734e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04    0.51   0.452
            5         1.17e+04    1.1e+04   0.196   0.163
            10        1.15e+04   1.08e+04   0.121     0.1
            15        1.11e+04   1.04e+04  0.0908  0.0759
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04    0.51   0.452
            5         1.17e+04    1.1e+04   0.196   0.163
            10        1.15e+04   1.08e+04   0.121     0.1
            15        1.11e+04   1.04e+04  0.0908  0.0759

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10095.470 K
            Expected t_inner for next iteration = 11220.298 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10095.470 K
            Expected t_inner for next iteration = 11220.298 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################9                                                           10452/40000 [00:00<00:00, 104486.47it/s]
    Packets:   #########################################8                                      20928/40000 [00:00<00:00, 104645.21it/s]
    Packets:   ##############################################################9                 31488/40000 [00:00<00:00, 105076.50it/s]    Iterations:################################################                                12/20 [00:07<00:04,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.300e+43 erg / s
            Luminosity absorbed  = 4.246e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.300e+43 erg / s
            Luminosity absorbed  = 4.246e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.452   0.492
            5          1.1e+04   1.17e+04   0.163   0.192
            10        1.08e+04   1.14e+04     0.1   0.122
            15        1.04e+04   1.11e+04  0.0759  0.0899
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.452   0.492
            5          1.1e+04   1.17e+04   0.163   0.192
            10        1.08e+04   1.14e+04     0.1   0.122
            15        1.04e+04   1.11e+04  0.0759  0.0899

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11220.298 K
            Expected t_inner for next iteration = 10127.486 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11220.298 K
            Expected t_inner for next iteration = 10127.486 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################                                                           10508/40000 [00:00<00:00, 95550.77it/s]
    Packets:   ########################################7                                       20364/40000 [00:00<00:00, 97248.77it/s]
    Packets:   #############################################################2                  30640/40000 [00:00<00:00, 99710.08it/s]    Iterations:####################################################                            13/20 [00:07<00:04,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.726e+42 erg / s
            Luminosity absorbed  = 2.728e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.726e+42 erg / s
            Luminosity absorbed  = 2.728e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.492   0.439
            5         1.17e+04    1.1e+04   0.192   0.165
            10        1.14e+04   1.08e+04   0.122   0.102
            15        1.11e+04   1.04e+04  0.0899  0.0791
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.492   0.439
            5         1.17e+04    1.1e+04   0.192   0.165
            10        1.14e+04   1.08e+04   0.122   0.102
            15        1.11e+04   1.04e+04  0.0899  0.0791

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10127.486 K
            Expected t_inner for next iteration = 11158.284 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10127.486 K
            Expected t_inner for next iteration = 11158.284 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################8                                                           10416/40000 [00:00<00:00, 104148.68it/s]
    Packets:   #########################################6                                      20832/40000 [00:00<00:00, 104007.06it/s]
    Packets:   ##############################################################7                 31358/40000 [00:00<00:00, 104577.51it/s]    Iterations:########################################################                        14/20 [00:08<00:03,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.278e+43 erg / s
            Luminosity absorbed  = 4.100e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.278e+43 erg / s
            Luminosity absorbed  = 4.100e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.439  0.492 
            5          1.1e+04   1.16e+04   0.165  0.194 
            10        1.08e+04   1.13e+04   0.102  0.122 
            15        1.04e+04    1.1e+04  0.0791  0.092 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.439  0.492 
            5          1.1e+04   1.16e+04   0.165  0.194 
            10        1.08e+04   1.13e+04   0.102  0.122 
            15        1.04e+04    1.1e+04  0.0791  0.092 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11158.284 K
            Expected t_inner for next iteration = 10158.782 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11158.284 K
            Expected t_inner for next iteration = 10158.782 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################9                                                           10458/40000 [00:00<00:00, 103333.97it/s]
    Packets:   #########################################6                                      20810/40000 [00:00<00:00, 103437.29it/s]
    Packets:   ##############################################################3                 31194/40000 [00:00<00:00, 103616.33it/s]    Iterations:############################################################                    15/20 [00:09<00:03,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.764e+42 erg / s
            Luminosity absorbed  = 2.832e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.764e+42 erg / s
            Luminosity absorbed  = 2.832e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.492   0.449
            5         1.16e+04    1.1e+04  0.194   0.162
            10        1.13e+04   1.08e+04  0.122   0.101
            15         1.1e+04   1.04e+04  0.092  0.0788
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.492   0.449
            5         1.16e+04    1.1e+04  0.194   0.162
            10        1.13e+04   1.08e+04  0.122   0.101
            15         1.1e+04   1.04e+04  0.092  0.0788

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10158.782 K
            Expected t_inner for next iteration = 11168.389 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10158.782 K
            Expected t_inner for next iteration = 11168.389 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################                                                           10508/40000 [00:00<00:00, 105047.79it/s]
    Packets:   ##########################################                                      21014/40000 [00:00<00:00, 105010.41it/s]
    Packets:   ###############################################################                 31516/40000 [00:00<00:00, 104530.54it/s]    Iterations:################################################################                16/20 [00:09<00:02,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.276e+43 erg / s
            Luminosity absorbed  = 4.173e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.276e+43 erg / s
            Luminosity absorbed  = 4.173e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.449   0.499
            5          1.1e+04   1.16e+04   0.162   0.191
            10        1.08e+04   1.14e+04   0.101   0.121
            15        1.04e+04    1.1e+04  0.0788  0.0901
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.449   0.499
            5          1.1e+04   1.16e+04   0.162   0.191
            10        1.08e+04   1.14e+04   0.101   0.121
            15        1.04e+04    1.1e+04  0.0788  0.0901

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11168.389 K
            Expected t_inner for next iteration = 10174.510 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11168.389 K
            Expected t_inner for next iteration = 10174.510 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################9                                                           10454/40000 [00:00<00:00, 102486.13it/s]
    Packets:   #########################################4                                      20704/40000 [00:00<00:00, 99397.65it/s] 
    Packets:   #############################################################2                  30648/40000 [00:00<00:00, 98227.55it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.857e+42 erg / s
            Luminosity absorbed  = 2.812e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.857e+42 erg / s
            Luminosity absorbed  = 2.812e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.499   0.447
            5         1.16e+04   1.11e+04   0.191   0.161
            10        1.14e+04   1.09e+04   0.121  0.0991
            15         1.1e+04   1.05e+04  0.0901  0.0761
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.499   0.447
            5         1.16e+04   1.11e+04   0.191   0.161
            10        1.14e+04   1.09e+04   0.121  0.0991
            15         1.1e+04   1.05e+04  0.0901  0.0761

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10174.510 K
            Expected t_inner for next iteration = 11127.192 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10174.510 K
            Expected t_inner for next iteration = 11127.192 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #####################                                                           10540/40000 [00:00<00:00, 105384.52it/s]
    Packets:   ##########################################1                                     21080/40000 [00:00<00:00, 101608.76it/s]
    Packets:   ##############################################################5                 31252/40000 [00:00<00:00, 100617.71it/s]    Iterations:########################################################################        18/20 [00:11<00:01,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.259e+43 erg / s
            Luminosity absorbed  = 4.099e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.259e+43 erg / s
            Luminosity absorbed  = 4.099e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.447   0.494
            5         1.11e+04   1.16e+04   0.161    0.19
            10        1.09e+04   1.14e+04  0.0991   0.117
            15        1.05e+04    1.1e+04  0.0761  0.0905
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.447   0.494
            5         1.11e+04   1.16e+04   0.161    0.19
            10        1.09e+04   1.14e+04  0.0991   0.117
            15        1.05e+04    1.1e+04  0.0761  0.0905

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11127.192 K
            Expected t_inner for next iteration = 10206.949 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11127.192 K
            Expected t_inner for next iteration = 10206.949 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################7                                                           10354/40000 [00:00<00:00, 103529.24it/s]
    Packets:   #########################################4                                      20708/40000 [00:00<00:00, 101474.86it/s]
    Packets:   ##############################################################                  31002/40000 [00:00<00:00, 102133.08it/s]    Iterations:############################################################################    19/20 [00:11<00:00,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.952e+42 erg / s
            Luminosity absorbed  = 2.864e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.952e+42 erg / s
            Luminosity absorbed  = 2.864e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.494   0.445
            5         1.16e+04   1.11e+04    0.19    0.16
            10        1.14e+04    1.1e+04   0.117  0.0984
            15         1.1e+04   1.04e+04  0.0905   0.079
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.494   0.445
            5         1.16e+04   1.11e+04    0.19    0.16
            10        1.14e+04    1.1e+04   0.117  0.0984
            15         1.1e+04   1.04e+04  0.0905   0.079

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10206.949 K
            Expected t_inner for next iteration = 11102.806 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10206.949 K
            Expected t_inner for next iteration = 11102.806 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]               
    Packets:   ########1                                                                       10216/100000 [00:00<00:02, 36677.13it/s]
    Packets:   ###########1                                                                    13884/100000 [00:00<00:02, 36045.61it/s]
    Packets:   #############9                                                                  17446/100000 [00:00<00:02, 35660.66it/s]
    Packets:   ################7                                                               20974/100000 [00:00<00:02, 35442.04it/s]
    Packets:   ###################6                                                            24532/100000 [00:00<00:02, 35484.16it/s]
    Packets:   ######################4                                                         28064/100000 [00:00<00:02, 35432.55it/s]
    Packets:   #########################3                                                      31668/100000 [00:00<00:01, 35601.08it/s]
    Packets:   ############################1                                                   35222/100000 [00:00<00:01, 35558.91it/s]
    Packets:   ###############################                                                 38866/100000 [00:01<00:01, 35822.36it/s]
    Packets:   #################################9                                              42446/100000 [00:01<00:01, 35751.89it/s]
    Packets:   ####################################9                                           46146/100000 [00:01<00:01, 36119.53it/s]
    Packets:   #######################################8                                        49758/100000 [00:01<00:01, 35910.35it/s]
    Packets:   ##########################################7                                     53438/100000 [00:01<00:01, 36173.93it/s]
    Packets:   #############################################6                                  57056/100000 [00:01<00:01, 35748.17it/s]
    Packets:   ################################################5                               60646/100000 [00:01<00:01, 35768.61it/s]
    Packets:   ###################################################3                            64246/100000 [00:01<00:00, 35831.39it/s]
    Packets:   ######################################################2                         67874/100000 [00:01<00:00, 35755.91it/s]
    Packets:   #########################################################2                      71504/100000 [00:01<00:00, 35917.36it/s]
    Packets:   ############################################################                    75098/100000 [00:02<00:00, 35895.73it/s]
    Packets:   ##############################################################9                 78688/100000 [00:02<00:00, 35799.00it/s]
    Packets:   #################################################################8              82274/100000 [00:02<00:00, 35813.32it/s]
    Packets:   ####################################################################6           85856/100000 [00:02<00:00, 35702.10it/s]
    Packets:   ########################################################################1       90162/100000 [00:02<00:00, 37898.46it/s]
    Packets:   ###########################################################################9    94910/100000 [00:02<00:00, 40761.04it/s]
    Packets:   ###############################################################################899818/100000 [00:02<00:00, 43248.24it/s]    Iterations:################################################################################20/20 [00:14<00:00,  1.41s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.244e+43 erg / s
            Luminosity absorbed  = 4.095e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.244e+43 erg / s
            Luminosity absorbed  = 4.095e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 43.92 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 43.92 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:17<00:00, 43248.24it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  55.761 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
