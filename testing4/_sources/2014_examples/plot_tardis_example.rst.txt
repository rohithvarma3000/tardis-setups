
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Config
    None




.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ##################4                                                             9216/40000 [00:00<00:00, 92142.95it/s]
    Packets:   ######################################1                                         19088/40000 [00:00<00:00, 96002.41it/s]
    Packets:   #########################################################6                      28832/40000 [00:00<00:00, 96654.19it/s]    Iterations:####                                                                            1/20 [00:00<00:08,  2.27it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0868
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0868

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################8                                                            9908/40000 [00:00<00:00, 99064.27it/s]
    Packets:   #######################################6                                        19816/40000 [00:00<00:00, 98329.36it/s]
    Packets:   ###########################################################4                    29718/40000 [00:00<00:00, 98636.94it/s]    Iterations:########                                                                        2/20 [00:01<00:09,  1.84it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.793e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.793e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0868  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0868  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9958.523 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9958.523 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9866/40000 [00:00<00:00, 97467.06it/s]
    Packets:   #######################################2                                        19614/40000 [00:00<00:00, 96656.79it/s]
    Packets:   ##########################################################5                     29284/40000 [00:00<00:00, 96672.34it/s]    Iterations:############                                                                    3/20 [00:01<00:09,  1.73it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.166e+42 erg / s
            Luminosity absorbed  = 2.545e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.166e+42 erg / s
            Luminosity absorbed  = 2.545e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.442
            5         1.15e+04   1.08e+04  0.223   0.165
            10        1.13e+04   1.07e+04  0.135   0.101
            15         1.1e+04   1.03e+04  0.101  0.0766
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.442
            5         1.15e+04   1.08e+04  0.223   0.165
            10        1.13e+04   1.07e+04  0.135   0.101
            15         1.1e+04   1.03e+04  0.101  0.0766

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9958.523 K
            Expected t_inner for next iteration = 11342.316 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9958.523 K
            Expected t_inner for next iteration = 11342.316 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################4                                                           10222/40000 [00:00<00:00, 102218.15it/s]
    Packets:   #########################################1                                      20580/40000 [00:00<00:00, 103009.32it/s]
    Packets:   #############################################################7                  30882/40000 [00:00<00:00, 102926.73it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.71it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.456e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.456e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.442   0.497
            5         1.08e+04   1.17e+04   0.165   0.201
            10        1.07e+04   1.14e+04   0.101   0.126
            15        1.03e+04   1.11e+04  0.0766  0.0948
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.442   0.497
            5         1.08e+04   1.17e+04   0.165   0.201
            10        1.07e+04   1.14e+04   0.101   0.126
            15        1.03e+04   1.11e+04  0.0766  0.0948

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11342.316 K
            Expected t_inner for next iteration = 10025.445 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11342.316 K
            Expected t_inner for next iteration = 10025.445 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################5                                                           10294/40000 [00:00<00:00, 95292.90it/s]
    Packets:   #######################################6                                        19824/40000 [00:00<00:00, 94814.68it/s]
    Packets:   ##########################################################6                     29306/40000 [00:00<00:00, 94810.93it/s]    Iterations:####################                                                            5/20 [00:02<00:08,  1.67it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.320e+42 erg / s
            Luminosity absorbed  = 2.678e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.320e+42 erg / s
            Luminosity absorbed  = 2.678e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.497   0.447
            5         1.17e+04   1.09e+04   0.201   0.162
            10        1.14e+04   1.07e+04   0.126  0.0994
            15        1.11e+04   1.04e+04  0.0948  0.0755
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.497   0.447
            5         1.17e+04   1.09e+04   0.201   0.162
            10        1.14e+04   1.07e+04   0.126  0.0994
            15        1.11e+04   1.04e+04  0.0948  0.0755

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10025.445 K
            Expected t_inner for next iteration = 11312.139 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10025.445 K
            Expected t_inner for next iteration = 11312.139 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################5                                                            9784/40000 [00:00<00:00, 97821.44it/s]
    Packets:   #######################################6                                        19822/40000 [00:00<00:00, 99322.23it/s]
    Packets:   ###########################################################5                    29756/40000 [00:00<00:00, 99119.01it/s]    Iterations:########################                                                        6/20 [00:03<00:08,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.342e+43 erg / s
            Luminosity absorbed  = 4.401e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.342e+43 erg / s
            Luminosity absorbed  = 4.401e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.15e+04   0.447   0.507
            5         1.09e+04   1.16e+04   0.162   0.205
            10        1.07e+04   1.14e+04  0.0994   0.127
            15        1.04e+04    1.1e+04  0.0755  0.0953
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.15e+04   0.447   0.507
            5         1.09e+04   1.16e+04   0.162   0.205
            10        1.07e+04   1.14e+04  0.0994   0.127
            15        1.04e+04    1.1e+04  0.0755  0.0953

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11312.139 K
            Expected t_inner for next iteration = 10050.480 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11312.139 K
            Expected t_inner for next iteration = 10050.480 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################5                                                           10266/40000 [00:00<00:00, 102656.67it/s]
    Packets:   #########################################                                       20532/40000 [00:00<00:00, 101558.84it/s]
    Packets:   #############################################################3                  30690/40000 [00:00<00:00, 101089.82it/s]    Iterations:############################                                                    7/20 [00:04<00:07,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.418e+42 erg / s
            Luminosity absorbed  = 2.692e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.418e+42 erg / s
            Luminosity absorbed  = 2.692e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.507   0.444
            5         1.16e+04    1.1e+04   0.205   0.157
            10        1.14e+04   1.07e+04   0.127   0.102
            15         1.1e+04   1.03e+04  0.0953  0.0779
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.507   0.444
            5         1.16e+04    1.1e+04   0.205   0.157
            10        1.14e+04   1.07e+04   0.127   0.102
            15         1.1e+04   1.03e+04  0.0953  0.0779

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10050.480 K
            Expected t_inner for next iteration = 11274.028 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10050.480 K
            Expected t_inner for next iteration = 11274.028 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################4                                                           10240/40000 [00:00<00:00, 102393.51it/s]
    Packets:   ########################################9                                       20490/40000 [00:00<00:00, 102446.87it/s]
    Packets:   #############################################################6                  30826/40000 [00:00<00:00, 102856.67it/s]    Iterations:################################                                                8/20 [00:04<00:07,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.327e+43 erg / s
            Luminosity absorbed  = 4.315e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.327e+43 erg / s
            Luminosity absorbed  = 4.315e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.444   0.502
            5          1.1e+04   1.17e+04   0.157   0.196
            10        1.07e+04   1.15e+04   0.102   0.123
            15        1.03e+04   1.11e+04  0.0779  0.0925
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.444   0.502
            5          1.1e+04   1.17e+04   0.157   0.196
            10        1.07e+04   1.15e+04   0.102   0.123
            15        1.03e+04   1.11e+04  0.0779  0.0925

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11274.028 K
            Expected t_inner for next iteration = 10073.360 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11274.028 K
            Expected t_inner for next iteration = 10073.360 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################5                                                           10286/40000 [00:00<00:00, 100812.74it/s]
    Packets:   ########################################7                                       20368/40000 [00:00<00:00, 100498.48it/s]
    Packets:   ############################################################9                   30462/40000 [00:00<00:00, 100683.84it/s]    Iterations:####################################                                            9/20 [00:05<00:06,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.501e+42 erg / s
            Luminosity absorbed  = 2.709e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.501e+42 erg / s
            Luminosity absorbed  = 2.709e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.502    0.45
            5         1.17e+04    1.1e+04   0.196   0.163
            10        1.15e+04   1.08e+04   0.123   0.101
            15        1.11e+04   1.04e+04  0.0925  0.0753
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.502    0.45
            5         1.17e+04    1.1e+04   0.196   0.163
            10        1.15e+04   1.08e+04   0.123   0.101
            15        1.11e+04   1.04e+04  0.0925  0.0753

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10073.360 K
            Expected t_inner for next iteration = 11244.896 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10073.360 K
            Expected t_inner for next iteration = 11244.896 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################1                                                           10070/40000 [00:00<00:00, 98784.60it/s]
    Packets:   #######################################9                                        19950/40000 [00:00<00:00, 98784.57it/s]
    Packets:   ###########################################################6                    29838/40000 [00:00<00:00, 98826.39it/s]    Iterations:########################################                                        10/20 [00:05<00:06,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.311e+43 erg / s
            Luminosity absorbed  = 4.292e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.311e+43 erg / s
            Luminosity absorbed  = 4.292e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04    0.45   0.509
            5          1.1e+04   1.16e+04   0.163   0.197
            10        1.08e+04   1.15e+04   0.101   0.122
            15        1.04e+04    1.1e+04  0.0753  0.0945
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04    0.45   0.509
            5          1.1e+04   1.16e+04   0.163   0.197
            10        1.08e+04   1.15e+04   0.101   0.122
            15        1.04e+04    1.1e+04  0.0753  0.0945

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11244.896 K
            Expected t_inner for next iteration = 10107.559 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11244.896 K
            Expected t_inner for next iteration = 10107.559 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9884/40000 [00:00<00:00, 98153.95it/s]
    Packets:   #######################################5                                        19778/40000 [00:00<00:00, 98601.96it/s]
    Packets:   ###########################################################2                    29640/40000 [00:00<00:00, 98555.81it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.64it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.646e+42 erg / s
            Luminosity absorbed  = 2.720e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.646e+42 erg / s
            Luminosity absorbed  = 2.720e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.509   0.453
            5         1.16e+04   1.09e+04   0.197   0.169
            10        1.15e+04   1.08e+04   0.122   0.102
            15         1.1e+04   1.04e+04  0.0945  0.0774
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.509   0.453
            5         1.16e+04   1.09e+04   0.197   0.169
            10        1.15e+04   1.08e+04   0.122   0.102
            15         1.1e+04   1.04e+04  0.0945  0.0774

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10107.559 K
            Expected t_inner for next iteration = 11187.994 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10107.559 K
            Expected t_inner for next iteration = 11187.994 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################5                                                           10272/40000 [00:00<00:00, 102713.24it/s]
    Packets:   #########################################                                       20544/40000 [00:00<00:00, 100659.89it/s]
    Packets:   #############################################################2                  30614/40000 [00:00<00:00, 99797.38it/s]     Iterations:################################################                                12/20 [00:07<00:04,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.282e+43 erg / s
            Luminosity absorbed  = 4.235e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.282e+43 erg / s
            Luminosity absorbed  = 4.235e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.453   0.496
            5         1.09e+04   1.17e+04   0.169    0.19
            10        1.08e+04   1.14e+04   0.102   0.121
            15        1.04e+04   1.11e+04  0.0774  0.0886
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.453   0.496
            5         1.09e+04   1.17e+04   0.169    0.19
            10        1.08e+04   1.14e+04   0.102   0.121
            15        1.04e+04   1.11e+04  0.0774  0.0886

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11187.994 K
            Expected t_inner for next iteration = 10171.774 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11187.994 K
            Expected t_inner for next iteration = 10171.774 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################9                                                            9982/40000 [00:00<00:00, 91413.25it/s]
    Packets:   ######################################8                                         19434/40000 [00:00<00:00, 93160.02it/s]
    Packets:   #########################################################5                      28758/40000 [00:00<00:00, 91732.28it/s]    Iterations:####################################################                            13/20 [00:07<00:04,  1.62it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.828e+42 erg / s
            Luminosity absorbed  = 2.827e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.828e+42 erg / s
            Luminosity absorbed  = 2.827e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.496   0.445
            5         1.17e+04   1.11e+04    0.19   0.159
            10        1.14e+04   1.09e+04   0.121  0.0992
            15        1.11e+04   1.04e+04  0.0886  0.0793
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.496   0.445
            5         1.17e+04   1.11e+04    0.19   0.159
            10        1.14e+04   1.09e+04   0.121  0.0992
            15        1.11e+04   1.04e+04  0.0886  0.0793

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10171.774 K
            Expected t_inner for next iteration = 11142.467 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10171.774 K
            Expected t_inner for next iteration = 11142.467 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################3                                                             9178/40000 [00:00<00:00, 91289.07it/s]
    Packets:   ####################################9                                           18452/40000 [00:00<00:00, 92137.76it/s]
    Packets:   #######################################################3                        27672/40000 [00:00<00:00, 92159.57it/s]    Iterations:########################################################                        14/20 [00:08<00:03,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.267e+43 erg / s
            Luminosity absorbed  = 4.110e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.267e+43 erg / s
            Luminosity absorbed  = 4.110e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.445   0.489
            5         1.11e+04   1.16e+04   0.159   0.191
            10        1.09e+04   1.13e+04  0.0992   0.121
            15        1.04e+04   1.09e+04  0.0793  0.0926
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.445   0.489
            5         1.11e+04   1.16e+04   0.159   0.191
            10        1.09e+04   1.13e+04  0.0992   0.121
            15        1.04e+04   1.09e+04  0.0793  0.0926

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11142.467 K
            Expected t_inner for next iteration = 10187.146 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11142.467 K
            Expected t_inner for next iteration = 10187.146 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################5                                                             9260/40000 [00:00<00:00, 92569.85it/s]
    Packets:   #####################################5                                          18792/40000 [00:00<00:00, 94172.50it/s]
    Packets:   ########################################################4                       28220/40000 [00:00<00:00, 94218.85it/s]    Iterations:############################################################                    15/20 [00:09<00:03,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.896e+42 erg / s
            Luminosity absorbed  = 2.831e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.896e+42 erg / s
            Luminosity absorbed  = 2.831e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.489   0.451
            5         1.16e+04   1.11e+04   0.191   0.163
            10        1.13e+04   1.08e+04   0.121   0.102
            15        1.09e+04   1.04e+04  0.0926  0.0786
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.489   0.451
            5         1.16e+04   1.11e+04   0.191   0.163
            10        1.13e+04   1.08e+04   0.121   0.102
            15        1.09e+04   1.04e+04  0.0926  0.0786

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10187.146 K
            Expected t_inner for next iteration = 11116.380 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10187.146 K
            Expected t_inner for next iteration = 11116.380 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################8                                                             9422/40000 [00:00<00:00, 93405.69it/s]
    Packets:   #####################################9                                          18952/40000 [00:00<00:00, 94512.89it/s]
    Packets:   ########################################################9                       28484/40000 [00:00<00:00, 94873.43it/s]    Iterations:################################################################                16/20 [00:09<00:02,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.253e+43 erg / s
            Luminosity absorbed  = 4.095e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.253e+43 erg / s
            Luminosity absorbed  = 4.095e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.451   0.494
            5         1.11e+04   1.16e+04   0.163   0.189
            10        1.08e+04   1.14e+04   0.102   0.119
            15        1.04e+04    1.1e+04  0.0786  0.0894
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.451   0.494
            5         1.11e+04   1.16e+04   0.163   0.189
            10        1.08e+04   1.14e+04   0.102   0.119
            15        1.04e+04    1.1e+04  0.0786  0.0894

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11116.380 K
            Expected t_inner for next iteration = 10222.064 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11116.380 K
            Expected t_inner for next iteration = 10222.064 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################9                                                             9488/40000 [00:00<00:00, 93822.70it/s]
    Packets:   #####################################7                                          18872/40000 [00:00<00:00, 89937.16it/s]
    Packets:   #######################################################7                        27876/40000 [00:00<00:00, 89576.70it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.57it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.051e+42 erg / s
            Luminosity absorbed  = 2.838e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.051e+42 erg / s
            Luminosity absorbed  = 2.838e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.494   0.444
            5         1.16e+04   1.11e+04   0.189   0.165
            10        1.14e+04   1.09e+04   0.119   0.102
            15         1.1e+04   1.05e+04  0.0894  0.0768
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.494   0.444
            5         1.16e+04   1.11e+04   0.189   0.165
            10        1.14e+04   1.09e+04   0.119   0.102
            15         1.1e+04   1.05e+04  0.0894  0.0768

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10222.064 K
            Expected t_inner for next iteration = 11058.452 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10222.064 K
            Expected t_inner for next iteration = 11058.452 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9898/40000 [00:00<00:00, 98978.44it/s]
    Packets:   #######################################9                                        19988/40000 [00:00<00:00, 100101.52it/s]
    Packets:   ############################################################                    30000/40000 [00:00<00:00, 100048.68it/s]    Iterations:########################################################################        18/20 [00:10<00:01,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.226e+43 erg / s
            Luminosity absorbed  = 4.016e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.226e+43 erg / s
            Luminosity absorbed  = 4.016e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.13e+04   0.444   0.496
            5         1.11e+04   1.17e+04   0.165   0.184
            10        1.09e+04   1.13e+04   0.102   0.118
            15        1.05e+04   1.09e+04  0.0768  0.0913
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.13e+04   0.444   0.496
            5         1.11e+04   1.17e+04   0.165   0.184
            10        1.09e+04   1.13e+04   0.102   0.118
            15        1.05e+04   1.09e+04  0.0768  0.0913

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11058.452 K
            Expected t_inner for next iteration = 10278.313 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11058.452 K
            Expected t_inner for next iteration = 10278.313 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################                                                            10006/40000 [00:00<00:00, 98787.77it/s]
    Packets:   #######################################9                                        19988/40000 [00:00<00:00, 99390.29it/s]
    Packets:   ###########################################################8                    29928/40000 [00:00<00:00, 99020.47it/s]    Iterations:############################################################################    19/20 [00:11<00:00,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.180e+42 erg / s
            Luminosity absorbed  = 2.970e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.180e+42 erg / s
            Luminosity absorbed  = 2.970e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.13e+04   1.08e+04   0.496   0.452
            5         1.17e+04   1.11e+04   0.184   0.166
            10        1.13e+04   1.09e+04   0.118   0.104
            15        1.09e+04   1.04e+04  0.0913  0.0813
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.13e+04   1.08e+04   0.496   0.452
            5         1.17e+04   1.11e+04   0.184   0.166
            10        1.13e+04   1.09e+04   0.118   0.104
            15        1.09e+04   1.04e+04  0.0913  0.0813

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10278.313 K
            Expected t_inner for next iteration = 11041.132 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10278.313 K
            Expected t_inner for next iteration = 11041.132 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]              
    Packets:   #######9                                                                        9904/100000 [00:00<00:02, 30795.34it/s]
    Packets:   ##########3                                                                     12984/100000 [00:00<00:02, 30729.67it/s]
    Packets:   ############9                                                                   16194/100000 [00:00<00:02, 31146.66it/s]
    Packets:   ###############4                                                                19328/100000 [00:00<00:02, 31056.94it/s]
    Packets:   #################9                                                              22442/100000 [00:00<00:02, 30876.04it/s]
    Packets:   ####################4                                                           25532/100000 [00:00<00:02, 30689.14it/s]
    Packets:   ######################8                                                         28600/100000 [00:00<00:02, 30498.96it/s]
    Packets:   #########################3                                                      31658/100000 [00:01<00:02, 30518.10it/s]
    Packets:   ###########################7                                                    34710/100000 [00:01<00:02, 30492.33it/s]
    Packets:   ##############################2                                                 37760/100000 [00:01<00:02, 30436.97it/s]
    Packets:   ################################6                                               40804/100000 [00:01<00:01, 30331.14it/s]
    Packets:   ###################################1                                            43928/100000 [00:01<00:01, 30597.49it/s]
    Packets:   #####################################6                                          47006/100000 [00:01<00:01, 30649.15it/s]
    Packets:   ########################################                                        50072/100000 [00:01<00:01, 30460.82it/s]
    Packets:   ##########################################5                                     53238/100000 [00:01<00:01, 30659.93it/s]
    Packets:   #############################################                                   56326/100000 [00:01<00:01, 30722.55it/s]
    Packets:   ###############################################6                                59534/100000 [00:01<00:01, 31122.43it/s]
    Packets:   ##################################################1                             62716/100000 [00:02<00:01, 31322.94it/s]
    Packets:   ####################################################6                           65870/100000 [00:02<00:01, 31387.33it/s]
    Packets:   #######################################################2                        69026/100000 [00:02<00:00, 31435.75it/s]
    Packets:   #########################################################7                      72172/100000 [00:02<00:00, 31440.20it/s]
    Packets:   ############################################################2                   75318/100000 [00:02<00:00, 31327.03it/s]
    Packets:   ##############################################################8                 78524/100000 [00:02<00:00, 31542.68it/s]
    Packets:   #################################################################4              81786/100000 [00:02<00:00, 31862.25it/s]
    Packets:   ###################################################################9            84974/100000 [00:02<00:00, 31464.50it/s]
    Packets:   ######################################################################4         88122/100000 [00:02<00:00, 31247.68it/s]
    Packets:   #########################################################################       91318/100000 [00:02<00:00, 31455.75it/s]
    Packets:   ###########################################################################5    94466/100000 [00:03<00:00, 31315.98it/s]
    Packets:   ##############################################################################6 98346/100000 [00:03<00:00, 33538.43it/s]    Iterations:################################################################################20/20 [00:15<00:00,  1.55s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.221e+43 erg / s
            Luminosity absorbed  = 3.967e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.221e+43 erg / s
            Luminosity absorbed  = 3.967e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 41.70 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 41.70 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:21<00:00, 33538.43it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  54.399 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
