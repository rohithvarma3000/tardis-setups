
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Config
    None




.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   #######################2                                                        11634/40000 [00:00<00:00, 116334.84it/s]
    Packets:   ###############################################6                                23814/40000 [00:00<00:00, 119549.15it/s]
    Packets:   #######################################################################9        35984/40000 [00:00<00:00, 120527.64it/s]    Iterations:####                                                                            1/20 [00:00<00:07,  2.71it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################1                                                       12054/40000 [00:00<00:00, 108154.78it/s]
    Packets:   #############################################8                                  22924/40000 [00:00<00:00, 108454.58it/s]
    Packets:   #########################################################################       36520/40000 [00:00<00:00, 120697.20it/s]    Iterations:########                                                                        2/20 [00:00<00:08,  2.10it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.794e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.794e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9958.756 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9958.756 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################2                                                       12102/40000 [00:00<00:00, 110893.42it/s]
    Packets:   ##############################################3                                 23192/40000 [00:00<00:00, 110598.23it/s]
    Packets:   ########################################################################3       36198/40000 [00:00<00:00, 119285.37it/s]    Iterations:############                                                                    3/20 [00:01<00:08,  1.96it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.164e+42 erg / s
            Luminosity absorbed  = 2.548e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.164e+42 erg / s
            Luminosity absorbed  = 2.548e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.439
            5         1.15e+04   1.08e+04  0.223   0.164
            10        1.13e+04   1.06e+04  0.135   0.103
            15         1.1e+04   1.03e+04  0.101  0.0771
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.439
            5         1.15e+04   1.08e+04  0.223   0.164
            10        1.13e+04   1.06e+04  0.135   0.103
            15         1.1e+04   1.03e+04  0.101  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9958.756 K
            Expected t_inner for next iteration = 11343.623 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 9958.756 K
            Expected t_inner for next iteration = 11343.623 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################9                                                        11978/40000 [00:00<00:00, 119771.26it/s]
    Packets:   ################################################1                               24074/40000 [00:00<00:00, 120468.37it/s]
    Packets:   ########################################################################2       36122/40000 [00:00<00:00, 120016.83it/s]    Iterations:################                                                                4/20 [00:02<00:08,  1.93it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.358e+43 erg / s
            Luminosity absorbed  = 4.446e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.358e+43 erg / s
            Luminosity absorbed  = 4.446e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.439   0.492
            5         1.08e+04   1.17e+04   0.164   0.199
            10        1.06e+04   1.14e+04   0.103   0.127
            15        1.03e+04   1.11e+04  0.0771  0.0944
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.439   0.492
            5         1.08e+04   1.17e+04   0.164   0.199
            10        1.06e+04   1.14e+04   0.103   0.127
            15        1.03e+04   1.11e+04  0.0771  0.0944

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11343.623 K
            Expected t_inner for next iteration = 10018.952 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11343.623 K
            Expected t_inner for next iteration = 10018.952 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################1                                                      12556/40000 [00:00<00:00, 125550.84it/s]
    Packets:   ##################################################2                             25112/40000 [00:00<00:00, 124989.94it/s]
    Packets:   ############################################################################5   38256/40000 [00:00<00:00, 127925.31it/s]    Iterations:####################                                                            5/20 [00:02<00:07,  1.94it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.328e+42 erg / s
            Luminosity absorbed  = 2.642e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.328e+42 erg / s
            Luminosity absorbed  = 2.642e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.492   0.443
            5         1.17e+04   1.09e+04   0.199    0.16
            10        1.14e+04   1.07e+04   0.127   0.101
            15        1.11e+04   1.04e+04  0.0944  0.0751
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.492   0.443
            5         1.17e+04   1.09e+04   0.199    0.16
            10        1.14e+04   1.07e+04   0.127   0.101
            15        1.11e+04   1.04e+04  0.0944  0.0751

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10018.952 K
            Expected t_inner for next iteration = 11299.227 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10018.952 K
            Expected t_inner for next iteration = 11299.227 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################5                                                      12794/40000 [00:00<00:00, 118854.65it/s]
    Packets:   #################################################6                              24804/40000 [00:00<00:00, 119554.84it/s]
    Packets:   ##########################################################################5     37256/40000 [00:00<00:00, 121778.52it/s]    Iterations:########################                                                        6/20 [00:03<00:07,  1.93it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.426e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.426e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.505
            5         1.09e+04   1.17e+04    0.16   0.198
            10        1.07e+04   1.14e+04   0.101   0.124
            15        1.04e+04    1.1e+04  0.0751  0.0938
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.505
            5         1.09e+04   1.17e+04    0.16   0.198
            10        1.07e+04   1.14e+04   0.101   0.124
            15        1.04e+04    1.1e+04  0.0751  0.0938

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11299.227 K
            Expected t_inner for next iteration = 10079.476 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11299.227 K
            Expected t_inner for next iteration = 10079.476 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################                                                       12508/40000 [00:00<00:00, 125073.86it/s]
    Packets:   ##################################################1                             25078/40000 [00:00<00:00, 125434.32it/s]
    Packets:   ############################################################################5   38258/40000 [00:00<00:00, 128340.11it/s]    Iterations:############################                                                    7/20 [00:03<00:06,  1.94it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.531e+42 erg / s
            Luminosity absorbed  = 2.707e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.531e+42 erg / s
            Luminosity absorbed  = 2.707e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.443
            5         1.17e+04   1.11e+04   0.198   0.158
            10        1.14e+04   1.08e+04   0.124   0.101
            15         1.1e+04   1.04e+04  0.0938  0.0752
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.443
            5         1.17e+04   1.11e+04   0.198   0.158
            10        1.14e+04   1.08e+04   0.124   0.101
            15         1.1e+04   1.04e+04  0.0938  0.0752

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10079.476 K
            Expected t_inner for next iteration = 11231.662 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10079.476 K
            Expected t_inner for next iteration = 11231.662 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################6                                                      12836/40000 [00:00<00:00, 107996.92it/s]
    Packets:   ###############################################2                                23636/40000 [00:00<00:00, 107963.11it/s]
    Packets:   ###########################################################################     37548/40000 [00:00<00:00, 121607.95it/s]    Iterations:################################                                                8/20 [00:04<00:06,  1.90it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.260e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.260e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443     0.5
            5         1.11e+04   1.17e+04   0.158   0.193
            10        1.08e+04   1.15e+04   0.101   0.121
            15        1.04e+04   1.11e+04  0.0752  0.0914
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443     0.5
            5         1.11e+04   1.17e+04   0.158   0.193
            10        1.08e+04   1.15e+04   0.101   0.121
            15        1.04e+04   1.11e+04  0.0752  0.0914

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11231.662 K
            Expected t_inner for next iteration = 10114.574 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11231.662 K
            Expected t_inner for next iteration = 10114.574 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################4                                                       12220/40000 [00:00<00:00, 117549.48it/s]
    Packets:   ###############################################9                                23976/40000 [00:00<00:00, 117180.47it/s]
    Packets:   #######################################################################6        35804/40000 [00:00<00:00, 117674.53it/s]    Iterations:####################################                                            9/20 [00:04<00:05,  1.88it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.625e+42 erg / s
            Luminosity absorbed  = 2.769e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.625e+42 erg / s
            Luminosity absorbed  = 2.769e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04     0.5   0.443
            5         1.17e+04    1.1e+04   0.193   0.163
            10        1.15e+04   1.08e+04   0.121   0.102
            15        1.11e+04   1.05e+04  0.0914  0.0757
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04     0.5   0.443
            5         1.17e+04    1.1e+04   0.193   0.163
            10        1.15e+04   1.08e+04   0.121   0.102
            15        1.11e+04   1.05e+04  0.0914  0.0757

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10114.574 K
            Expected t_inner for next iteration = 11209.470 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10114.574 K
            Expected t_inner for next iteration = 11209.470 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################8                                                        11932/40000 [00:00<00:00, 119299.63it/s]
    Packets:   ###############################################8                                23928/40000 [00:00<00:00, 119681.08it/s]
    Packets:   #######################################################################8        35902/40000 [00:00<00:00, 119707.12it/s]    Iterations:########################################                                        10/20 [00:05<00:05,  1.88it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.189e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.189e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.443   0.505
            5          1.1e+04   1.17e+04   0.163   0.192
            10        1.08e+04   1.14e+04   0.102   0.123
            15        1.05e+04    1.1e+04  0.0757  0.0934
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.443   0.505
            5          1.1e+04   1.17e+04   0.163   0.192
            10        1.08e+04   1.14e+04   0.102   0.123
            15        1.05e+04    1.1e+04  0.0757  0.0934

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11209.470 K
            Expected t_inner for next iteration = 10120.495 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11209.470 K
            Expected t_inner for next iteration = 10120.495 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################3                                                       12166/40000 [00:00<00:00, 121656.35it/s]
    Packets:   ################################################9                               24482/40000 [00:00<00:00, 122532.83it/s]
    Packets:   ##########################################################################      37030/40000 [00:00<00:00, 123878.43it/s]    Iterations:############################################                                    11/20 [00:05<00:04,  1.90it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.688e+42 erg / s
            Luminosity absorbed  = 2.736e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.688e+42 erg / s
            Luminosity absorbed  = 2.736e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.505   0.449
            5         1.17e+04    1.1e+04   0.192   0.164
            10        1.14e+04   1.08e+04   0.123   0.102
            15         1.1e+04   1.04e+04  0.0934  0.0783
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.505   0.449
            5         1.17e+04    1.1e+04   0.192   0.164
            10        1.14e+04   1.08e+04   0.123   0.102
            15         1.1e+04   1.04e+04  0.0934  0.0783

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10120.495 K
            Expected t_inner for next iteration = 11175.158 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10120.495 K
            Expected t_inner for next iteration = 11175.158 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################7                                                       12388/40000 [00:00<00:00, 119662.83it/s]
    Packets:   ################################################7                               24356/40000 [00:00<00:00, 119450.42it/s]
    Packets:   ########################################################################8       36424/40000 [00:00<00:00, 120003.60it/s]    Iterations:################################################                                12/20 [00:06<00:04,  1.90it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.277e+43 erg / s
            Luminosity absorbed  = 4.211e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.277e+43 erg / s
            Luminosity absorbed  = 4.211e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.449   0.492
            5          1.1e+04   1.17e+04   0.164   0.189
            10        1.08e+04   1.14e+04   0.102    0.12
            15        1.04e+04    1.1e+04  0.0783  0.0899
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.449   0.492
            5          1.1e+04   1.17e+04   0.164   0.189
            10        1.08e+04   1.14e+04   0.102    0.12
            15        1.04e+04    1.1e+04  0.0783  0.0899

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11175.158 K
            Expected t_inner for next iteration = 10179.544 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11175.158 K
            Expected t_inner for next iteration = 10179.544 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################8                                                       12430/40000 [00:00<00:00, 124295.97it/s]
    Packets:   #################################################7                              24870/40000 [00:00<00:00, 124348.16it/s]
    Packets:   ###########################################################################5    37788/40000 [00:00<00:00, 126552.78it/s]    Iterations:####################################################                            13/20 [00:06<00:03,  1.92it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.868e+42 erg / s
            Luminosity absorbed  = 2.821e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.868e+42 erg / s
            Luminosity absorbed  = 2.821e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.492   0.441
            5         1.17e+04   1.11e+04   0.189   0.163
            10        1.14e+04   1.09e+04    0.12   0.102
            15         1.1e+04   1.05e+04  0.0899  0.0771
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.492   0.441
            5         1.17e+04   1.11e+04   0.189   0.163
            10        1.14e+04   1.09e+04    0.12   0.102
            15         1.1e+04   1.05e+04  0.0899  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10179.544 K
            Expected t_inner for next iteration = 11125.348 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10179.544 K
            Expected t_inner for next iteration = 11125.348 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################3                                                      12656/40000 [00:00<00:00, 120234.64it/s]
    Packets:   #################################################6                              24846/40000 [00:00<00:00, 121187.90it/s]
    Packets:   ##########################################################################5     37296/40000 [00:00<00:00, 122680.45it/s]    Iterations:########################################################                        14/20 [00:07<00:03,  1.92it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.261e+43 erg / s
            Luminosity absorbed  = 4.067e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.261e+43 erg / s
            Luminosity absorbed  = 4.067e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.441   0.491
            5         1.11e+04   1.16e+04   0.163   0.193
            10        1.09e+04   1.14e+04   0.102   0.119
            15        1.05e+04    1.1e+04  0.0771  0.0899
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.441   0.491
            5         1.11e+04   1.16e+04   0.163   0.193
            10        1.09e+04   1.14e+04   0.102   0.119
            15        1.05e+04    1.1e+04  0.0771  0.0899

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11125.348 K
            Expected t_inner for next iteration = 10195.346 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11125.348 K
            Expected t_inner for next iteration = 10195.346 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################2                                                      12626/40000 [00:00<00:00, 126252.90it/s]
    Packets:   ###################################################4                            25740/40000 [00:00<00:00, 129125.50it/s]
    Packets:   #############################################################################3  38654/40000 [00:00<00:00, 126693.40it/s]    Iterations:############################################################                    15/20 [00:07<00:02,  1.93it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.902e+42 erg / s
            Luminosity absorbed  = 2.862e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.902e+42 erg / s
            Luminosity absorbed  = 2.862e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.491   0.448
            5         1.16e+04   1.11e+04   0.193   0.163
            10        1.14e+04   1.09e+04   0.119   0.102
            15         1.1e+04   1.05e+04  0.0899  0.0774
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.491   0.448
            5         1.16e+04   1.11e+04   0.193   0.163
            10        1.14e+04   1.09e+04   0.119   0.102
            15         1.1e+04   1.05e+04  0.0899  0.0774

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10195.346 K
            Expected t_inner for next iteration = 11121.488 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10195.346 K
            Expected t_inner for next iteration = 11121.488 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################3                                                      12676/40000 [00:00<00:00, 109218.68it/s]
    Packets:   ###############################################2                                23626/40000 [00:00<00:00, 109372.37it/s]
    Packets:   ##########################################################################6     37326/40000 [00:00<00:00, 121539.47it/s]    Iterations:################################################################                16/20 [00:08<00:02,  1.90it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.254e+43 erg / s
            Luminosity absorbed  = 4.117e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.254e+43 erg / s
            Luminosity absorbed  = 4.117e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.448    0.49
            5         1.11e+04   1.16e+04   0.163   0.188
            10        1.09e+04   1.14e+04   0.102    0.12
            15        1.05e+04    1.1e+04  0.0774  0.0901
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.448    0.49
            5         1.11e+04   1.16e+04   0.163   0.188
            10        1.09e+04   1.14e+04   0.102    0.12
            15        1.05e+04    1.1e+04  0.0774  0.0901

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11121.488 K
            Expected t_inner for next iteration = 10223.391 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11121.488 K
            Expected t_inner for next iteration = 10223.391 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################4                                                       12200/40000 [00:00<00:00, 111483.32it/s]
    Packets:   ##############################################7                                 23350/40000 [00:00<00:00, 111472.96it/s]
    Packets:   #########################################################################7      36886/40000 [00:00<00:00, 122147.58it/s]    Iterations:####################################################################            17/20 [00:08<00:01,  1.88it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.040e+42 erg / s
            Luminosity absorbed  = 2.854e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.040e+42 erg / s
            Luminosity absorbed  = 2.854e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04    0.49   0.441
            5         1.16e+04   1.11e+04   0.188   0.164
            10        1.14e+04   1.09e+04    0.12   0.101
            15         1.1e+04   1.06e+04  0.0901  0.0762
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04    0.49   0.441
            5         1.16e+04   1.11e+04   0.188   0.164
            10        1.14e+04   1.09e+04    0.12   0.101
            15         1.1e+04   1.06e+04  0.0901  0.0762

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10223.391 K
            Expected t_inner for next iteration = 11066.776 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10223.391 K
            Expected t_inner for next iteration = 11066.776 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################4                                                       12238/40000 [00:00<00:00, 108620.67it/s]
    Packets:   ##############################################2                                 23102/40000 [00:00<00:00, 108264.70it/s]
    Packets:   #########################################################################3      36678/40000 [00:00<00:00, 120445.74it/s]    Iterations:########################################################################        18/20 [00:09<00:01,  1.86it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.229e+43 erg / s
            Luminosity absorbed  = 4.038e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.229e+43 erg / s
            Luminosity absorbed  = 4.038e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.14e+04   0.441   0.485
            5         1.11e+04   1.17e+04   0.164   0.185
            10        1.09e+04   1.14e+04   0.101   0.116
            15        1.06e+04   1.09e+04  0.0762  0.0901
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.14e+04   0.441   0.485
            5         1.11e+04   1.17e+04   0.164   0.185
            10        1.09e+04   1.14e+04   0.101   0.116
            15        1.06e+04   1.09e+04  0.0762  0.0901

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11066.776 K
            Expected t_inner for next iteration = 10275.319 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 11066.776 K
            Expected t_inner for next iteration = 10275.319 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################1                                                       12082/40000 [00:00<00:00, 112342.28it/s]
    Packets:   ##############################################6                                 23318/40000 [00:00<00:00, 110669.05it/s]
    Packets:   #########################################################################4      36722/40000 [00:00<00:00, 121074.95it/s]    Iterations:############################################################################    19/20 [00:09<00:00,  1.85it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.187e+42 erg / s
            Luminosity absorbed  = 2.949e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.187e+42 erg / s
            Luminosity absorbed  = 2.949e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:547)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.485   0.448
            5         1.17e+04   1.12e+04   0.185   0.162
            10        1.14e+04   1.09e+04   0.116   0.102
            15        1.09e+04   1.05e+04  0.0901  0.0794
     (base.py:548)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.485   0.448
            5         1.17e+04   1.12e+04   0.185   0.162
            10        1.14e+04   1.09e+04   0.116   0.102
            15        1.09e+04   1.05e+04  0.0901  0.0794

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10275.319 K
            Expected t_inner for next iteration = 11033.481 K
     (base.py:550)
    INFO:tardis.simulation.base:
            Current t_inner = 10275.319 K
            Expected t_inner for next iteration = 11033.481 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:381)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]               
    Packets:   #########7                                                                      12134/100000 [00:00<00:02, 35728.36it/s]
    Packets:   ############5                                                                   15708/100000 [00:00<00:02, 35357.29it/s]
    Packets:   ###############3                                                                19210/100000 [00:00<00:02, 35167.50it/s]
    Packets:   ##################1                                                             22700/100000 [00:00<00:02, 35083.53it/s]
    Packets:   ####################9                                                           26188/100000 [00:00<00:02, 34945.08it/s]
    Packets:   #######################7                                                        29690/100000 [00:00<00:02, 34963.56it/s]
    Packets:   ##########################5                                                     33200/100000 [00:00<00:01, 34934.83it/s]
    Packets:   #############################3                                                  36688/100000 [00:01<00:01, 34779.07it/s]
    Packets:   ################################1                                               40162/100000 [00:01<00:01, 34742.78it/s]
    Packets:   ##################################9                                             43716/100000 [00:01<00:01, 34976.92it/s]
    Packets:   #####################################7                                          47212/100000 [00:01<00:01, 34814.11it/s]
    Packets:   ########################################5                                       50692/100000 [00:01<00:01, 34677.58it/s]
    Packets:   ###########################################3                                    54160/100000 [00:01<00:01, 34633.33it/s]
    Packets:   ##############################################                                  57624/100000 [00:01<00:01, 34476.16it/s]
    Packets:   ################################################8                               61120/100000 [00:01<00:01, 34615.05it/s]
    Packets:   ###################################################6                            64582/100000 [00:01<00:01, 34497.55it/s]
    Packets:   ######################################################4                         68080/100000 [00:01<00:00, 34637.22it/s]
    Packets:   #########################################################2                      71560/100000 [00:02<00:00, 34683.56it/s]
    Packets:   ############################################################                    75030/100000 [00:02<00:00, 34556.68it/s]
    Packets:   ##############################################################9                 78646/100000 [00:02<00:00, 35032.46it/s]
    Packets:   #################################################################7              82182/100000 [00:02<00:00, 35130.15it/s]
    Packets:   ####################################################################5           85734/100000 [00:02<00:00, 35243.74it/s]
    Packets:   #######################################################################4        89260/100000 [00:02<00:00, 34872.07it/s]
    Packets:   ##########################################################################2     92802/100000 [00:02<00:00, 35033.16it/s]
    Packets:   #############################################################################   96308/100000 [00:02<00:00, 34693.69it/s]    Iterations:################################################################################20/20 [00:13<00:00,  1.37s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.216e+43 erg / s
            Luminosity absorbed  = 3.971e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:555)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.216e+43 erg / s
            Luminosity absorbed  = 3.971e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 34.49 s
     (base.py:476)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 34.49 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:357: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:16<00:00, 34693.69it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  39.590 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
