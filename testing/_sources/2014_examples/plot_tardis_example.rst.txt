
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ######################9                                                         11472/40000 [00:00<00:00, 114711.63it/s]
    Packets:   ##############################################9                                 23476/40000 [00:00<00:00, 117845.11it/s]
    Packets:   ###########################################################################2    37628/40000 [00:00<00:00, 128653.44it/s]    Iterations:####                                                                            1/20 [00:00<00:06,  2.77it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################7                                                      12866/40000 [00:00<00:00, 111459.08it/s]
    Packets:   ################################################                                24028/40000 [00:00<00:00, 111538.58it/s]
    Packets:   #############################################################################8  38930/40000 [00:00<00:00, 128077.10it/s]    Iterations:########                                                                        2/20 [00:00<00:08,  2.16it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.798e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.798e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.547 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.547 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.180 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.180 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################7                                                      12866/40000 [00:00<00:00, 123828.67it/s]
    Packets:   ##################################################6                             25334/40000 [00:00<00:00, 124318.34it/s]
    Packets:   ##############################################################################8 39430/40000 [00:00<00:00, 131851.32it/s]    Iterations:############                                                                    3/20 [00:01<00:08,  2.08it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.174e+42 erg / s
            Luminosity absorbed  = 2.544e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.174e+42 erg / s
            Luminosity absorbed  = 2.544e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547   0.439
            5         1.15e+04   1.08e+04  0.223   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0782
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547   0.439
            5         1.15e+04   1.08e+04  0.223   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0782

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9960.180 K
            Expected t_inner for next iteration = 11338.532 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9960.180 K
            Expected t_inner for next iteration = 11338.532 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################3                                                     13194/40000 [00:00<00:00, 121011.76it/s]
    Packets:   ###################################################1                            25586/40000 [00:00<00:00, 122656.25it/s]    Iterations:################                                                                4/20 [00:01<00:07,  2.05it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.435e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.435e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.439   0.501
            5         1.08e+04   1.17e+04   0.166   0.199
            10        1.06e+04   1.14e+04   0.102   0.128
            15        1.02e+04   1.11e+04  0.0782  0.0939
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.439   0.501
            5         1.08e+04   1.17e+04   0.166   0.199
            10        1.06e+04   1.14e+04   0.102   0.128
            15        1.02e+04   1.11e+04  0.0782  0.0939

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11338.532 K
            Expected t_inner for next iteration = 10023.053 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11338.532 K
            Expected t_inner for next iteration = 10023.053 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################1                                                      12592/40000 [00:00<00:00, 125918.02it/s]
    Packets:   ##################################################3                             25184/40000 [00:00<00:00, 125364.20it/s]
    Packets:   ##############################################################################  39022/40000 [00:00<00:00, 131284.28it/s]    Iterations:####################                                                            5/20 [00:02<00:07,  2.04it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.325e+42 erg / s
            Luminosity absorbed  = 2.662e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.325e+42 erg / s
            Luminosity absorbed  = 2.662e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.501   0.448
            5         1.17e+04   1.08e+04   0.199   0.167
            10        1.14e+04   1.07e+04   0.128   0.101
            15        1.11e+04   1.04e+04  0.0939  0.0758
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.501   0.448
            5         1.17e+04   1.08e+04   0.199   0.167
            10        1.14e+04   1.07e+04   0.128   0.101
            15        1.11e+04   1.04e+04  0.0939  0.0758

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10023.053 K
            Expected t_inner for next iteration = 11306.029 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10023.053 K
            Expected t_inner for next iteration = 11306.029 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################2                                                     13130/40000 [00:00<00:00, 124453.87it/s]
    Packets:   ###################################################2                            25642/40000 [00:00<00:00, 124832.14it/s]
    Packets:   ###############################################################################539788/40000 [00:00<00:00, 132331.64it/s]    Iterations:########################                                                        6/20 [00:02<00:06,  2.02it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.466e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.466e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.15e+04   0.448   0.505
            5         1.08e+04   1.16e+04   0.167   0.202
            10        1.07e+04   1.14e+04   0.101   0.125
            15        1.04e+04    1.1e+04  0.0758  0.0958
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.15e+04   0.448   0.505
            5         1.08e+04   1.16e+04   0.167   0.202
            10        1.07e+04   1.14e+04   0.101   0.125
            15        1.04e+04    1.1e+04  0.0758  0.0958

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11306.029 K
            Expected t_inner for next iteration = 10084.605 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11306.029 K
            Expected t_inner for next iteration = 10084.605 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################4                                                     13244/40000 [00:00<00:00, 114320.98it/s]
    Packets:   #################################################5                              24798/40000 [00:00<00:00, 114985.10it/s]    Iterations:############################                                                    7/20 [00:03<00:06,  2.00it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.571e+42 erg / s
            Luminosity absorbed  = 2.692e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.571e+42 erg / s
            Luminosity absorbed  = 2.692e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.443
            5         1.16e+04   1.11e+04   0.202   0.156
            10        1.14e+04   1.09e+04   0.125  0.0969
            15         1.1e+04   1.04e+04  0.0958  0.0753
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.443
            5         1.16e+04   1.11e+04   0.202   0.156
            10        1.14e+04   1.09e+04   0.125  0.0969
            15         1.1e+04   1.04e+04  0.0958  0.0753

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10084.605 K
            Expected t_inner for next iteration = 11211.037 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10084.605 K
            Expected t_inner for next iteration = 11211.037 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################1                                                       12064/40000 [00:00<00:00, 120626.60it/s]
    Packets:   ################################################5                               24292/40000 [00:00<00:00, 121598.02it/s]
    Packets:   ##############################################################################  39046/40000 [00:00<00:00, 133440.62it/s]    Iterations:################################                                                8/20 [00:03<00:06,  2.00it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.204e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.204e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.503
            5         1.11e+04   1.16e+04   0.156   0.196
            10        1.09e+04   1.15e+04  0.0969   0.119
            15        1.04e+04   1.11e+04  0.0753  0.0898
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.503
            5         1.11e+04   1.16e+04   0.156   0.196
            10        1.09e+04   1.15e+04  0.0969   0.119
            15        1.04e+04   1.11e+04  0.0753  0.0898

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11211.037 K
            Expected t_inner for next iteration = 10123.910 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11211.037 K
            Expected t_inner for next iteration = 10123.910 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################6                                                     13346/40000 [00:00<00:00, 126855.87it/s]
    Packets:   ####################################################                            26032/40000 [00:00<00:00, 126272.82it/s]    Iterations:####################################                                            9/20 [00:04<00:05,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.669e+42 erg / s
            Luminosity absorbed  = 2.767e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.669e+42 erg / s
            Luminosity absorbed  = 2.767e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.503   0.449
            5         1.16e+04    1.1e+04   0.196   0.162
            10        1.15e+04   1.09e+04   0.119  0.0989
            15        1.11e+04   1.06e+04  0.0898  0.0725
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.503   0.449
            5         1.16e+04    1.1e+04   0.196   0.162
            10        1.15e+04   1.09e+04   0.119  0.0989
            15        1.11e+04   1.06e+04  0.0898  0.0725

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10123.910 K
            Expected t_inner for next iteration = 11190.793 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10123.910 K
            Expected t_inner for next iteration = 11190.793 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################2                                                      12628/40000 [00:00<00:00, 122348.56it/s]
    Packets:   #################################################7                              24880/40000 [00:00<00:00, 122445.96it/s]
    Packets:   ##############################################################################  39020/40000 [00:00<00:00, 131033.02it/s]    Iterations:########################################                                        10/20 [00:04<00:05,  2.00it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.292e+43 erg / s
            Luminosity absorbed  = 4.154e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.292e+43 erg / s
            Luminosity absorbed  = 4.154e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.449     0.5
            5          1.1e+04   1.17e+04   0.162   0.192
            10        1.09e+04   1.14e+04  0.0989   0.122
            15        1.06e+04   1.11e+04  0.0725  0.0894
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.449     0.5
            5          1.1e+04   1.17e+04   0.162   0.192
            10        1.09e+04   1.14e+04  0.0989   0.122
            15        1.06e+04   1.11e+04  0.0725  0.0894

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11190.793 K
            Expected t_inner for next iteration = 10134.694 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11190.793 K
            Expected t_inner for next iteration = 10134.694 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################2                                                     13110/40000 [00:00<00:00, 124644.85it/s]
    Packets:   ###################################################4                            25714/40000 [00:00<00:00, 125438.64it/s]    Iterations:############################################                                    11/20 [00:05<00:04,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.723e+42 erg / s
            Luminosity absorbed  = 2.764e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.723e+42 erg / s
            Luminosity absorbed  = 2.764e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04     0.5    0.45
            5         1.17e+04    1.1e+04   0.192   0.163
            10        1.14e+04   1.09e+04   0.122  0.0995
            15        1.11e+04   1.05e+04  0.0894  0.0747
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04     0.5    0.45
            5         1.17e+04    1.1e+04   0.192   0.163
            10        1.14e+04   1.09e+04   0.122  0.0995
            15        1.11e+04   1.05e+04  0.0894  0.0747

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10134.694 K
            Expected t_inner for next iteration = 11168.475 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10134.694 K
            Expected t_inner for next iteration = 11168.475 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################                                                       12546/40000 [00:00<00:00, 120617.64it/s]
    Packets:   #################################################2                              24608/40000 [00:00<00:00, 120580.98it/s]
    Packets:   ##############################################################################  39034/40000 [00:00<00:00, 131293.99it/s]    Iterations:################################################                                12/20 [00:05<00:03,  2.00it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.269e+43 erg / s
            Luminosity absorbed  = 4.244e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.269e+43 erg / s
            Luminosity absorbed  = 4.244e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04    0.45   0.487
            5          1.1e+04   1.17e+04   0.163   0.188
            10        1.09e+04   1.14e+04  0.0995    0.12
            15        1.05e+04    1.1e+04  0.0747  0.0915
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04    0.45   0.487
            5          1.1e+04   1.17e+04   0.163   0.188
            10        1.09e+04   1.14e+04  0.0995    0.12
            15        1.05e+04    1.1e+04  0.0747  0.0915

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11168.475 K
            Expected t_inner for next iteration = 10203.887 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11168.475 K
            Expected t_inner for next iteration = 10203.887 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################2                                                     13140/40000 [00:00<00:00, 124023.42it/s]
    Packets:   ###################################################3                            25692/40000 [00:00<00:00, 124880.73it/s]    Iterations:####################################################                            13/20 [00:06<00:03,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.973e+42 erg / s
            Luminosity absorbed  = 2.832e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.973e+42 erg / s
            Luminosity absorbed  = 2.832e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.487   0.447
            5         1.17e+04   1.11e+04   0.188   0.163
            10        1.14e+04   1.08e+04    0.12   0.103
            15         1.1e+04   1.04e+04  0.0915  0.0804
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.487   0.447
            5         1.17e+04   1.11e+04   0.188   0.163
            10        1.14e+04   1.08e+04    0.12   0.103
            15         1.1e+04   1.04e+04  0.0915  0.0804

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10203.887 K
            Expected t_inner for next iteration = 11086.867 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10203.887 K
            Expected t_inner for next iteration = 11086.867 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################9                                                       12492/40000 [00:00<00:00, 121652.78it/s]
    Packets:   #################################################3                              24658/40000 [00:00<00:00, 121131.14it/s]
    Packets:   ###############################################################################139582/40000 [00:00<00:00, 133852.22it/s]    Iterations:########################################################                        14/20 [00:06<00:02,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.241e+43 erg / s
            Luminosity absorbed  = 4.042e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.241e+43 erg / s
            Luminosity absorbed  = 4.042e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.447   0.489
            5         1.11e+04   1.16e+04   0.163   0.187
            10        1.08e+04   1.13e+04   0.103   0.118
            15        1.04e+04    1.1e+04  0.0804  0.0896
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.447   0.489
            5         1.11e+04   1.16e+04   0.163   0.187
            10        1.08e+04   1.13e+04   0.103   0.118
            15        1.04e+04    1.1e+04  0.0804  0.0896

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11086.867 K
            Expected t_inner for next iteration = 10243.670 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11086.867 K
            Expected t_inner for next iteration = 10243.670 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################7                                                     13396/40000 [00:00<00:00, 126802.38it/s]
    Packets:   ####################################################1                           26078/40000 [00:00<00:00, 126045.02it/s]    Iterations:############################################################                    15/20 [00:07<00:02,  2.02it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.084e+42 erg / s
            Luminosity absorbed  = 2.900e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.084e+42 erg / s
            Luminosity absorbed  = 2.900e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.489   0.458
            5         1.16e+04   1.11e+04   0.187   0.166
            10        1.13e+04   1.11e+04   0.118  0.0985
            15         1.1e+04   1.05e+04  0.0896   0.078
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.489   0.458
            5         1.16e+04   1.11e+04   0.187   0.166
            10        1.13e+04   1.11e+04   0.118  0.0985
            15         1.1e+04   1.05e+04  0.0896   0.078

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10243.670 K
            Expected t_inner for next iteration = 11061.467 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10243.670 K
            Expected t_inner for next iteration = 11061.467 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################2                                                      12604/40000 [00:00<00:00, 120190.63it/s]
    Packets:   #################################################2                              24626/40000 [00:00<00:00, 120197.39it/s]
    Packets:   ##############################################################################5 39270/40000 [00:00<00:00, 132047.90it/s]    Iterations:################################################################                16/20 [00:07<00:01,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.227e+43 erg / s
            Luminosity absorbed  = 4.026e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.227e+43 erg / s
            Luminosity absorbed  = 4.026e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.13e+04   0.458   0.494
            5         1.11e+04   1.16e+04   0.166   0.185
            10        1.11e+04   1.14e+04  0.0985   0.117
            15        1.05e+04    1.1e+04   0.078  0.0875
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.13e+04   0.458   0.494
            5         1.11e+04   1.16e+04   0.166   0.185
            10        1.11e+04   1.14e+04  0.0985   0.117
            15        1.05e+04    1.1e+04   0.078  0.0875

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11061.467 K
            Expected t_inner for next iteration = 10276.797 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11061.467 K
            Expected t_inner for next iteration = 10276.797 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################4                                                     13218/40000 [00:00<00:00, 125913.14it/s]
    Packets:   ###################################################9                            25956/40000 [00:00<00:00, 126754.38it/s]    Iterations:####################################################################            17/20 [00:08<00:01,  2.02it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.180e+42 erg / s
            Luminosity absorbed  = 2.962e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.180e+42 erg / s
            Luminosity absorbed  = 2.962e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.13e+04   1.08e+04   0.494   0.445
            5         1.16e+04   1.12e+04   0.185   0.164
            10        1.14e+04   1.09e+04   0.117   0.103
            15         1.1e+04   1.05e+04  0.0875  0.0788
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.13e+04   1.08e+04   0.494   0.445
            5         1.16e+04   1.12e+04   0.185   0.164
            10        1.14e+04   1.09e+04   0.117   0.103
            15         1.1e+04   1.05e+04  0.0875  0.0788

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10276.797 K
            Expected t_inner for next iteration = 11039.236 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10276.797 K
            Expected t_inner for next iteration = 11039.236 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################3                                                      12678/40000 [00:00<00:00, 121879.99it/s]
    Packets:   #################################################7                              24866/40000 [00:00<00:00, 121810.15it/s]
    Packets:   ##############################################################################6 39336/40000 [00:00<00:00, 132165.62it/s]    Iterations:########################################################################        18/20 [00:08<00:00,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.225e+43 erg / s
            Luminosity absorbed  = 3.921e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.225e+43 erg / s
            Luminosity absorbed  = 3.921e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.13e+04   0.445  0.491 
            5         1.12e+04   1.16e+04   0.164  0.186 
            10        1.09e+04   1.13e+04   0.103  0.118 
            15        1.05e+04    1.1e+04  0.0788  0.088 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.13e+04   0.445  0.491 
            5         1.12e+04   1.16e+04   0.164  0.186 
            10        1.09e+04   1.13e+04   0.103  0.118 
            15        1.05e+04    1.1e+04  0.0788  0.088 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11039.236 K
            Expected t_inner for next iteration = 10265.930 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11039.236 K
            Expected t_inner for next iteration = 10265.930 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################4                                                     13228/40000 [00:00<00:00, 126988.41it/s]
    Packets:   ###################################################8                            25928/40000 [00:00<00:00, 126856.13it/s]    Iterations:############################################################################    19/20 [00:09<00:00,  2.02it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.153e+42 erg / s
            Luminosity absorbed  = 2.938e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.153e+42 erg / s
            Luminosity absorbed  = 2.938e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.13e+04   1.08e+04  0.491   0.453
            5         1.16e+04   1.11e+04  0.186   0.165
            10        1.13e+04   1.09e+04  0.118   0.102
            15         1.1e+04   1.05e+04  0.088  0.0789
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.13e+04   1.08e+04  0.491   0.453
            5         1.16e+04   1.11e+04  0.186   0.165
            10        1.13e+04   1.09e+04  0.118   0.102
            15         1.1e+04   1.05e+04  0.088  0.0789

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10265.930 K
            Expected t_inner for next iteration = 11043.680 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10265.930 K
            Expected t_inner for next iteration = 11043.680 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]               
    Packets:   ##########1                                                                     12686/100000 [00:00<00:02, 36049.08it/s]
    Packets:   #############                                                                   16292/100000 [00:00<00:02, 35894.76it/s]
    Packets:   ###############8                                                                19866/100000 [00:00<00:02, 35708.67it/s]
    Packets:   ##################7                                                             23498/100000 [00:00<00:02, 35877.00it/s]
    Packets:   #####################6                                                          27116/100000 [00:00<00:02, 35956.11it/s]
    Packets:   ########################5                                                       30716/100000 [00:00<00:01, 35965.26it/s]
    Packets:   ###########################4                                                    34312/100000 [00:00<00:01, 35952.03it/s]
    Packets:   ##############################3                                                 37908/100000 [00:01<00:01, 35698.04it/s]
    Packets:   #################################1                                              41476/100000 [00:01<00:01, 35661.81it/s]
    Packets:   ####################################                                            45060/100000 [00:01<00:01, 35714.46it/s]
    Packets:   ######################################9                                         48632/100000 [00:01<00:01, 35693.31it/s]
    Packets:   #########################################8                                      52276/100000 [00:01<00:01, 35912.99it/s]
    Packets:   ############################################6                                   55868/100000 [00:01<00:01, 35751.01it/s]
    Packets:   ###############################################5                                59444/100000 [00:01<00:01, 35646.77it/s]
    Packets:   ##################################################4                             63010/100000 [00:01<00:01, 35565.34it/s]
    Packets:   #####################################################2                          66596/100000 [00:01<00:00, 35647.90it/s]
    Packets:   ########################################################1                       70162/100000 [00:01<00:00, 35556.49it/s]
    Packets:   ##########################################################9                     73718/100000 [00:02<00:00, 35460.36it/s]
    Packets:   ##############################################################1                 77648/100000 [00:02<00:00, 36605.02it/s]
    Packets:   #################################################################               81310/100000 [00:02<00:00, 36396.23it/s]
    Packets:   ###################################################################9            84952/100000 [00:02<00:00, 36200.85it/s]
    Packets:   ######################################################################8         88574/100000 [00:02<00:00, 36169.19it/s]
    Packets:   #########################################################################7      92196/100000 [00:02<00:00, 36183.59it/s]
    Packets:   ############################################################################6   95816/100000 [00:02<00:00, 36154.86it/s]
    Packets:   ###############################################################################999878/100000 [00:02<00:00, 37485.92it/s]    Iterations:################################################################################20/20 [00:12<00:00,  1.30s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.223e+43 erg / s
            Luminosity absorbed  = 3.961e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.223e+43 erg / s
            Luminosity absorbed  = 3.961e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 35.40 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 35.40 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:19<00:00, 37485.92it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  35.442 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
