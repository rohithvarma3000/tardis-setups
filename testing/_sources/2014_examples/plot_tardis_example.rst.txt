
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-15

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt
    import os





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 16-17

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 17-21

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 22-23

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 23-47

.. code-block:: default

    def find_file(name, path):
        for dirpath, _, filename in os.walk(path):
            if name in filename:
                return os.path.join(dirpath, name)


    def config_modifier(conf):
        conf["montecarlo"]["nthreads"] = 1
        conf["montecarlo"]["last_no_of_packets"] = 1.0e5
        conf["montecarlo"]["no_of_virtual_packets"] = 10

        # conf["atom_data"] = os.path.join(
        #     os.path.expanduser("~"), "Downloads", "tardis-data", conf["atom_data"]
        # )
        conf["atom_data"] = find_file(conf["atom_data"], "/")

        return conf


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    modified_conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 48-51

.. code-block:: default

    sim = run_tardis(modified_conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/work/tardis-setups/tardis-setups/setups/2020/2020_williamson_94I/code_comp_setups/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/work/tardis-setups/tardis-setups/setups/2020/2020_williamson_94I/code_comp_setups/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ################7                                                               8362/40000 [00:00<00:00, 83612.31it/s]
    Packets:   ##################################2                                             17138/40000 [00:00<00:00, 86049.06it/s]
    Packets:   ###################################################8                            25934/40000 [00:00<00:00, 86920.32it/s]
    Packets:   #####################################################################4          34749/40000 [00:00<00:00, 87403.50it/s]    Iterations:####                                                                            1/20 [00:00<00:09,  2.01it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################6                                                              8833/40000 [00:00<00:00, 88328.61it/s]
    Packets:   ###################################4                                            17727/40000 [00:00<00:00, 88687.68it/s]
    Packets:   #####################################################3                          26675/40000 [00:00<00:00, 89048.73it/s]
    Packets:   #######################################################################1        35580/40000 [00:00<00:00, 88832.54it/s]    Iterations:########                                                                        2/20 [00:01<00:10,  1.72it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.798e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.798e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.403 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.403 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################7                                                              8884/40000 [00:00<00:00, 86607.33it/s]
    Packets:   ###################################3                                            17678/40000 [00:00<00:00, 87380.04it/s]
    Packets:   ####################################################9                           26461/40000 [00:00<00:00, 87580.47it/s]
    Packets:   ######################################################################4         35222/40000 [00:00<00:00, 87591.71it/s]    Iterations:############                                                                    3/20 [00:01<00:10,  1.64it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.168e+42 erg / s
            Luminosity absorbed  = 2.550e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.168e+42 erg / s
            Luminosity absorbed  = 2.550e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.442
            5         1.15e+04   1.08e+04  0.223   0.165
            10        1.13e+04   1.07e+04  0.135   0.101
            15         1.1e+04   1.02e+04  0.101  0.0781
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.442
            5         1.15e+04   1.08e+04  0.223   0.165
            10        1.13e+04   1.07e+04  0.135   0.101
            15         1.1e+04   1.02e+04  0.101  0.0781

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9960.403 K
            Expected t_inner for next iteration = 11342.715 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9960.403 K
            Expected t_inner for next iteration = 11342.715 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################5                                                              8776/40000 [00:00<00:00, 87754.02it/s]
    Packets:   ###################################3                                            17658/40000 [00:00<00:00, 88375.02it/s]
    Packets:   #####################################################                           26526/40000 [00:00<00:00, 88513.93it/s]
    Packets:   ######################################################################7         35378/40000 [00:00<00:00, 88444.10it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.460e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.460e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.442   0.498
            5         1.08e+04   1.17e+04   0.165   0.201
            10        1.07e+04   1.14e+04   0.101   0.127
            15        1.02e+04    1.1e+04  0.0781  0.0953
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.442   0.498
            5         1.08e+04   1.17e+04   0.165   0.201
            10        1.07e+04   1.14e+04   0.101   0.127
            15        1.02e+04    1.1e+04  0.0781  0.0953

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11342.715 K
            Expected t_inner for next iteration = 10026.022 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11342.715 K
            Expected t_inner for next iteration = 10026.022 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################6                                                              8845/40000 [00:00<00:00, 88113.96it/s]
    Packets:   ###################################5                                            17760/40000 [00:00<00:00, 88722.36it/s]
    Packets:   #####################################################3                          26669/40000 [00:00<00:00, 88885.88it/s]
    Packets:   #######################################################################1        35581/40000 [00:00<00:00, 88977.70it/s]    Iterations:####################                                                            5/20 [00:03<00:09,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.318e+42 erg / s
            Luminosity absorbed  = 2.681e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.318e+42 erg / s
            Luminosity absorbed  = 2.681e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.498   0.444
            5         1.17e+04   1.09e+04   0.201   0.162
            10        1.14e+04   1.07e+04   0.127   0.101
            15         1.1e+04   1.03e+04  0.0953  0.0769
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.498   0.444
            5         1.17e+04   1.09e+04   0.201   0.162
            10        1.14e+04   1.07e+04   0.127   0.101
            15         1.1e+04   1.03e+04  0.0953  0.0769

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10026.022 K
            Expected t_inner for next iteration = 11314.135 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10026.022 K
            Expected t_inner for next iteration = 11314.135 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################7                                                              8898/40000 [00:00<00:00, 88720.12it/s]
    Packets:   ###################################5                                            17787/40000 [00:00<00:00, 88818.86it/s]
    Packets:   #####################################################4                          26743/40000 [00:00<00:00, 89156.90it/s]
    Packets:   #######################################################################5        35754/40000 [00:00<00:00, 89531.20it/s]    Iterations:########################                                                        6/20 [00:03<00:08,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.343e+43 erg / s
            Luminosity absorbed  = 4.402e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.343e+43 erg / s
            Luminosity absorbed  = 4.402e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.444    0.51
            5         1.09e+04   1.17e+04   0.162   0.201
            10        1.07e+04   1.14e+04   0.101   0.127
            15        1.03e+04    1.1e+04  0.0769  0.0955
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.444    0.51
            5         1.09e+04   1.17e+04   0.162   0.201
            10        1.07e+04   1.14e+04   0.101   0.127
            15        1.03e+04    1.1e+04  0.0769  0.0955

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11314.135 K
            Expected t_inner for next iteration = 10047.862 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11314.135 K
            Expected t_inner for next iteration = 10047.862 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################9                                                              8954/40000 [00:00<00:00, 86032.96it/s]
    Packets:   ###################################4                                            17705/40000 [00:00<00:00, 86885.36it/s]
    Packets:   ####################################################8                           26421/40000 [00:00<00:00, 87007.79it/s]
    Packets:   ######################################################################2         35143/40000 [00:00<00:00, 87088.69it/s]    Iterations:############################                                                    7/20 [00:04<00:08,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.399e+42 erg / s
            Luminosity absorbed  = 2.700e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.399e+42 erg / s
            Luminosity absorbed  = 2.700e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04    0.51   0.443
            5         1.17e+04    1.1e+04   0.201   0.158
            10        1.14e+04   1.07e+04   0.127   0.102
            15         1.1e+04   1.03e+04  0.0955  0.0768
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04    0.51   0.443
            5         1.17e+04    1.1e+04   0.201   0.158
            10        1.14e+04   1.07e+04   0.127   0.102
            15         1.1e+04   1.03e+04  0.0955  0.0768

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10047.862 K
            Expected t_inner for next iteration = 11284.172 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10047.862 K
            Expected t_inner for next iteration = 11284.172 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################6                                                              8829/40000 [00:00<00:00, 88282.51it/s]
    Packets:   ###################################6                                            17840/40000 [00:00<00:00, 89356.89it/s]
    Packets:   #####################################################6                          26807/40000 [00:00<00:00, 89499.12it/s]
    Packets:   #######################################################################6        35836/40000 [00:00<00:00, 89810.95it/s]    Iterations:################################                                                8/20 [00:04<00:07,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.334e+43 erg / s
            Luminosity absorbed  = 4.312e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.334e+43 erg / s
            Luminosity absorbed  = 4.312e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.502
            5          1.1e+04   1.17e+04   0.158   0.197
            10        1.07e+04   1.14e+04   0.102   0.124
            15        1.03e+04    1.1e+04  0.0768  0.0941
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.502
            5          1.1e+04   1.17e+04   0.158   0.197
            10        1.07e+04   1.14e+04   0.102   0.124
            15        1.03e+04    1.1e+04  0.0768  0.0941

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11284.172 K
            Expected t_inner for next iteration = 10056.590 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11284.172 K
            Expected t_inner for next iteration = 10056.590 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################9                                                              8982/40000 [00:00<00:00, 88177.34it/s]
    Packets:   ###################################7                                            17879/40000 [00:00<00:00, 88637.52it/s]
    Packets:   #####################################################6                          26814/40000 [00:00<00:00, 88957.29it/s]
    Packets:   #######################################################################4        35711/40000 [00:00<00:00, 88769.48it/s]    Iterations:####################################                                            9/20 [00:05<00:06,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.442e+42 erg / s
            Luminosity absorbed  = 2.693e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.442e+42 erg / s
            Luminosity absorbed  = 2.693e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.502   0.443
            5         1.17e+04    1.1e+04   0.197   0.161
            10        1.14e+04   1.07e+04   0.124   0.102
            15         1.1e+04   1.04e+04  0.0941  0.0753
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.502   0.443
            5         1.17e+04    1.1e+04   0.197   0.161
            10        1.14e+04   1.07e+04   0.124   0.102
            15         1.1e+04   1.04e+04  0.0941  0.0753

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10056.590 K
            Expected t_inner for next iteration = 11264.873 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10056.590 K
            Expected t_inner for next iteration = 11264.873 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################8                                                              8927/40000 [00:00<00:00, 89263.49it/s]
    Packets:   ###################################7                                            17854/40000 [00:00<00:00, 89245.72it/s]
    Packets:   #####################################################5                          26779/40000 [00:00<00:00, 89003.76it/s]
    Packets:   #######################################################################4        35743/40000 [00:00<00:00, 89249.51it/s]    Iterations:########################################                                        10/20 [00:06<00:06,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.327e+43 erg / s
            Luminosity absorbed  = 4.253e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.327e+43 erg / s
            Luminosity absorbed  = 4.253e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.505
            5          1.1e+04   1.17e+04   0.161   0.197
            10        1.07e+04   1.15e+04   0.102   0.122
            15        1.04e+04   1.11e+04  0.0753  0.0933
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.505
            5          1.1e+04   1.17e+04   0.161   0.197
            10        1.07e+04   1.15e+04   0.102   0.122
            15        1.04e+04   1.11e+04  0.0753  0.0933

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11264.873 K
            Expected t_inner for next iteration = 10062.930 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11264.873 K
            Expected t_inner for next iteration = 10062.930 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################8                                                              8926/40000 [00:00<00:00, 88060.62it/s]
    Packets:   ###################################5                                            17781/40000 [00:00<00:00, 88346.69it/s]
    Packets:   #####################################################3                          26663/40000 [00:00<00:00, 88561.91it/s]
    Packets:   #######################################################################1        35559/40000 [00:00<00:00, 88718.40it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.521e+42 erg / s
            Luminosity absorbed  = 2.645e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.521e+42 erg / s
            Luminosity absorbed  = 2.645e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.444
            5         1.17e+04    1.1e+04   0.197   0.162
            10        1.15e+04   1.09e+04   0.122  0.0958
            15        1.11e+04   1.05e+04  0.0933  0.0744
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.444
            5         1.17e+04    1.1e+04   0.197   0.162
            10        1.15e+04   1.09e+04   0.122  0.0958
            15        1.11e+04   1.05e+04  0.0933  0.0744

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10062.930 K
            Expected t_inner for next iteration = 11220.057 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10062.930 K
            Expected t_inner for next iteration = 11220.057 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################7                                                              8872/40000 [00:00<00:00, 87745.21it/s]
    Packets:   ###################################3                                            17657/40000 [00:00<00:00, 87801.96it/s]
    Packets:   #####################################################                           26519/40000 [00:00<00:00, 88170.29it/s]
    Packets:   ######################################################################8         35425/40000 [00:00<00:00, 88520.44it/s]    Iterations:################################################                                12/20 [00:07<00:05,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.302e+43 erg / s
            Luminosity absorbed  = 4.230e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.302e+43 erg / s
            Luminosity absorbed  = 4.230e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.16e+04   0.444  0.486 
            5          1.1e+04   1.18e+04   0.162   0.19 
            10        1.09e+04   1.14e+04  0.0958  0.121 
            15        1.05e+04   1.11e+04  0.0744  0.089 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.16e+04   0.444  0.486 
            5          1.1e+04   1.18e+04   0.162   0.19 
            10        1.09e+04   1.14e+04  0.0958  0.121 
            15        1.05e+04   1.11e+04  0.0744  0.089 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11220.057 K
            Expected t_inner for next iteration = 10121.498 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11220.057 K
            Expected t_inner for next iteration = 10121.498 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################7                                                              8853/40000 [00:00<00:00, 88346.41it/s]
    Packets:   ###################################3                                            17688/40000 [00:00<00:00, 88341.14it/s]
    Packets:   #####################################################                           26533/40000 [00:00<00:00, 88389.80it/s]
    Packets:   ######################################################################8         35434/40000 [00:00<00:00, 88633.77it/s]    Iterations:####################################################                            13/20 [00:08<00:04,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.695e+42 erg / s
            Luminosity absorbed  = 2.731e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.695e+42 erg / s
            Luminosity absorbed  = 2.731e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.16e+04   1.07e+04  0.486   0.438
            5         1.18e+04    1.1e+04   0.19   0.162
            10        1.14e+04   1.08e+04  0.121   0.101
            15        1.11e+04   1.04e+04  0.089  0.0767
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.16e+04   1.07e+04  0.486   0.438
            5         1.18e+04    1.1e+04   0.19   0.162
            10        1.14e+04   1.08e+04  0.121   0.101
            15        1.11e+04   1.04e+04  0.089  0.0767

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10121.498 K
            Expected t_inner for next iteration = 11171.296 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10121.498 K
            Expected t_inner for next iteration = 11171.296 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################8                                                              8912/40000 [00:00<00:00, 89111.59it/s]
    Packets:   ###################################8                                            17921/40000 [00:00<00:00, 89683.13it/s]
    Packets:   #####################################################7                          26890/40000 [00:00<00:00, 89455.21it/s]
    Packets:   #######################################################################6        35846/40000 [00:00<00:00, 89493.61it/s]    Iterations:########################################################                        14/20 [00:08<00:03,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.284e+43 erg / s
            Luminosity absorbed  = 4.115e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.284e+43 erg / s
            Luminosity absorbed  = 4.115e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.438   0.495
            5          1.1e+04   1.17e+04   0.162   0.191
            10        1.08e+04   1.14e+04   0.101    0.12
            15        1.04e+04    1.1e+04  0.0767  0.0918
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.438   0.495
            5          1.1e+04   1.17e+04   0.162   0.191
            10        1.08e+04   1.14e+04   0.101    0.12
            15        1.04e+04    1.1e+04  0.0767  0.0918

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11171.296 K
            Expected t_inner for next iteration = 10145.811 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11171.296 K
            Expected t_inner for next iteration = 10145.811 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################9                                                              8950/40000 [00:00<00:00, 88118.53it/s]
    Packets:   ###################################6                                            17816/40000 [00:00<00:00, 88432.71it/s]
    Packets:   #####################################################4                          26742/40000 [00:00<00:00, 88804.46it/s]
    Packets:   #######################################################################2        35623/40000 [00:00<00:00, 88768.32it/s]    Iterations:############################################################                    15/20 [00:09<00:03,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.705e+42 erg / s
            Luminosity absorbed  = 2.828e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.705e+42 erg / s
            Luminosity absorbed  = 2.828e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.495   0.449
            5         1.17e+04    1.1e+04   0.191   0.163
            10        1.14e+04   1.09e+04    0.12  0.0997
            15         1.1e+04   1.05e+04  0.0918  0.0768
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.495   0.449
            5         1.17e+04    1.1e+04   0.191   0.163
            10        1.14e+04   1.09e+04    0.12  0.0997
            15         1.1e+04   1.05e+04  0.0918  0.0768

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10145.811 K
            Expected t_inner for next iteration = 11191.850 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10145.811 K
            Expected t_inner for next iteration = 11191.850 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################7                                                              8886/40000 [00:00<00:00, 88848.01it/s]
    Packets:   ###################################6                                            17825/40000 [00:00<00:00, 89163.48it/s]
    Packets:   #####################################################5                          26786/40000 [00:00<00:00, 89364.39it/s]
    Packets:   #######################################################################5        35760/40000 [00:00<00:00, 89512.03it/s]    Iterations:################################################################                16/20 [00:09<00:02,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.284e+43 erg / s
            Luminosity absorbed  = 4.234e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.284e+43 erg / s
            Luminosity absorbed  = 4.234e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.449   0.495
            5          1.1e+04   1.18e+04   0.163   0.184
            10        1.09e+04   1.14e+04  0.0997   0.122
            15        1.05e+04   1.11e+04  0.0768  0.0898
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.449   0.495
            5          1.1e+04   1.18e+04   0.163   0.184
            10        1.09e+04   1.14e+04  0.0997   0.122
            15        1.05e+04   1.11e+04  0.0768  0.0898

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11191.850 K
            Expected t_inner for next iteration = 10164.556 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11191.850 K
            Expected t_inner for next iteration = 10164.556 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################9                                                              8952/40000 [00:00<00:00, 85881.93it/s]
    Packets:   ###################################2                                            17604/40000 [00:00<00:00, 86245.77it/s]
    Packets:   ####################################################6                           26304/40000 [00:00<00:00, 86583.97it/s]
    Packets:   ######################################################################1         35055/40000 [00:00<00:00, 86947.25it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.803e+42 erg / s
            Luminosity absorbed  = 2.816e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.803e+42 erg / s
            Luminosity absorbed  = 2.816e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.495   0.439
            5         1.18e+04   1.11e+04   0.184    0.16
            10        1.14e+04    1.1e+04   0.122  0.0962
            15        1.11e+04   1.05e+04  0.0898  0.0763
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.495   0.439
            5         1.18e+04   1.11e+04   0.184    0.16
            10        1.14e+04    1.1e+04   0.122  0.0962
            15        1.11e+04   1.05e+04  0.0898  0.0763

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10164.556 K
            Expected t_inner for next iteration = 11150.010 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10164.556 K
            Expected t_inner for next iteration = 11150.010 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################3                                                              8696/40000 [00:00<00:00, 86819.74it/s]
    Packets:   ##################################9                                             17456/40000 [00:00<00:00, 87274.42it/s]
    Packets:   ####################################################3                           26184/40000 [00:00<00:00, 87082.17it/s]
    Packets:   #####################################################################7          34893/40000 [00:00<00:00, 87057.22it/s]    Iterations:########################################################################        18/20 [00:11<00:01,  1.57it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.271e+43 erg / s
            Luminosity absorbed  = 4.117e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.271e+43 erg / s
            Luminosity absorbed  = 4.117e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.439   0.492
            5         1.11e+04   1.17e+04    0.16   0.186
            10         1.1e+04   1.15e+04  0.0962   0.117
            15        1.05e+04   1.11e+04  0.0763  0.0876
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.439   0.492
            5         1.11e+04   1.17e+04    0.16   0.186
            10         1.1e+04   1.15e+04  0.0962   0.117
            15        1.05e+04   1.11e+04  0.0763  0.0876

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11150.010 K
            Expected t_inner for next iteration = 10180.809 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11150.010 K
            Expected t_inner for next iteration = 10180.809 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################5                                                              8791/40000 [00:00<00:00, 87908.41it/s]
    Packets:   ###################################2                                            17631/40000 [00:00<00:00, 88194.41it/s]
    Packets:   ####################################################9                           26451/40000 [00:00<00:00, 88024.61it/s]
    Packets:   ######################################################################5         35266/40000 [00:00<00:00, 88070.44it/s]    Iterations:############################################################################    19/20 [00:11<00:00,  1.57it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.820e+42 erg / s
            Luminosity absorbed  = 2.873e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.820e+42 erg / s
            Luminosity absorbed  = 2.873e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.492   0.441
            5         1.17e+04   1.11e+04   0.186   0.161
            10        1.15e+04   1.09e+04   0.117     0.1
            15        1.11e+04   1.05e+04  0.0876  0.0765
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.492   0.441
            5         1.17e+04   1.11e+04   0.186   0.161
            10        1.15e+04   1.09e+04   0.117     0.1
            15        1.11e+04   1.05e+04  0.0876  0.0765

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10180.809 K
            Expected t_inner for next iteration = 11157.125 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10180.809 K
            Expected t_inner for next iteration = 11157.125 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]              
    Packets:   #######                                                                         8808/100000 [00:00<00:06, 14994.80it/s]
    Packets:   ########2                                                                       10308/100000 [00:00<00:05, 14993.12it/s]
    Packets:   #########4                                                                      11852/100000 [00:00<00:05, 15088.91it/s]
    Packets:   ##########6                                                                     13372/100000 [00:00<00:05, 15080.20it/s]
    Packets:   ###########9                                                                    14886/100000 [00:00<00:05, 15066.09it/s]
    Packets:   #############1                                                                  16424/100000 [00:01<00:05, 15147.05it/s]
    Packets:   ##############3                                                                 17943/100000 [00:01<00:05, 15105.98it/s]
    Packets:   ###############5                                                                19456/100000 [00:01<00:05, 15042.39it/s]
    Packets:   ################7                                                               20994/100000 [00:01<00:05, 15138.52it/s]
    Packets:   ##################                                                              22511/100000 [00:01<00:05, 15146.63it/s]
    Packets:   ###################2                                                            24036/100000 [00:01<00:05, 15171.23it/s]
    Packets:   ####################4                                                           25581/100000 [00:01<00:04, 15249.73it/s]
    Packets:   #####################6                                                          27107/100000 [00:01<00:04, 15217.22it/s]
    Packets:   ######################9                                                         28630/100000 [00:01<00:04, 15197.18it/s]
    Packets:   ########################1                                                       30151/100000 [00:01<00:04, 15189.43it/s]
    Packets:   #########################3                                                      31671/100000 [00:02<00:04, 15178.56it/s]
    Packets:   ##########################5                                                     33190/100000 [00:02<00:04, 15155.36it/s]
    Packets:   ###########################7                                                    34723/100000 [00:02<00:04, 15204.32it/s]
    Packets:   ############################9                                                   36247/100000 [00:02<00:04, 15212.78it/s]
    Packets:   ##############################2                                                 37770/100000 [00:02<00:04, 15215.41it/s]
    Packets:   ###############################4                                                39292/100000 [00:02<00:03, 15183.76it/s]
    Packets:   ################################6                                               40811/100000 [00:02<00:03, 15171.87it/s]
    Packets:   #################################8                                              42329/100000 [00:02<00:03, 15113.43it/s]
    Packets:   ###################################                                             43855/100000 [00:02<00:03, 15154.98it/s]
    Packets:   ####################################2                                           45371/100000 [00:02<00:03, 15106.08it/s]
    Packets:   #####################################5                                          46890/100000 [00:03<00:03, 15129.92it/s]
    Packets:   ######################################7                                         48404/100000 [00:03<00:03, 15132.66it/s]
    Packets:   #######################################9                                        49918/100000 [00:03<00:03, 15113.19it/s]
    Packets:   #########################################1                                      51430/100000 [00:03<00:03, 15074.75it/s]
    Packets:   ##########################################3                                     52941/100000 [00:03<00:03, 15080.78it/s]
    Packets:   ###########################################5                                    54460/100000 [00:03<00:03, 15113.40it/s]
    Packets:   ############################################7                                   55972/100000 [00:03<00:02, 15060.02it/s]
    Packets:   ##############################################                                  57533/100000 [00:03<00:02, 15223.64it/s]
    Packets:   ###############################################2                                59056/100000 [00:03<00:02, 15153.37it/s]
    Packets:   ################################################4                               60572/100000 [00:04<00:02, 15105.67it/s]
    Packets:   #################################################6                              62083/100000 [00:04<00:02, 14991.00it/s]
    Packets:   ##################################################8                             63616/100000 [00:04<00:02, 15091.19it/s]
    Packets:   ####################################################1                           65167/100000 [00:04<00:02, 15213.50it/s]
    Packets:   #####################################################3                          66701/100000 [00:04<00:02, 15248.50it/s]
    Packets:   ######################################################5                         68227/100000 [00:04<00:02, 15173.55it/s]
    Packets:   #######################################################8                        69752/100000 [00:04<00:01, 15195.17it/s]
    Packets:   #########################################################                       71285/100000 [00:04<00:01, 15227.66it/s]
    Packets:   ##########################################################2                     72808/100000 [00:04<00:01, 15221.65it/s]
    Packets:   ###########################################################4                    74331/100000 [00:04<00:01, 15178.53it/s]
    Packets:   ############################################################6                   75864/100000 [00:05<00:01, 15216.56it/s]
    Packets:   #############################################################9                  77386/100000 [00:05<00:01, 15039.77it/s]
    Packets:   ###############################################################1                78891/100000 [00:05<00:01, 15006.36it/s]
    Packets:   ################################################################3               80409/100000 [00:05<00:01, 15057.14it/s]
    Packets:   #################################################################5              81915/100000 [00:05<00:01, 15057.86it/s]
    Packets:   ##################################################################7             83445/100000 [00:05<00:01, 15129.68it/s]
    Packets:   ###################################################################9            84992/100000 [00:05<00:00, 15231.06it/s]
    Packets:   #####################################################################2          86516/100000 [00:05<00:00, 15208.20it/s]
    Packets:   ######################################################################4         88037/100000 [00:05<00:00, 15173.61it/s]
    Packets:   #######################################################################6        89559/100000 [00:05<00:00, 15181.76it/s]
    Packets:   ########################################################################8       91093/100000 [00:06<00:00, 15227.81it/s]
    Packets:   ##########################################################################      92616/100000 [00:06<00:00, 15074.50it/s]
    Packets:   ###########################################################################3    94136/100000 [00:06<00:00, 15104.38it/s]
    Packets:   ############################################################################5   95647/100000 [00:06<00:00, 15050.86it/s]
    Packets:   #############################################################################7  97170/100000 [00:06<00:00, 15103.52it/s]
    Packets:   ##############################################################################9 98681/100000 [00:06<00:00, 14950.70it/s]    Iterations:################################################################################20/20 [00:18<00:00,  2.55s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.272e+43 erg / s
            Luminosity absorbed  = 4.149e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.272e+43 erg / s
            Luminosity absorbed  = 4.149e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 41.29 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 41.29 s





.. GENERATED FROM PYTHON SOURCE LINES 52-68

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:21<00:00, 14950.70it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 3 minutes  12.295 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
