
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ###################4                                                            9718/40000 [00:00<00:00, 97175.69it/s]
    Packets:   ########################################3                                       20196/40000 [00:00<00:00, 101630.69it/s]
    Packets:   ############################################################7                   30360/40000 [00:00<00:00, 98641.54it/s]     Iterations:####                                                                            1/20 [00:00<00:08,  2.18it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.508
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.508
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9876/40000 [00:00<00:00, 96662.89it/s]
    Packets:   #######################################                                         19544/40000 [00:00<00:00, 95830.77it/s]
    Packets:   ###########################################################1                    29582/40000 [00:00<00:00, 97886.60it/s]    Iterations:########                                                                        2/20 [00:01<00:10,  1.73it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.798e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.798e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.508  0.548 
            5         1.02e+04   1.15e+04   0.197  0.224 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.508  0.548 
            5         1.02e+04   1.15e+04   0.197  0.224 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.332 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.332 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################3                                                           10168/40000 [00:00<00:00, 101677.43it/s]
    Packets:   ########################################6                                       20336/40000 [00:00<00:00, 100387.83it/s]
    Packets:   ############################################################7                   30376/40000 [00:00<00:00, 99973.81it/s]     Iterations:############                                                                    3/20 [00:01<00:10,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.169e+42 erg / s
            Luminosity absorbed  = 2.549e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.169e+42 erg / s
            Luminosity absorbed  = 2.549e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.548    0.44
            5         1.15e+04   1.08e+04  0.224   0.166
            10        1.13e+04   1.06e+04  0.135   0.101
            15         1.1e+04   1.02e+04  0.101  0.0781
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.548    0.44
            5         1.15e+04   1.08e+04  0.224   0.166
            10        1.13e+04   1.06e+04  0.135   0.101
            15         1.1e+04   1.02e+04  0.101  0.0781

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9960.332 K
            Expected t_inner for next iteration = 11342.043 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9960.332 K
            Expected t_inner for next iteration = 11342.043 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################6                                                           10318/40000 [00:00<00:00, 103172.47it/s]
    Packets:   #########################################9                                      20998/40000 [00:00<00:00, 105300.70it/s]
    Packets:   ###############################################################                 31530/40000 [00:00<00:00, 101937.79it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.357e+43 erg / s
            Luminosity absorbed  = 4.444e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.357e+43 erg / s
            Luminosity absorbed  = 4.444e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04    0.44   0.498
            5         1.08e+04   1.17e+04   0.166     0.2
            10        1.06e+04   1.14e+04   0.101   0.126
            15        1.02e+04   1.11e+04  0.0781  0.0948
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04    0.44   0.498
            5         1.08e+04   1.17e+04   0.166     0.2
            10        1.06e+04   1.14e+04   0.101   0.126
            15        1.02e+04   1.11e+04  0.0781  0.0948

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11342.043 K
            Expected t_inner for next iteration = 10021.078 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11342.043 K
            Expected t_inner for next iteration = 10021.078 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################4                                                           10208/40000 [00:00<00:00, 94910.50it/s]
    Packets:   #######################################6                                        19806/40000 [00:00<00:00, 95515.88it/s]
    Packets:   ###########################################################8                    29946/40000 [00:00<00:00, 98146.77it/s]    Iterations:####################                                                            5/20 [00:03<00:09,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.330e+42 erg / s
            Luminosity absorbed  = 2.649e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.330e+42 erg / s
            Luminosity absorbed  = 2.649e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.498   0.444
            5         1.17e+04   1.09e+04     0.2   0.165
            10        1.14e+04   1.07e+04   0.126   0.103
            15        1.11e+04   1.04e+04  0.0948  0.0759
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.498   0.444
            5         1.17e+04   1.09e+04     0.2   0.165
            10        1.14e+04   1.07e+04   0.126   0.103
            15        1.11e+04   1.04e+04  0.0948  0.0759

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10021.078 K
            Expected t_inner for next iteration = 11300.685 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10021.078 K
            Expected t_inner for next iteration = 11300.685 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################9                                                            9984/40000 [00:00<00:00, 99832.00it/s]
    Packets:   #######################################9                                        19968/40000 [00:00<00:00, 96496.85it/s]
    Packets:   ###########################################################4                    29730/40000 [00:00<00:00, 96999.34it/s]    Iterations:########################                                                        6/20 [00:03<00:09,  1.56it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.438e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.438e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.444  0.503 
            5         1.09e+04   1.17e+04   0.165  0.201 
            10        1.07e+04   1.14e+04   0.103  0.126 
            15        1.04e+04    1.1e+04  0.0759  0.094 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.444  0.503 
            5         1.09e+04   1.17e+04   0.165  0.201 
            10        1.07e+04   1.14e+04   0.103  0.126 
            15        1.04e+04    1.1e+04  0.0759  0.094 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11300.685 K
            Expected t_inner for next iteration = 10081.576 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11300.685 K
            Expected t_inner for next iteration = 10081.576 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################6                                                           10300/40000 [00:00<00:00, 102994.94it/s]
    Packets:   #########################################2                                      20600/40000 [00:00<00:00, 100806.11it/s]
    Packets:   #############################################################3                  30694/40000 [00:00<00:00, 100862.45it/s]    Iterations:############################                                                    7/20 [00:04<00:08,  1.54it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.547e+42 erg / s
            Luminosity absorbed  = 2.701e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.547e+42 erg / s
            Luminosity absorbed  = 2.701e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.16e+04   1.06e+04  0.503    0.44
            5         1.17e+04   1.11e+04  0.201   0.157
            10        1.14e+04   1.08e+04  0.126  0.0999
            15         1.1e+04   1.04e+04  0.094  0.0765
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.16e+04   1.06e+04  0.503    0.44
            5         1.17e+04   1.11e+04  0.201   0.157
            10        1.14e+04   1.08e+04  0.126  0.0999
            15         1.1e+04   1.04e+04  0.094  0.0765

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10081.576 K
            Expected t_inner for next iteration = 11223.347 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10081.576 K
            Expected t_inner for next iteration = 11223.347 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################1                                                           10090/40000 [00:00<00:00, 97208.57it/s]
    Packets:   #######################################6                                        19812/40000 [00:00<00:00, 96330.53it/s]
    Packets:   ###########################################################5                    29768/40000 [00:00<00:00, 97780.44it/s]    Iterations:################################                                                8/20 [00:05<00:07,  1.53it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.207e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.207e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04    0.44   0.505
            5         1.11e+04   1.17e+04   0.157   0.194
            10        1.08e+04   1.14e+04  0.0999   0.122
            15        1.04e+04   1.11e+04  0.0765  0.0918
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04    0.44   0.505
            5         1.11e+04   1.17e+04   0.157   0.194
            10        1.08e+04   1.14e+04  0.0999   0.122
            15        1.04e+04   1.11e+04  0.0765  0.0918

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11223.347 K
            Expected t_inner for next iteration = 10106.464 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11223.347 K
            Expected t_inner for next iteration = 10106.464 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################9                                                            9978/40000 [00:00<00:00, 99754.88it/s]
    Packets:   #######################################9                                        19958/40000 [00:00<00:00, 99774.62it/s]
    Packets:   ###########################################################8                    29936/40000 [00:00<00:00, 97931.99it/s]    Iterations:####################################                                            9/20 [00:05<00:07,  1.53it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.598e+42 erg / s
            Luminosity absorbed  = 2.760e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.598e+42 erg / s
            Luminosity absorbed  = 2.760e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.446
            5         1.17e+04   1.09e+04   0.194   0.165
            10        1.14e+04   1.08e+04   0.122  0.0996
            15        1.11e+04   1.05e+04  0.0918   0.075
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505   0.446
            5         1.17e+04   1.09e+04   0.194   0.165
            10        1.14e+04   1.08e+04   0.122  0.0996
            15        1.11e+04   1.05e+04  0.0918   0.075

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10106.464 K
            Expected t_inner for next iteration = 11217.499 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10106.464 K
            Expected t_inner for next iteration = 11217.499 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9894/40000 [00:00<00:00, 98931.84it/s]
    Packets:   #######################################9                                        19980/40000 [00:00<00:00, 100060.88it/s]
    Packets:   ###########################################################9                    29988/40000 [00:00<00:00, 98506.89it/s]     Iterations:########################################                                        10/20 [00:06<00:06,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.302e+43 erg / s
            Luminosity absorbed  = 4.211e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.302e+43 erg / s
            Luminosity absorbed  = 4.211e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.446   0.511
            5         1.09e+04   1.17e+04   0.165   0.196
            10        1.08e+04   1.14e+04  0.0996   0.125
            15        1.05e+04    1.1e+04   0.075  0.0943
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.446   0.511
            5         1.09e+04   1.17e+04   0.165   0.196
            10        1.08e+04   1.14e+04  0.0996   0.125
            15        1.05e+04    1.1e+04   0.075  0.0943

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11217.499 K
            Expected t_inner for next iteration = 10116.867 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11217.499 K
            Expected t_inner for next iteration = 10116.867 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9854/40000 [00:00<00:00, 90790.95it/s]
    Packets:   #######################################1                                        19564/40000 [00:00<00:00, 94368.66it/s]
    Packets:   ###########################################################3                    29660/40000 [00:00<00:00, 97319.84it/s]    Iterations:############################################                                    11/20 [00:07<00:05,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.654e+42 erg / s
            Luminosity absorbed  = 2.752e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.654e+42 erg / s
            Luminosity absorbed  = 2.752e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.511  0.448 
            5         1.17e+04    1.1e+04   0.196  0.165 
            10        1.14e+04   1.08e+04   0.125    0.1 
            15         1.1e+04   1.04e+04  0.0943  0.078 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.511  0.448 
            5         1.17e+04    1.1e+04   0.196  0.165 
            10        1.14e+04   1.08e+04   0.125    0.1 
            15         1.1e+04   1.04e+04  0.0943  0.078 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10116.867 K
            Expected t_inner for next iteration = 11192.907 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10116.867 K
            Expected t_inner for next iteration = 11192.907 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################4                                                            9746/40000 [00:00<00:00, 96064.35it/s]
    Packets:   #######################################7                                        19898/40000 [00:00<00:00, 99251.62it/s]
    Packets:   ###########################################################6                    29826/40000 [00:00<00:00, 98217.34it/s]    Iterations:################################################                                12/20 [00:07<00:05,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.287e+43 erg / s
            Luminosity absorbed  = 4.208e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.287e+43 erg / s
            Luminosity absorbed  = 4.208e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.06e+04   1.15e+04  0.448  0.485 
            5          1.1e+04   1.17e+04  0.165  0.188 
            10        1.08e+04   1.15e+04    0.1  0.118 
            15        1.04e+04   1.11e+04  0.078  0.089 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.06e+04   1.15e+04  0.448  0.485 
            5          1.1e+04   1.17e+04  0.165  0.188 
            10        1.08e+04   1.15e+04    0.1  0.118 
            15        1.04e+04   1.11e+04  0.078  0.089 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11192.907 K
            Expected t_inner for next iteration = 10153.313 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11192.907 K
            Expected t_inner for next iteration = 10153.313 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################6                                                            9824/40000 [00:00<00:00, 97568.98it/s]
    Packets:   #######################################1                                        19582/40000 [00:00<00:00, 91134.23it/s]
    Packets:   ##########################################################1                     29062/40000 [00:00<00:00, 92740.76it/s]    Iterations:####################################################                            13/20 [00:08<00:04,  1.51it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.776e+42 erg / s
            Luminosity absorbed  = 2.794e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.776e+42 erg / s
            Luminosity absorbed  = 2.794e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.485   0.438
            5         1.17e+04   1.11e+04  0.188   0.162
            10        1.15e+04   1.09e+04  0.118     0.1
            15        1.11e+04   1.04e+04  0.089  0.0771
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.485   0.438
            5         1.17e+04   1.11e+04  0.188   0.162
            10        1.15e+04   1.09e+04  0.118     0.1
            15        1.11e+04   1.04e+04  0.089  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10153.313 K
            Expected t_inner for next iteration = 11155.136 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10153.313 K
            Expected t_inner for next iteration = 11155.136 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################6                                                            9814/40000 [00:00<00:00, 98120.21it/s]
    Packets:   #######################################4                                        19718/40000 [00:00<00:00, 98656.43it/s]
    Packets:   ###########################################################1                    29584/40000 [00:00<00:00, 98207.38it/s]    Iterations:########################################################                        14/20 [00:08<00:03,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.277e+43 erg / s
            Luminosity absorbed  = 4.087e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.277e+43 erg / s
            Luminosity absorbed  = 4.087e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.438   0.487
            5         1.11e+04   1.17e+04   0.162   0.191
            10        1.09e+04   1.14e+04     0.1    0.12
            15        1.04e+04    1.1e+04  0.0771  0.0914
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.438   0.487
            5         1.11e+04   1.17e+04   0.162   0.191
            10        1.09e+04   1.14e+04     0.1    0.12
            15        1.04e+04    1.1e+04  0.0771  0.0914

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11155.136 K
            Expected t_inner for next iteration = 10159.461 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11155.136 K
            Expected t_inner for next iteration = 10159.461 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################6                                                            9822/40000 [00:00<00:00, 95400.15it/s]
    Packets:   #######################################9                                        19966/40000 [00:00<00:00, 98897.86it/s]
    Packets:   ###########################################################7                    29862/40000 [00:00<00:00, 94182.49it/s]    Iterations:############################################################                    15/20 [00:09<00:03,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.772e+42 erg / s
            Luminosity absorbed  = 2.826e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.772e+42 erg / s
            Luminosity absorbed  = 2.826e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.487   0.449
            5         1.17e+04    1.1e+04   0.191   0.164
            10        1.14e+04   1.08e+04    0.12   0.102
            15         1.1e+04   1.04e+04  0.0914  0.0786
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.487   0.449
            5         1.17e+04    1.1e+04   0.191   0.164
            10        1.14e+04   1.08e+04    0.12   0.102
            15         1.1e+04   1.04e+04  0.0914  0.0786

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10159.461 K
            Expected t_inner for next iteration = 11164.254 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10159.461 K
            Expected t_inner for next iteration = 11164.254 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #####################1                                                          10584/40000 [00:00<00:00, 105828.75it/s]
    Packets:   ##########################################3                                     21168/40000 [00:00<00:00, 100228.46it/s]
    Packets:   ##############################################################4                 31212/40000 [00:00<00:00, 100099.73it/s]    Iterations:################################################################                16/20 [00:10<00:02,  1.53it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.271e+43 erg / s
            Luminosity absorbed  = 4.194e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.271e+43 erg / s
            Luminosity absorbed  = 4.194e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.449   0.496
            5          1.1e+04   1.16e+04   0.164   0.192
            10        1.08e+04   1.14e+04   0.102   0.119
            15        1.04e+04   1.11e+04  0.0786  0.0893
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.449   0.496
            5          1.1e+04   1.16e+04   0.164   0.192
            10        1.08e+04   1.14e+04   0.102   0.119
            15        1.04e+04   1.11e+04  0.0786  0.0893

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11164.254 K
            Expected t_inner for next iteration = 10190.232 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11164.254 K
            Expected t_inner for next iteration = 10190.232 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################                                                            10022/40000 [00:00<00:00, 99294.92it/s]
    Packets:   #######################################9                                        19952/40000 [00:00<00:00, 98098.05it/s]
    Packets:   ###########################################################9                    29970/40000 [00:00<00:00, 99037.08it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.897e+42 erg / s
            Luminosity absorbed  = 2.844e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.897e+42 erg / s
            Luminosity absorbed  = 2.844e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.496   0.451
            5         1.16e+04    1.1e+04   0.192   0.168
            10        1.14e+04   1.09e+04   0.119     0.1
            15        1.11e+04   1.05e+04  0.0893  0.0762
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.496   0.451
            5         1.16e+04    1.1e+04   0.192   0.168
            10        1.14e+04   1.09e+04   0.119     0.1
            15        1.11e+04   1.05e+04  0.0893  0.0762

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10190.232 K
            Expected t_inner for next iteration = 11119.158 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10190.232 K
            Expected t_inner for next iteration = 11119.158 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################2                                                           10122/40000 [00:00<00:00, 101207.07it/s]
    Packets:   ########################################4                                       20244/40000 [00:00<00:00, 96102.39it/s] 
    Packets:   ############################################################6                   30326/40000 [00:00<00:00, 98188.84it/s]    Iterations:########################################################################        18/20 [00:11<00:01,  1.52it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.255e+43 erg / s
            Luminosity absorbed  = 4.089e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.255e+43 erg / s
            Luminosity absorbed  = 4.089e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.451   0.499
            5          1.1e+04   1.16e+04   0.168    0.19
            10        1.09e+04   1.13e+04     0.1    0.12
            15        1.05e+04    1.1e+04  0.0762  0.0902
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.451   0.499
            5          1.1e+04   1.16e+04   0.168    0.19
            10        1.09e+04   1.13e+04     0.1    0.12
            15        1.05e+04    1.1e+04  0.0762  0.0902

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11119.158 K
            Expected t_inner for next iteration = 10214.388 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11119.158 K
            Expected t_inner for next iteration = 10214.388 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################                                                            10032/40000 [00:00<00:00, 100314.83it/s]
    Packets:   ########################################1                                       20064/40000 [00:00<00:00, 95695.58it/s] 
    Packets:   ###########################################################3                    29658/40000 [00:00<00:00, 95803.05it/s]    Iterations:############################################################################    19/20 [00:12<00:00,  1.51it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.984e+42 erg / s
            Luminosity absorbed  = 2.868e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.984e+42 erg / s
            Luminosity absorbed  = 2.868e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.499   0.448
            5         1.16e+04   1.11e+04    0.19   0.161
            10        1.13e+04   1.09e+04    0.12  0.0999
            15         1.1e+04   1.05e+04  0.0902  0.0775
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.499   0.448
            5         1.16e+04   1.11e+04    0.19   0.161
            10        1.13e+04   1.09e+04    0.12  0.0999
            15         1.1e+04   1.05e+04  0.0902  0.0775

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10214.388 K
            Expected t_inner for next iteration = 11091.028 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10214.388 K
            Expected t_inner for next iteration = 11091.028 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]              
    Packets:   #######6                                                                        9590/100000 [00:00<00:02, 35598.81it/s]
    Packets:   ##########5                                                                     13150/100000 [00:00<00:02, 35516.66it/s]
    Packets:   #############3                                                                  16696/100000 [00:00<00:02, 35490.44it/s]
    Packets:   ################2                                                               20298/100000 [00:00<00:02, 35656.71it/s]
    Packets:   ###################                                                             23866/100000 [00:00<00:02, 35358.26it/s]
    Packets:   #####################9                                                          27400/100000 [00:00<00:02, 34409.65it/s]
    Packets:   ########################6                                                       30836/100000 [00:00<00:02, 33612.34it/s]
    Packets:   ###########################6                                                    34574/100000 [00:00<00:01, 34723.51it/s]
    Packets:   ##############################4                                                 38052/100000 [00:01<00:01, 34299.11it/s]
    Packets:   #################################2                                              41568/100000 [00:01<00:01, 34549.21it/s]
    Packets:   ####################################1                                           45182/100000 [00:01<00:01, 35014.92it/s]
    Packets:   #######################################                                         48792/100000 [00:01<00:01, 35334.80it/s]
    Packets:   #########################################8                                      52330/100000 [00:01<00:01, 35110.19it/s]
    Packets:   ############################################6                                   55844/100000 [00:01<00:01, 33896.96it/s]
    Packets:   ###############################################3                                59244/100000 [00:01<00:01, 33900.42it/s]
    Packets:   ##################################################1                             62642/100000 [00:01<00:01, 33204.15it/s]
    Packets:   ####################################################9                           66220/100000 [00:01<00:00, 33949.70it/s]
    Packets:   #######################################################7                        69730/100000 [00:02<00:00, 34285.34it/s]
    Packets:   ##########################################################5                     73240/100000 [00:02<00:00, 34522.80it/s]
    Packets:   #############################################################4                  76774/100000 [00:02<00:00, 34759.41it/s]
    Packets:   ################################################################2               80332/100000 [00:02<00:00, 34999.68it/s]
    Packets:   ###################################################################1            83886/100000 [00:02<00:00, 35149.67it/s]
    Packets:   #####################################################################9          87468/100000 [00:02<00:00, 35348.14it/s]
    Packets:   #########################################################################3      91660/100000 [00:02<00:00, 37312.76it/s]
    Packets:   ############################################################################6   95860/100000 [00:02<00:00, 38714.49it/s]    Iterations:################################################################################20/20 [00:15<00:00,  1.48s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.242e+43 erg / s
            Luminosity absorbed  = 4.052e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.242e+43 erg / s
            Luminosity absorbed  = 4.052e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 46.24 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 46.24 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:13<00:00, 38714.49it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 2 minutes  4.051 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
