
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ###################3                                                            9676/40000 [00:00<00:00, 96743.25it/s]
    Packets:   #######################################8                                        19948/40000 [00:00<00:00, 100246.84it/s]
    Packets:   ############################################################4                   30202/40000 [00:00<00:00, 101291.68it/s]    Iterations:####                                                                            1/20 [00:00<00:08,  2.33it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################2                                                           10130/40000 [00:00<00:00, 98848.39it/s]
    Packets:   ########################################1                                       20068/40000 [00:00<00:00, 99146.71it/s]
    Packets:   ############################################################2                   30148/40000 [00:00<00:00, 99895.63it/s]    Iterations:########                                                                        2/20 [00:01<00:09,  1.87it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.794e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.406e+43 erg / s
            Luminosity absorbed  = 4.794e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.547 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.134 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.547 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.134 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9958.849 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9958.849 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################9                                                            9992/40000 [00:00<00:00, 96157.96it/s]
    Packets:   #######################################3                                        19690/40000 [00:00<00:00, 96633.10it/s]
    Packets:   ##########################################################8                     29426/40000 [00:00<00:00, 96957.89it/s]    Iterations:############                                                                    3/20 [00:01<00:09,  1.74it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.167e+42 erg / s
            Luminosity absorbed  = 2.545e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.167e+42 erg / s
            Luminosity absorbed  = 2.545e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547    0.44
            5         1.15e+04   1.08e+04  0.223   0.164
            10        1.13e+04   1.06e+04  0.134   0.102
            15         1.1e+04   1.03e+04  0.101  0.0771
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547    0.44
            5         1.15e+04   1.08e+04  0.223   0.164
            10        1.13e+04   1.06e+04  0.134   0.102
            15         1.1e+04   1.03e+04  0.101  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9958.849 K
            Expected t_inner for next iteration = 11341.542 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9958.849 K
            Expected t_inner for next iteration = 11341.542 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################3                                                            9698/40000 [00:00<00:00, 93691.52it/s]
    Packets:   ######################################1                                         19068/40000 [00:00<00:00, 93082.15it/s]
    Packets:   ##########################################################5                     29280/40000 [00:00<00:00, 97161.13it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.69it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.447e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.356e+43 erg / s
            Luminosity absorbed  = 4.447e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04    0.44   0.497
            5         1.08e+04   1.17e+04   0.164   0.198
            10        1.06e+04   1.14e+04   0.102   0.126
            15        1.03e+04    1.1e+04  0.0771  0.0956
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04    0.44   0.497
            5         1.08e+04   1.17e+04   0.164   0.198
            10        1.06e+04   1.14e+04   0.102   0.126
            15        1.03e+04    1.1e+04  0.0771  0.0956

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11341.542 K
            Expected t_inner for next iteration = 10022.768 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11341.542 K
            Expected t_inner for next iteration = 10022.768 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################4                                                            9722/40000 [00:00<00:00, 92258.42it/s]
    Packets:   ######################################1                                         19100/40000 [00:00<00:00, 93129.02it/s]
    Packets:   ########################################################8                       28416/40000 [00:00<00:00, 92620.87it/s]    Iterations:####################                                                            5/20 [00:02<00:09,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.322e+42 erg / s
            Luminosity absorbed  = 2.663e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.322e+42 erg / s
            Luminosity absorbed  = 2.663e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.497   0.446
            5         1.17e+04   1.09e+04   0.198   0.164
            10        1.14e+04   1.07e+04   0.126     0.1
            15         1.1e+04   1.04e+04  0.0956  0.0751
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.497   0.446
            5         1.17e+04   1.09e+04   0.198   0.164
            10        1.14e+04   1.07e+04   0.126     0.1
            15         1.1e+04   1.04e+04  0.0956  0.0751

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10022.768 K
            Expected t_inner for next iteration = 11307.547 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10022.768 K
            Expected t_inner for next iteration = 11307.547 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################4                                                            9730/40000 [00:00<00:00, 97268.32it/s]
    Packets:   #######################################2                                        19602/40000 [00:00<00:00, 98119.85it/s]
    Packets:   ###########################################################4                    29726/40000 [00:00<00:00, 99541.68it/s]    Iterations:########################                                                        6/20 [00:03<00:08,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.473e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.331e+43 erg / s
            Luminosity absorbed  = 4.473e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.446   0.503
            5         1.09e+04   1.17e+04   0.164   0.201
            10        1.07e+04   1.15e+04     0.1   0.123
            15        1.04e+04    1.1e+04  0.0751  0.0967
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.446   0.503
            5         1.09e+04   1.17e+04   0.164   0.201
            10        1.07e+04   1.15e+04     0.1   0.123
            15        1.04e+04    1.1e+04  0.0751  0.0967

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11307.547 K
            Expected t_inner for next iteration = 10085.646 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11307.547 K
            Expected t_inner for next iteration = 10085.646 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################9                                                            9956/40000 [00:00<00:00, 91051.89it/s]
    Packets:   ######################################7                                         19390/40000 [00:00<00:00, 92901.79it/s]
    Packets:   #########################################################4                      28728/40000 [00:00<00:00, 93111.63it/s]    Iterations:############################                                                    7/20 [00:04<00:08,  1.62it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.566e+42 erg / s
            Luminosity absorbed  = 2.701e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.566e+42 erg / s
            Luminosity absorbed  = 2.701e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.07e+04   0.503   0.435
            5         1.17e+04   1.11e+04   0.201   0.156
            10        1.15e+04   1.08e+04   0.123  0.0986
            15         1.1e+04   1.04e+04  0.0967  0.0753
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.07e+04   0.503   0.435
            5         1.17e+04   1.11e+04   0.201   0.156
            10        1.15e+04   1.08e+04   0.123  0.0986
            15         1.1e+04   1.04e+04  0.0967  0.0753

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10085.646 K
            Expected t_inner for next iteration = 11215.350 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10085.646 K
            Expected t_inner for next iteration = 11215.350 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################                                                            10000/40000 [00:00<00:00, 99987.46it/s]
    Packets:   ########################################                                        20000/40000 [00:00<00:00, 97946.99it/s]
    Packets:   ###########################################################5                    29798/40000 [00:00<00:00, 97935.27it/s]    Iterations:################################                                                8/20 [00:04<00:07,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.301e+43 erg / s
            Luminosity absorbed  = 4.208e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.301e+43 erg / s
            Luminosity absorbed  = 4.208e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.435   0.494
            5         1.11e+04   1.16e+04   0.156   0.199
            10        1.08e+04   1.15e+04  0.0986   0.121
            15        1.04e+04    1.1e+04  0.0753  0.0935
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.435   0.494
            5         1.11e+04   1.16e+04   0.156   0.199
            10        1.08e+04   1.15e+04  0.0986   0.121
            15        1.04e+04    1.1e+04  0.0753  0.0935

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11215.350 K
            Expected t_inner for next iteration = 10118.808 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11215.350 K
            Expected t_inner for next iteration = 10118.808 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################5                                                            9796/40000 [00:00<00:00, 94433.83it/s]
    Packets:   ######################################9                                         19496/40000 [00:00<00:00, 95906.63it/s]
    Packets:   ##########################################################1                     29090/40000 [00:00<00:00, 83100.46it/s]    Iterations:####################################                                            9/20 [00:05<00:06,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.637e+42 erg / s
            Luminosity absorbed  = 2.776e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.637e+42 erg / s
            Luminosity absorbed  = 2.776e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.494    0.44
            5         1.16e+04    1.1e+04   0.199   0.161
            10        1.15e+04   1.08e+04   0.121   0.101
            15         1.1e+04   1.05e+04  0.0935  0.0746
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.494    0.44
            5         1.16e+04    1.1e+04   0.199   0.161
            10        1.15e+04   1.08e+04   0.121   0.101
            15         1.1e+04   1.05e+04  0.0935  0.0746

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10118.808 K
            Expected t_inner for next iteration = 11205.910 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10118.808 K
            Expected t_inner for next iteration = 11205.910 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################6                                                            9840/40000 [00:00<00:00, 98367.96it/s]
    Packets:   #######################################3                                        19678/40000 [00:00<00:00, 97180.66it/s]
    Packets:   ##########################################################9                     29486/40000 [00:00<00:00, 97582.27it/s]    Iterations:########################################                                        10/20 [00:06<00:06,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.172e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.172e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04    0.44   0.502
            5          1.1e+04   1.17e+04   0.161   0.193
            10        1.08e+04   1.14e+04   0.101   0.121
            15        1.05e+04   1.11e+04  0.0746  0.0915
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04    0.44   0.502
            5          1.1e+04   1.17e+04   0.161   0.193
            10        1.08e+04   1.14e+04   0.101   0.121
            15        1.05e+04   1.11e+04  0.0746  0.0915

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11205.910 K
            Expected t_inner for next iteration = 10118.842 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11205.910 K
            Expected t_inner for next iteration = 10118.842 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################5                                                            9760/40000 [00:00<00:00, 94318.30it/s]
    Packets:   ######################################5                                         19252/40000 [00:00<00:00, 94664.81it/s]
    Packets:   #########################################################7                      28874/40000 [00:00<00:00, 95367.63it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.662e+42 erg / s
            Luminosity absorbed  = 2.752e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.662e+42 erg / s
            Luminosity absorbed  = 2.752e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.502   0.445
            5         1.17e+04    1.1e+04   0.193   0.163
            10        1.14e+04   1.08e+04   0.121   0.101
            15        1.11e+04   1.04e+04  0.0915  0.0768
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.502   0.445
            5         1.17e+04    1.1e+04   0.193   0.163
            10        1.14e+04   1.08e+04   0.121   0.101
            15        1.11e+04   1.04e+04  0.0915  0.0768

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10118.842 K
            Expected t_inner for next iteration = 11189.650 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10118.842 K
            Expected t_inner for next iteration = 11189.650 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################6                                                           10306/40000 [00:00<00:00, 103030.87it/s]
    Packets:   #########################################2                                      20610/40000 [00:00<00:00, 100691.12it/s]
    Packets:   #############################################################3                  30688/40000 [00:00<00:00, 100725.39it/s]    Iterations:################################################                                12/20 [00:07<00:04,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.284e+43 erg / s
            Luminosity absorbed  = 4.221e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.284e+43 erg / s
            Luminosity absorbed  = 4.221e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.445   0.485
            5          1.1e+04   1.18e+04   0.163   0.184
            10        1.08e+04   1.15e+04   0.101   0.119
            15        1.04e+04   1.11e+04  0.0768  0.0881
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.445   0.485
            5          1.1e+04   1.18e+04   0.163   0.184
            10        1.08e+04   1.15e+04   0.101   0.119
            15        1.04e+04   1.11e+04  0.0768  0.0881

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11189.650 K
            Expected t_inner for next iteration = 10162.916 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11189.650 K
            Expected t_inner for next iteration = 10162.916 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################1                                                           10076/40000 [00:00<00:00, 95651.52it/s]
    Packets:   #######################################5                                        19758/40000 [00:00<00:00, 96323.20it/s]
    Packets:   ##########################################################8                     29440/40000 [00:00<00:00, 96546.99it/s]    Iterations:####################################################                            13/20 [00:07<00:04,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.811e+42 erg / s
            Luminosity absorbed  = 2.801e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.811e+42 erg / s
            Luminosity absorbed  = 2.801e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.485   0.442
            5         1.18e+04   1.11e+04   0.184   0.161
            10        1.15e+04   1.09e+04   0.119     0.1
            15        1.11e+04   1.05e+04  0.0881  0.0771
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.485   0.442
            5         1.18e+04   1.11e+04   0.184   0.161
            10        1.15e+04   1.09e+04   0.119     0.1
            15        1.11e+04   1.05e+04  0.0881  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10162.916 K
            Expected t_inner for next iteration = 11143.134 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10162.916 K
            Expected t_inner for next iteration = 11143.134 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################1                                                           10096/40000 [00:00<00:00, 100672.79it/s]
    Packets:   ########################################3                                       20164/40000 [00:00<00:00, 100252.55it/s]
    Packets:   ############################################################3                   30190/40000 [00:00<00:00, 96198.99it/s]     Iterations:########################################################                        14/20 [00:08<00:03,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.268e+43 erg / s
            Luminosity absorbed  = 4.103e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.268e+43 erg / s
            Luminosity absorbed  = 4.103e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.442  0.486 
            5         1.11e+04   1.17e+04   0.161  0.191 
            10        1.09e+04   1.13e+04     0.1  0.122 
            15        1.05e+04    1.1e+04  0.0771  0.092 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.442  0.486 
            5         1.11e+04   1.17e+04   0.161  0.191 
            10        1.09e+04   1.13e+04     0.1  0.122 
            15        1.05e+04    1.1e+04  0.0771  0.092 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11143.134 K
            Expected t_inner for next iteration = 10182.896 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11143.134 K
            Expected t_inner for next iteration = 10182.896 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################2                                                            9638/40000 [00:00<00:00, 90878.79it/s]
    Packets:   #####################################4                                          18748/40000 [00:00<00:00, 91000.44it/s]
    Packets:   #######################################################7                        27850/40000 [00:00<00:00, 89987.65it/s]    Iterations:############################################################                    15/20 [00:09<00:03,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.851e+42 erg / s
            Luminosity absorbed  = 2.855e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.851e+42 erg / s
            Luminosity absorbed  = 2.855e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.486   0.455
            5         1.17e+04   1.11e+04  0.191   0.159
            10        1.13e+04   1.09e+04  0.122   0.101
            15         1.1e+04   1.05e+04  0.092  0.0774
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.486   0.455
            5         1.17e+04   1.11e+04  0.191   0.159
            10        1.13e+04   1.09e+04  0.122   0.101
            15         1.1e+04   1.05e+04  0.092  0.0774

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10182.896 K
            Expected t_inner for next iteration = 11140.047 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10182.896 K
            Expected t_inner for next iteration = 11140.047 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################4                                                           10206/40000 [00:00<00:00, 102035.04it/s]
    Packets:   ########################################8                                       20412/40000 [00:00<00:00, 102044.20it/s]
    Packets:   #############################################################2                  30618/40000 [00:00<00:00, 100481.93it/s]    Iterations:################################################################                16/20 [00:09<00:02,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.264e+43 erg / s
            Luminosity absorbed  = 4.123e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.264e+43 erg / s
            Luminosity absorbed  = 4.123e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.455   0.499
            5         1.11e+04   1.16e+04   0.159    0.19
            10        1.09e+04   1.14e+04   0.101   0.119
            15        1.05e+04   1.11e+04  0.0774  0.0885
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.455   0.499
            5         1.11e+04   1.16e+04   0.159    0.19
            10        1.09e+04   1.14e+04   0.101   0.119
            15        1.05e+04   1.11e+04  0.0774  0.0885

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11140.047 K
            Expected t_inner for next iteration = 10197.903 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11140.047 K
            Expected t_inner for next iteration = 10197.903 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################1                                                           10052/40000 [00:00<00:00, 92926.34it/s]
    Packets:   #######################################5                                        19764/40000 [00:00<00:00, 95305.83it/s]
    Packets:   ##########################################################6                     29304/40000 [00:00<00:00, 94562.39it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.950e+42 erg / s
            Luminosity absorbed  = 2.827e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.950e+42 erg / s
            Luminosity absorbed  = 2.827e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.499   0.448
            5         1.16e+04   1.11e+04    0.19   0.166
            10        1.14e+04   1.09e+04   0.119   0.102
            15        1.11e+04   1.05e+04  0.0885  0.0775
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.499   0.448
            5         1.16e+04   1.11e+04    0.19   0.166
            10        1.14e+04   1.09e+04   0.119   0.102
            15        1.11e+04   1.05e+04  0.0885  0.0775

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10197.903 K
            Expected t_inner for next iteration = 11094.504 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10197.903 K
            Expected t_inner for next iteration = 11094.504 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################1                                                            9586/40000 [00:00<00:00, 95848.21it/s]
    Packets:   ######################################7                                         19372/40000 [00:00<00:00, 97023.99it/s]
    Packets:   ##########################################################1                     29092/40000 [00:00<00:00, 97103.45it/s]    Iterations:########################################################################        18/20 [00:11<00:01,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.244e+43 erg / s
            Luminosity absorbed  = 4.056e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.244e+43 erg / s
            Luminosity absorbed  = 4.056e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.448   0.495
            5         1.11e+04   1.16e+04   0.166    0.19
            10        1.09e+04   1.13e+04   0.102   0.122
            15        1.05e+04   1.09e+04  0.0775  0.0916
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.448   0.495
            5         1.11e+04   1.16e+04   0.166    0.19
            10        1.09e+04   1.13e+04   0.102   0.122
            15        1.05e+04   1.09e+04  0.0775  0.0916

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11094.504 K
            Expected t_inner for next iteration = 10238.200 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11094.504 K
            Expected t_inner for next iteration = 10238.200 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################4                                                            9712/40000 [00:00<00:00, 93131.32it/s]
    Packets:   ######################################                                          19026/40000 [00:00<00:00, 92777.73it/s]
    Packets:   ########################################################7                       28398/40000 [00:00<00:00, 93200.64it/s]    Iterations:############################################################################    19/20 [00:11<00:00,  1.60it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.055e+42 erg / s
            Luminosity absorbed  = 2.909e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.055e+42 erg / s
            Luminosity absorbed  = 2.909e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.495   0.447
            5         1.16e+04   1.11e+04    0.19   0.165
            10        1.13e+04   1.09e+04   0.122   0.103
            15        1.09e+04   1.04e+04  0.0916  0.0794
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.495   0.447
            5         1.16e+04   1.11e+04    0.19   0.165
            10        1.13e+04   1.09e+04   0.122   0.103
            15        1.09e+04   1.04e+04  0.0916  0.0794

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10238.200 K
            Expected t_inner for next iteration = 11073.533 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10238.200 K
            Expected t_inner for next iteration = 11073.533 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]              
    Packets:   #######4                                                                        9322/100000 [00:00<00:02, 33657.49it/s]
    Packets:   ##########1                                                                     12688/100000 [00:00<00:02, 33419.22it/s]
    Packets:   ############8                                                                   16014/100000 [00:00<00:02, 32889.97it/s]
    Packets:   ###############4                                                                19276/100000 [00:00<00:02, 32674.81it/s]
    Packets:   ##################                                                              22546/100000 [00:00<00:02, 32682.29it/s]
    Packets:   ####################6                                                           25802/100000 [00:00<00:02, 32336.64it/s]
    Packets:   #######################2                                                        29102/100000 [00:00<00:02, 32531.54it/s]
    Packets:   #########################8                                                      32350/100000 [00:00<00:02, 32322.86it/s]
    Packets:   ############################5                                                   35626/100000 [00:01<00:01, 32446.23it/s]
    Packets:   ###############################1                                                38942/100000 [00:01<00:01, 32646.13it/s]
    Packets:   #################################7                                              42206/100000 [00:01<00:01, 32382.39it/s]
    Packets:   ####################################4                                           45518/100000 [00:01<00:01, 32601.92it/s]
    Packets:   #######################################                                         48778/100000 [00:01<00:01, 32363.12it/s]
    Packets:   #########################################6                                      52016/100000 [00:01<00:01, 32291.06it/s]
    Packets:   ############################################2                                   55370/100000 [00:01<00:01, 32659.64it/s]
    Packets:   ##############################################9                                 58638/100000 [00:01<00:01, 32633.12it/s]
    Packets:   #################################################5                              61902/100000 [00:01<00:01, 32175.21it/s]
    Packets:   ####################################################                            65122/100000 [00:02<00:01, 32109.52it/s]
    Packets:   ######################################################8                         68522/100000 [00:02<00:00, 32669.39it/s]
    Packets:   #########################################################4                      71792/100000 [00:02<00:00, 32674.15it/s]
    Packets:   ############################################################                    75062/100000 [00:02<00:00, 32184.25it/s]
    Packets:   ##############################################################6                 78338/100000 [00:02<00:00, 32347.12it/s]
    Packets:   #################################################################3              81654/100000 [00:02<00:00, 32584.92it/s]
    Packets:   ###################################################################9            84914/100000 [00:02<00:00, 32274.61it/s]
    Packets:   ######################################################################5         88178/100000 [00:02<00:00, 32374.67it/s]
    Packets:   #########################################################################5      91932/100000 [00:02<00:00, 33905.43it/s]
    Packets:   ##############################################################################  97546/100000 [00:02<00:00, 40532.17it/s]    Iterations:################################################################################20/20 [00:15<00:00,  1.48s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.235e+43 erg / s
            Luminosity absorbed  = 4.021e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.235e+43 erg / s
            Luminosity absorbed  = 4.021e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 40.75 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 40.75 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:21<00:00, 40532.17it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  53.802 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
