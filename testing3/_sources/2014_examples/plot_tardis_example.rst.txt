
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ###################3                                                            9692/40000 [00:00<00:00, 96915.70it/s]
    Packets:   #######################################7                                        19864/40000 [00:00<00:00, 99741.48it/s]
    Packets:   ############################################################9                   30466/40000 [00:00<00:00, 102605.38it/s]    Iterations:####                                                                            1/20 [00:00<00:08,  2.37it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.88e+03  0.105  0.0868
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.88e+03  0.105  0.0868

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################8                                                         11402/40000 [00:00<00:00, 113998.64it/s]
    Packets:   #############################################6                                  22802/40000 [00:00<00:00, 110799.15it/s]
    Packets:   #####################################################################2          34614/40000 [00:00<00:00, 114079.50it/s]    Iterations:########                                                                        2/20 [00:00<00:09,  1.95it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.797e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.797e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.88e+03    1.1e+04  0.0868  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.88e+03    1.1e+04  0.0868  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9959.848 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9959.848 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################1                                                        11566/40000 [00:00<00:00, 115642.46it/s]
    Packets:   ##############################################5                                 23288/40000 [00:00<00:00, 116515.21it/s]
    Packets:   #####################################################################8          34940/40000 [00:00<00:00, 113078.28it/s]    Iterations:############                                                                    3/20 [00:01<00:09,  1.86it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.177e+42 erg / s
            Luminosity absorbed  = 2.540e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.177e+42 erg / s
            Luminosity absorbed  = 2.540e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.438
            5         1.15e+04   1.08e+04  0.223   0.164
            10        1.13e+04   1.06e+04  0.135   0.103
            15         1.1e+04   1.03e+04  0.101  0.0771
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.438
            5         1.15e+04   1.08e+04  0.223   0.164
            10        1.13e+04   1.06e+04  0.135   0.103
            15         1.1e+04   1.03e+04  0.101  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9959.848 K
            Expected t_inner for next iteration = 11335.754 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9959.848 K
            Expected t_inner for next iteration = 11335.754 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################7                                                         11372/40000 [00:00<00:00, 113594.71it/s]
    Packets:   #############################################4                                  22732/40000 [00:00<00:00, 112560.57it/s]
    Packets:   #####################################################################3          34654/40000 [00:00<00:00, 115581.05it/s]    Iterations:################                                                                4/20 [00:02<00:08,  1.82it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.354e+43 erg / s
            Luminosity absorbed  = 4.433e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.354e+43 erg / s
            Luminosity absorbed  = 4.433e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.438   0.501
            5         1.08e+04   1.17e+04   0.164     0.2
            10        1.06e+04   1.14e+04   0.103    0.13
            15        1.03e+04   1.11e+04  0.0771  0.0943
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.438   0.501
            5         1.08e+04   1.17e+04   0.164     0.2
            10        1.06e+04   1.14e+04   0.103    0.13
            15        1.03e+04   1.11e+04  0.0771  0.0943

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11335.754 K
            Expected t_inner for next iteration = 10025.725 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11335.754 K
            Expected t_inner for next iteration = 10025.725 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################1                                                        11562/40000 [00:00<00:00, 109819.52it/s]
    Packets:   #############################################4                                  22706/40000 [00:00<00:00, 110748.26it/s]
    Packets:   ###################################################################5            33784/40000 [00:00<00:00, 108777.45it/s]    Iterations:####################                                                            5/20 [00:02<00:08,  1.79it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.331e+42 erg / s
            Luminosity absorbed  = 2.668e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.331e+42 erg / s
            Luminosity absorbed  = 2.668e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.501   0.445
            5         1.17e+04   1.09e+04     0.2   0.165
            10        1.14e+04   1.07e+04    0.13   0.102
            15        1.11e+04   1.03e+04  0.0943  0.0768
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.501   0.445
            5         1.17e+04   1.09e+04     0.2   0.165
            10        1.14e+04   1.07e+04    0.13   0.102
            15        1.11e+04   1.03e+04  0.0943  0.0768

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10025.725 K
            Expected t_inner for next iteration = 11304.954 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10025.725 K
            Expected t_inner for next iteration = 11304.954 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################3                                                        11652/40000 [00:00<00:00, 116497.06it/s]
    Packets:   ##############################################6                                 23344/40000 [00:00<00:00, 116743.76it/s]
    Packets:   ######################################################################9         35454/40000 [00:00<00:00, 118725.49it/s]    Iterations:########################                                                        6/20 [00:03<00:07,  1.78it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.329e+43 erg / s
            Luminosity absorbed  = 4.478e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.329e+43 erg / s
            Luminosity absorbed  = 4.478e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.445   0.499
            5         1.09e+04   1.16e+04   0.165   0.204
            10        1.07e+04   1.14e+04   0.102   0.126
            15        1.03e+04    1.1e+04  0.0768  0.0965
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.445   0.499
            5         1.09e+04   1.16e+04   0.165   0.204
            10        1.07e+04   1.14e+04   0.102   0.126
            15        1.03e+04    1.1e+04  0.0768  0.0965

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11304.954 K
            Expected t_inner for next iteration = 10091.170 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11304.954 K
            Expected t_inner for next iteration = 10091.170 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################7                                                        11874/40000 [00:00<00:00, 114971.33it/s]
    Packets:   ##############################################7                                 23372/40000 [00:00<00:00, 113761.76it/s]
    Packets:   ######################################################################4         35206/40000 [00:00<00:00, 115820.34it/s]    Iterations:############################                                                    7/20 [00:03<00:07,  1.78it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.574e+42 erg / s
            Luminosity absorbed  = 2.719e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.574e+42 erg / s
            Luminosity absorbed  = 2.719e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.499   0.445
            5         1.16e+04    1.1e+04   0.204    0.16
            10        1.14e+04   1.08e+04   0.126  0.0992
            15         1.1e+04   1.04e+04  0.0965  0.0769
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.499   0.445
            5         1.16e+04    1.1e+04   0.204    0.16
            10        1.14e+04   1.08e+04   0.126  0.0992
            15         1.1e+04   1.04e+04  0.0965  0.0769

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10091.170 K
            Expected t_inner for next iteration = 11216.248 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10091.170 K
            Expected t_inner for next iteration = 11216.248 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################1                                                        11586/40000 [00:00<00:00, 106687.76it/s]
    Packets:   ##############################################5                                 23292/40000 [00:00<00:00, 112573.06it/s]
    Packets:   ########################################################################        36004/40000 [00:00<00:00, 119084.99it/s]    Iterations:################################                                                8/20 [00:04<00:06,  1.77it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.301e+43 erg / s
            Luminosity absorbed  = 4.219e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.301e+43 erg / s
            Luminosity absorbed  = 4.219e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.445   0.504
            5          1.1e+04   1.17e+04    0.16   0.195
            10        1.08e+04   1.14e+04  0.0992   0.122
            15        1.04e+04    1.1e+04  0.0769  0.0936
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.445   0.504
            5          1.1e+04   1.17e+04    0.16   0.195
            10        1.08e+04   1.14e+04  0.0992   0.122
            15        1.04e+04    1.1e+04  0.0769  0.0936

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11216.248 K
            Expected t_inner for next iteration = 10121.184 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11216.248 K
            Expected t_inner for next iteration = 10121.184 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################8                                                        11934/40000 [00:00<00:00, 111485.64it/s]
    Packets:   ##############################################1                                 23084/40000 [00:00<00:00, 109251.45it/s]
    Packets:   #####################################################################1          34576/40000 [00:00<00:00, 111771.12it/s]    Iterations:####################################                                            9/20 [00:05<00:06,  1.74it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.648e+42 erg / s
            Luminosity absorbed  = 2.777e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.648e+42 erg / s
            Luminosity absorbed  = 2.777e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.504   0.447
            5         1.17e+04    1.1e+04   0.195   0.166
            10        1.14e+04   1.08e+04   0.122   0.102
            15         1.1e+04   1.05e+04  0.0936  0.0758
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.504   0.447
            5         1.17e+04    1.1e+04   0.195   0.166
            10        1.14e+04   1.08e+04   0.122   0.102
            15         1.1e+04   1.05e+04  0.0936  0.0758

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10121.184 K
            Expected t_inner for next iteration = 11201.756 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10121.184 K
            Expected t_inner for next iteration = 11201.756 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################3                                                         11184/40000 [00:00<00:00, 108100.67it/s]
    Packets:   ############################################3                                   22174/40000 [00:00<00:00, 109134.34it/s]
    Packets:   ####################################################################4           34210/40000 [00:00<00:00, 114209.54it/s]    Iterations:########################################                                        10/20 [00:05<00:05,  1.74it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.149e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.299e+43 erg / s
            Luminosity absorbed  = 4.149e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.447   0.504
            5          1.1e+04   1.17e+04   0.166   0.195
            10        1.08e+04   1.14e+04   0.102   0.124
            15        1.05e+04    1.1e+04  0.0758  0.0928
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.447   0.504
            5          1.1e+04   1.17e+04   0.166   0.195
            10        1.08e+04   1.14e+04   0.102   0.124
            15        1.05e+04    1.1e+04  0.0758  0.0928

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11201.756 K
            Expected t_inner for next iteration = 10114.610 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11201.756 K
            Expected t_inner for next iteration = 10114.610 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################8                                                         11426/40000 [00:00<00:00, 101557.17it/s]
    Packets:   ############################################3                                   22184/40000 [00:00<00:00, 104925.14it/s]
    Packets:   ##################################################################8             33430/40000 [00:00<00:00, 108269.09it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.73it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.663e+42 erg / s
            Luminosity absorbed  = 2.734e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.663e+42 erg / s
            Luminosity absorbed  = 2.734e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.504   0.447
            5         1.17e+04    1.1e+04   0.195   0.165
            10        1.14e+04   1.08e+04   0.124   0.103
            15         1.1e+04   1.04e+04  0.0928  0.0787
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.504   0.447
            5         1.17e+04    1.1e+04   0.195   0.165
            10        1.14e+04   1.08e+04   0.124   0.103
            15         1.1e+04   1.04e+04  0.0928  0.0787

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10114.610 K
            Expected t_inner for next iteration = 11184.601 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10114.610 K
            Expected t_inner for next iteration = 11184.601 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################4                                                         11226/40000 [00:00<00:00, 112243.25it/s]
    Packets:   ############################################9                                   22452/40000 [00:00<00:00, 111676.98it/s]
    Packets:   #####################################################################2          34620/40000 [00:00<00:00, 116227.29it/s]    Iterations:################################################                                12/20 [00:06<00:04,  1.74it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.285e+43 erg / s
            Luminosity absorbed  = 4.188e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.285e+43 erg / s
            Luminosity absorbed  = 4.188e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.447  0.489 
            5          1.1e+04   1.17e+04   0.165   0.19 
            10        1.08e+04   1.13e+04   0.103  0.123 
            15        1.04e+04    1.1e+04  0.0787  0.092 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.447  0.489 
            5          1.1e+04   1.17e+04   0.165   0.19 
            10        1.08e+04   1.13e+04   0.103  0.123 
            15        1.04e+04    1.1e+04  0.0787  0.092 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11184.601 K
            Expected t_inner for next iteration = 10156.552 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11184.601 K
            Expected t_inner for next iteration = 10156.552 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################2                                                        11626/40000 [00:00<00:00, 113992.92it/s]
    Packets:   ##############################################4                                 23220/40000 [00:00<00:00, 115128.22it/s]
    Packets:   ######################################################################1         35092/40000 [00:00<00:00, 116757.54it/s]    Iterations:####################################################                            13/20 [00:07<00:03,  1.76it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.803e+42 erg / s
            Luminosity absorbed  = 2.782e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.803e+42 erg / s
            Luminosity absorbed  = 2.782e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.489    0.44
            5         1.17e+04   1.11e+04   0.19   0.162
            10        1.13e+04   1.09e+04  0.123  0.0985
            15         1.1e+04   1.04e+04  0.092  0.0775
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.07e+04  0.489    0.44
            5         1.17e+04   1.11e+04   0.19   0.162
            10        1.13e+04   1.09e+04  0.123  0.0985
            15         1.1e+04   1.04e+04  0.092  0.0775

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10156.552 K
            Expected t_inner for next iteration = 11141.028 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10156.552 K
            Expected t_inner for next iteration = 11141.028 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################3                                                        11678/40000 [00:00<00:00, 113257.08it/s]
    Packets:   ##############################################                                  23004/40000 [00:00<00:00, 111167.76it/s]
    Packets:   #####################################################################8          34900/40000 [00:00<00:00, 114658.74it/s]    Iterations:########################################################                        14/20 [00:07<00:03,  1.76it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.269e+43 erg / s
            Luminosity absorbed  = 4.085e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.269e+43 erg / s
            Luminosity absorbed  = 4.085e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04    0.44   0.487
            5         1.11e+04   1.16e+04   0.162   0.196
            10        1.09e+04   1.13e+04  0.0985   0.123
            15        1.04e+04    1.1e+04  0.0775  0.0922
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04    0.44   0.487
            5         1.11e+04   1.16e+04   0.162   0.196
            10        1.09e+04   1.13e+04  0.0985   0.123
            15        1.04e+04    1.1e+04  0.0775  0.0922

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11141.028 K
            Expected t_inner for next iteration = 10178.702 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11141.028 K
            Expected t_inner for next iteration = 10178.702 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################9                                                         11472/40000 [00:00<00:00, 104801.87it/s]
    Packets:   ###########################################9                                    21954/40000 [00:00<00:00, 102618.58it/s]
    Packets:   #################################################################8              32942/40000 [00:00<00:00, 105822.42it/s]    Iterations:############################################################                    15/20 [00:08<00:02,  1.74it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.835e+42 erg / s
            Luminosity absorbed  = 2.851e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.835e+42 erg / s
            Luminosity absorbed  = 2.851e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.487   0.455
            5         1.16e+04    1.1e+04   0.196   0.165
            10        1.13e+04   1.09e+04   0.123   0.101
            15         1.1e+04   1.04e+04  0.0922  0.0796
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.487   0.455
            5         1.16e+04    1.1e+04   0.196   0.165
            10        1.13e+04   1.09e+04   0.123   0.101
            15         1.1e+04   1.04e+04  0.0922  0.0796

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10178.702 K
            Expected t_inner for next iteration = 11145.381 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10178.702 K
            Expected t_inner for next iteration = 11145.381 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################5                                                          10756/40000 [00:00<00:00, 107559.85it/s]
    Packets:   ###########################################                                     21512/40000 [00:00<00:00, 97956.81it/s] 
    Packets:   ###################################################################5            33764/40000 [00:00<00:00, 108604.87it/s]    Iterations:################################################################                16/20 [00:09<00:02,  1.74it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.269e+43 erg / s
            Luminosity absorbed  = 4.106e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.269e+43 erg / s
            Luminosity absorbed  = 4.106e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.455   0.491
            5          1.1e+04   1.16e+04   0.165   0.191
            10        1.09e+04   1.15e+04   0.101   0.118
            15        1.04e+04    1.1e+04  0.0796  0.0902
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.455   0.491
            5          1.1e+04   1.16e+04   0.165   0.191
            10        1.09e+04   1.15e+04   0.101   0.118
            15        1.04e+04    1.1e+04  0.0796  0.0902

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11145.381 K
            Expected t_inner for next iteration = 10181.521 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11145.381 K
            Expected t_inner for next iteration = 10181.521 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################8                                                          10948/40000 [00:00<00:00, 106675.31it/s]
    Packets:   ###########################################2                                    21616/40000 [00:00<00:00, 104027.58it/s]
    Packets:   ################################################################                32028/40000 [00:00<00:00, 104064.00it/s]    Iterations:####################################################################            17/20 [00:09<00:01,  1.72it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.893e+42 erg / s
            Luminosity absorbed  = 2.809e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.893e+42 erg / s
            Luminosity absorbed  = 2.809e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.491   0.442
            5         1.16e+04   1.11e+04   0.191   0.161
            10        1.15e+04    1.1e+04   0.118  0.0982
            15         1.1e+04   1.05e+04  0.0902  0.0765
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.491   0.442
            5         1.16e+04   1.11e+04   0.191   0.161
            10        1.15e+04    1.1e+04   0.118  0.0982
            15         1.1e+04   1.05e+04  0.0902  0.0765

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10181.521 K
            Expected t_inner for next iteration = 11111.865 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10181.521 K
            Expected t_inner for next iteration = 11111.865 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #######################2                                                        11644/40000 [00:00<00:00, 116422.90it/s]
    Packets:   ##############################################5                                 23288/40000 [00:00<00:00, 113358.05it/s]
    Packets:   #####################################################################3          34684/40000 [00:00<00:00, 113622.26it/s]    Iterations:########################################################################        18/20 [00:10<00:01,  1.73it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.252e+43 erg / s
            Luminosity absorbed  = 4.075e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.252e+43 erg / s
            Luminosity absorbed  = 4.075e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.442   0.488
            5         1.11e+04   1.16e+04   0.161   0.189
            10         1.1e+04   1.14e+04  0.0982   0.117
            15        1.05e+04    1.1e+04  0.0765  0.0902
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.442   0.488
            5         1.11e+04   1.16e+04   0.161   0.189
            10         1.1e+04   1.14e+04  0.0982   0.117
            15        1.05e+04    1.1e+04  0.0765  0.0902

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11111.865 K
            Expected t_inner for next iteration = 10220.822 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11111.865 K
            Expected t_inner for next iteration = 10220.822 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ######################7                                                         11366/40000 [00:00<00:00, 107887.73it/s]
    Packets:   ############################################3                                   22156/40000 [00:00<00:00, 103966.54it/s]
    Packets:   ###################################################################             33510/40000 [00:00<00:00, 108187.62it/s]    Iterations:############################################################################    19/20 [00:10<00:00,  1.73it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.033e+42 erg / s
            Luminosity absorbed  = 2.851e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.033e+42 erg / s
            Luminosity absorbed  = 2.851e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.488   0.445
            5         1.16e+04   1.11e+04   0.189   0.162
            10        1.14e+04    1.1e+04   0.117   0.098
            15         1.1e+04   1.05e+04  0.0902  0.0766
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.488   0.445
            5         1.16e+04   1.11e+04   0.189   0.162
            10        1.14e+04    1.1e+04   0.117   0.098
            15         1.1e+04   1.05e+04  0.0902  0.0766

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10220.822 K
            Expected t_inner for next iteration = 11068.211 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10220.822 K
            Expected t_inner for next iteration = 11068.211 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]               
    Packets:   ########6                                                                       10834/100000 [00:00<00:02, 40591.68it/s]
    Packets:   ###########9                                                                    14894/100000 [00:00<00:02, 40080.93it/s]
    Packets:   ###############1                                                                18894/100000 [00:00<00:02, 40052.16it/s]
    Packets:   ##################3                                                             22940/100000 [00:00<00:01, 40181.05it/s]
    Packets:   #####################5                                                          26950/100000 [00:00<00:01, 39527.85it/s]
    Packets:   ########################8                                                       31058/100000 [00:00<00:01, 39992.01it/s]
    Packets:   ############################2                                                   35312/100000 [00:00<00:01, 40766.45it/s]
    Packets:   ###############################5                                                39394/100000 [00:00<00:01, 40096.56it/s]
    Packets:   ##################################7                                             43406/100000 [00:01<00:01, 40012.90it/s]
    Packets:   #####################################9                                          47410/100000 [00:01<00:01, 38882.87it/s]
    Packets:   #########################################1                                      51464/100000 [00:01<00:01, 39363.23it/s]
    Packets:   ############################################3                                   55406/100000 [00:01<00:01, 39206.44it/s]
    Packets:   ###############################################4                                59330/100000 [00:01<00:01, 39216.26it/s]
    Packets:   ##################################################6                             63274/100000 [00:01<00:00, 39278.41it/s]
    Packets:   #####################################################7                          67228/100000 [00:01<00:00, 39354.03it/s]
    Packets:   ########################################################9                       71166/100000 [00:01<00:00, 39165.66it/s]
    Packets:   ############################################################1                   75148/100000 [00:01<00:00, 39358.22it/s]
    Packets:   ###############################################################3                79200/100000 [00:01<00:00, 39704.55it/s]
    Packets:   ##################################################################5             83182/100000 [00:02<00:00, 39737.43it/s]
    Packets:   #####################################################################7          87158/100000 [00:02<00:00, 39271.80it/s]
    Packets:   ########################################################################9       91200/100000 [00:02<00:00, 39610.86it/s]
    Packets:   #############################################################################   96298/100000 [00:02<00:00, 42995.74it/s]    Iterations:################################################################################20/20 [00:13<00:00,  1.29s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.231e+43 erg / s
            Luminosity absorbed  = 4.024e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.231e+43 erg / s
            Luminosity absorbed  = 4.024e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 41.24 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 41.24 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:20<00:00, 42995.74it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  51.786 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
