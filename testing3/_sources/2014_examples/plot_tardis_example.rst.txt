
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ##################6                                                             9312/40000 [00:00<00:00, 93109.88it/s]
    Packets:   #####################################2                                          18624/40000 [00:00<00:00, 91615.10it/s]
    Packets:   ########################################################3                       28186/40000 [00:00<00:00, 93423.75it/s]    Iterations:####                                                                            1/20 [00:00<00:08,  2.21it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.507
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ####################4                                                           10214/40000 [00:00<00:00, 102129.63it/s]
    Packets:   #########################################                                       20512/40000 [00:00<00:00, 102626.72it/s]
    Packets:   #############################################################7                  30876/40000 [00:00<00:00, 103082.70it/s]    Iterations:########                                                                        2/20 [00:01<00:09,  1.85it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.799e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.799e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.547 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.507  0.547 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.725 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9960.725 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################6                                                           10310/40000 [00:00<00:00, 98507.63it/s]
    Packets:   ########################################9                                       20496/40000 [00:00<00:00, 100433.13it/s]
    Packets:   #############################################################                   30544/40000 [00:00<00:00, 100007.96it/s]    Iterations:############                                                                    3/20 [00:01<00:09,  1.75it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.177e+42 erg / s
            Luminosity absorbed  = 2.544e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.177e+42 erg / s
            Luminosity absorbed  = 2.544e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547   0.441
            5         1.15e+04   1.08e+04  0.223   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0784
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547   0.441
            5         1.15e+04   1.08e+04  0.223   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0784

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9960.725 K
            Expected t_inner for next iteration = 11337.259 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9960.725 K
            Expected t_inner for next iteration = 11337.259 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################4                                                           10222/40000 [00:00<00:00, 102195.98it/s]
    Packets:   ########################################9                                       20476/40000 [00:00<00:00, 102395.80it/s]
    Packets:   #############################################################4                  30716/40000 [00:00<00:00, 102211.28it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.72it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.355e+43 erg / s
            Luminosity absorbed  = 4.429e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.355e+43 erg / s
            Luminosity absorbed  = 4.429e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.441   0.503
            5         1.08e+04   1.17e+04   0.166   0.199
            10        1.06e+04   1.14e+04   0.102   0.128
            15        1.02e+04   1.11e+04  0.0784  0.0939
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.441   0.503
            5         1.08e+04   1.17e+04   0.166   0.199
            10        1.06e+04   1.14e+04   0.102   0.128
            15        1.02e+04   1.11e+04  0.0784  0.0939

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11337.259 K
            Expected t_inner for next iteration = 10022.498 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11337.259 K
            Expected t_inner for next iteration = 10022.498 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################9                                                           10488/40000 [00:00<00:00, 104878.85it/s]
    Packets:   #########################################9                                      20976/40000 [00:00<00:00, 103982.72it/s]
    Packets:   ##############################################################7                 31376/40000 [00:00<00:00, 101685.87it/s]    Iterations:####################                                                            5/20 [00:02<00:08,  1.68it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.330e+42 erg / s
            Luminosity absorbed  = 2.654e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.330e+42 erg / s
            Luminosity absorbed  = 2.654e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.503   0.446
            5         1.17e+04   1.09e+04   0.199   0.164
            10        1.14e+04   1.07e+04   0.128   0.101
            15        1.11e+04   1.04e+04  0.0939  0.0744
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.05e+04   0.503   0.446
            5         1.17e+04   1.09e+04   0.199   0.164
            10        1.14e+04   1.07e+04   0.128   0.101
            15        1.11e+04   1.04e+04  0.0939  0.0744

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10022.498 K
            Expected t_inner for next iteration = 11302.116 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10022.498 K
            Expected t_inner for next iteration = 11302.116 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################5                                                           10260/40000 [00:00<00:00, 102593.00it/s]
    Packets:   #########################################5                                      20762/40000 [00:00<00:00, 104015.56it/s]
    Packets:   ##############################################################8                 31428/40000 [00:00<00:00, 105221.57it/s]    Iterations:########################                                                        6/20 [00:03<00:08,  1.68it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.330e+43 erg / s
            Luminosity absorbed  = 4.453e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.330e+43 erg / s
            Luminosity absorbed  = 4.453e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.15e+04   0.446  0.503 
            5         1.09e+04   1.16e+04   0.164  0.202 
            10        1.07e+04   1.14e+04   0.101  0.126 
            15        1.04e+04    1.1e+04  0.0744  0.095 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.15e+04   0.446  0.503 
            5         1.09e+04   1.16e+04   0.164  0.202 
            10        1.07e+04   1.14e+04   0.101  0.126 
            15        1.04e+04    1.1e+04  0.0744  0.095 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11302.116 K
            Expected t_inner for next iteration = 10085.929 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11302.116 K
            Expected t_inner for next iteration = 10085.929 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################                                                           10524/40000 [00:00<00:00, 89259.82it/s]
    Packets:   ########################################3                                       20178/40000 [00:00<00:00, 93241.61it/s]
    Packets:   ###########################################################5                    29778/40000 [00:00<00:00, 94450.55it/s]    Iterations:############################                                                    7/20 [00:04<00:07,  1.64it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.572e+42 erg / s
            Luminosity absorbed  = 2.697e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.572e+42 erg / s
            Luminosity absorbed  = 2.697e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.06e+04  0.503   0.445
            5         1.16e+04    1.1e+04  0.202   0.161
            10        1.14e+04   1.09e+04  0.126  0.0979
            15         1.1e+04   1.05e+04  0.095  0.0744
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.06e+04  0.503   0.445
            5         1.16e+04    1.1e+04  0.202   0.161
            10        1.14e+04   1.09e+04  0.126  0.0979
            15         1.1e+04   1.05e+04  0.095  0.0744

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10085.929 K
            Expected t_inner for next iteration = 11211.594 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10085.929 K
            Expected t_inner for next iteration = 11211.594 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9874/40000 [00:00<00:00, 98728.32it/s]
    Packets:   #######################################4                                        19748/40000 [00:00<00:00, 98535.98it/s]
    Packets:   ###########################################################2                    29602/40000 [00:00<00:00, 97746.81it/s]    Iterations:################################                                                8/20 [00:04<00:07,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.298e+43 erg / s
            Luminosity absorbed  = 4.218e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.298e+43 erg / s
            Luminosity absorbed  = 4.218e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.445   0.505
            5          1.1e+04   1.16e+04   0.161   0.196
            10        1.09e+04   1.15e+04  0.0979   0.121
            15        1.05e+04    1.1e+04  0.0744  0.0914
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.445   0.505
            5          1.1e+04   1.16e+04   0.161   0.196
            10        1.09e+04   1.15e+04  0.0979   0.121
            15        1.05e+04    1.1e+04  0.0744  0.0914

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11211.594 K
            Expected t_inner for next iteration = 10128.276 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11211.594 K
            Expected t_inner for next iteration = 10128.276 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################9                                                            9996/40000 [00:00<00:00, 99937.70it/s]
    Packets:   ########################################3                                       20168/40000 [00:00<00:00, 100975.45it/s]
    Packets:   ############################################################6                   30314/40000 [00:00<00:00, 101193.75it/s]    Iterations:####################################                                            9/20 [00:05<00:06,  1.64it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.684e+42 erg / s
            Luminosity absorbed  = 2.772e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.684e+42 erg / s
            Luminosity absorbed  = 2.772e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.505   0.448
            5         1.16e+04   1.11e+04   0.196   0.161
            10        1.15e+04   1.09e+04   0.121   0.099
            15         1.1e+04   1.05e+04  0.0914  0.0758
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.505   0.448
            5         1.16e+04   1.11e+04   0.196   0.161
            10        1.15e+04   1.09e+04   0.121   0.099
            15         1.1e+04   1.05e+04  0.0914  0.0758

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10128.276 K
            Expected t_inner for next iteration = 11186.412 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10128.276 K
            Expected t_inner for next iteration = 11186.412 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################2                                                           10120/40000 [00:00<00:00, 100919.30it/s]
    Packets:   ########################################7                                       20366/40000 [00:00<00:00, 101803.22it/s]
    Packets:   #############################################################4                  30706/40000 [00:00<00:00, 102525.72it/s]    Iterations:########################################                                        10/20 [00:05<00:06,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.287e+43 erg / s
            Luminosity absorbed  = 4.172e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.287e+43 erg / s
            Luminosity absorbed  = 4.172e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.448   0.497
            5         1.11e+04   1.17e+04   0.161   0.194
            10        1.09e+04   1.14e+04   0.099   0.123
            15        1.05e+04    1.1e+04  0.0758  0.0922
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.448   0.497
            5         1.11e+04   1.17e+04   0.161   0.194
            10        1.09e+04   1.14e+04   0.099   0.123
            15        1.05e+04    1.1e+04  0.0758  0.0922

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11186.412 K
            Expected t_inner for next iteration = 10148.420 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11186.412 K
            Expected t_inner for next iteration = 10148.420 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################5                                                           10254/40000 [00:00<00:00, 100226.03it/s]
    Packets:   ########################################7                                       20364/40000 [00:00<00:00, 100734.09it/s]
    Packets:   ############################################################8                   30438/40000 [00:00<00:00, 100256.33it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.762e+42 erg / s
            Luminosity absorbed  = 2.788e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.762e+42 erg / s
            Luminosity absorbed  = 2.788e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.497   0.447
            5         1.17e+04   1.11e+04   0.194    0.16
            10        1.14e+04   1.09e+04   0.123     0.1
            15         1.1e+04   1.05e+04  0.0922  0.0757
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.497   0.447
            5         1.17e+04   1.11e+04   0.194    0.16
            10        1.14e+04   1.09e+04   0.123     0.1
            15         1.1e+04   1.05e+04  0.0922  0.0757

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10148.420 K
            Expected t_inner for next iteration = 11158.104 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10148.420 K
            Expected t_inner for next iteration = 11158.104 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################3                                                           10162/40000 [00:00<00:00, 101611.13it/s]
    Packets:   #########################################1                                      20556/40000 [00:00<00:00, 102979.33it/s]
    Packets:   #############################################################7                  30854/40000 [00:00<00:00, 101874.85it/s]    Iterations:################################################                                12/20 [00:07<00:04,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.268e+43 erg / s
            Luminosity absorbed  = 4.193e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.268e+43 erg / s
            Luminosity absorbed  = 4.193e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.447   0.484
            5         1.11e+04   1.17e+04    0.16   0.185
            10        1.09e+04   1.14e+04     0.1   0.118
            15        1.05e+04   1.11e+04  0.0757  0.0883
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.15e+04   0.447   0.484
            5         1.11e+04   1.17e+04    0.16   0.185
            10        1.09e+04   1.14e+04     0.1   0.118
            15        1.05e+04   1.11e+04  0.0757  0.0883

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11158.104 K
            Expected t_inner for next iteration = 10199.159 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11158.104 K
            Expected t_inner for next iteration = 10199.159 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################3                                                           10190/40000 [00:00<00:00, 101304.25it/s]
    Packets:   ########################################6                                       20322/40000 [00:00<00:00, 99367.37it/s] 
    Packets:   #############################################################                   30542/40000 [00:00<00:00, 100641.10it/s]    Iterations:####################################################                            13/20 [00:07<00:04,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.924e+42 erg / s
            Luminosity absorbed  = 2.856e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.924e+42 erg / s
            Luminosity absorbed  = 2.856e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.484   0.445
            5         1.17e+04   1.11e+04   0.185   0.162
            10        1.14e+04   1.08e+04   0.118   0.103
            15        1.11e+04   1.05e+04  0.0883  0.0779
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.484   0.445
            5         1.17e+04   1.11e+04   0.185   0.162
            10        1.14e+04   1.08e+04   0.118   0.103
            15        1.11e+04   1.05e+04  0.0883  0.0779

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10199.159 K
            Expected t_inner for next iteration = 11112.055 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10199.159 K
            Expected t_inner for next iteration = 11112.055 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################1                                                           10074/40000 [00:00<00:00, 100735.29it/s]
    Packets:   ########################################4                                       20212/40000 [00:00<00:00, 101102.25it/s]
    Packets:   ############################################################7                   30374/40000 [00:00<00:00, 101330.86it/s]    Iterations:########################################################                        14/20 [00:08<00:03,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.253e+43 erg / s
            Luminosity absorbed  = 4.072e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.253e+43 erg / s
            Luminosity absorbed  = 4.072e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.445   0.489
            5         1.11e+04   1.16e+04   0.162   0.188
            10        1.08e+04   1.14e+04   0.103   0.118
            15        1.05e+04    1.1e+04  0.0779  0.0898
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.445   0.489
            5         1.11e+04   1.16e+04   0.162   0.188
            10        1.08e+04   1.14e+04   0.103   0.118
            15        1.05e+04    1.1e+04  0.0779  0.0898

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11112.055 K
            Expected t_inner for next iteration = 10217.737 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11112.055 K
            Expected t_inner for next iteration = 10217.737 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################2                                                           10134/40000 [00:00<00:00, 100422.85it/s]
    Packets:   ########################################7                                       20370/40000 [00:00<00:00, 101554.73it/s]
    Packets:   #############################################################                   30526/40000 [00:00<00:00, 101190.87it/s]    Iterations:############################################################                    15/20 [00:08<00:03,  1.65it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.979e+42 erg / s
            Luminosity absorbed  = 2.887e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.979e+42 erg / s
            Luminosity absorbed  = 2.887e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.489   0.447
            5         1.16e+04   1.12e+04   0.188    0.16
            10        1.14e+04   1.09e+04   0.118   0.102
            15         1.1e+04   1.05e+04  0.0898  0.0785
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.489   0.447
            5         1.16e+04   1.12e+04   0.188    0.16
            10        1.14e+04   1.09e+04   0.118   0.102
            15         1.1e+04   1.05e+04  0.0898  0.0785

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10217.737 K
            Expected t_inner for next iteration = 11098.110 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10217.737 K
            Expected t_inner for next iteration = 11098.110 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################1                                                          10586/40000 [00:00<00:00, 105853.54it/s]
    Packets:   ##########################################3                                     21172/40000 [00:00<00:00, 105485.78it/s]
    Packets:   ###############################################################4                31732/40000 [00:00<00:00, 105531.58it/s]    Iterations:################################################################                16/20 [00:09<00:02,  1.66it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.245e+43 erg / s
            Luminosity absorbed  = 4.062e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.245e+43 erg / s
            Luminosity absorbed  = 4.062e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.447   0.489
            5         1.12e+04   1.17e+04    0.16   0.184
            10        1.09e+04   1.13e+04   0.102   0.121
            15        1.05e+04    1.1e+04  0.0785  0.0886
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.447   0.489
            5         1.12e+04   1.17e+04    0.16   0.184
            10        1.09e+04   1.13e+04   0.102   0.121
            15        1.05e+04    1.1e+04  0.0785  0.0886

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11098.110 K
            Expected t_inner for next iteration = 10236.448 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11098.110 K
            Expected t_inner for next iteration = 10236.448 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #####################1                                                          10554/40000 [00:00<00:00, 96764.55it/s]
    Packets:   ########################################4                                       20232/40000 [00:00<00:00, 96632.01it/s]
    Packets:   ###########################################################7                    29896/40000 [00:00<00:00, 86100.08it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.065e+42 erg / s
            Luminosity absorbed  = 2.890e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.065e+42 erg / s
            Luminosity absorbed  = 2.890e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.489   0.443
            5         1.17e+04   1.11e+04   0.184   0.163
            10        1.13e+04   1.09e+04   0.121   0.103
            15         1.1e+04   1.05e+04  0.0886  0.0768
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.489   0.443
            5         1.17e+04   1.11e+04   0.184   0.163
            10        1.13e+04   1.09e+04   0.121   0.103
            15         1.1e+04   1.05e+04  0.0886  0.0768

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10236.448 K
            Expected t_inner for next iteration = 11065.616 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10236.448 K
            Expected t_inner for next iteration = 11065.616 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################8                                                            9926/40000 [00:00<00:00, 99255.13it/s]
    Packets:   #######################################7                                        19852/40000 [00:00<00:00, 98742.63it/s]
    Packets:   ###########################################################6                    29810/40000 [00:00<00:00, 99118.46it/s]    Iterations:########################################################################        18/20 [00:10<00:01,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.231e+43 erg / s
            Luminosity absorbed  = 4.008e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.231e+43 erg / s
            Luminosity absorbed  = 4.008e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.14e+04   0.443   0.487
            5         1.11e+04   1.17e+04   0.163   0.182
            10        1.09e+04   1.14e+04   0.103   0.116
            15        1.05e+04    1.1e+04  0.0768  0.0893
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.14e+04   0.443   0.487
            5         1.11e+04   1.17e+04   0.163   0.182
            10        1.09e+04   1.14e+04   0.103   0.116
            15        1.05e+04    1.1e+04  0.0768  0.0893

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11065.616 K
            Expected t_inner for next iteration = 10263.858 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11065.616 K
            Expected t_inner for next iteration = 10263.858 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################8                                                            9914/40000 [00:00<00:00, 98895.11it/s]
    Packets:   #######################################7                                        19880/40000 [00:00<00:00, 99335.04it/s]
    Packets:   ############################################################3                   30180/40000 [00:00<00:00, 101003.17it/s]    Iterations:############################################################################    19/20 [00:11<00:00,  1.63it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.116e+42 erg / s
            Luminosity absorbed  = 2.965e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.116e+42 erg / s
            Luminosity absorbed  = 2.965e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.487   0.449
            5         1.17e+04   1.11e+04   0.182   0.166
            10        1.14e+04   1.09e+04   0.116   0.101
            15         1.1e+04   1.05e+04  0.0893  0.0793
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.487   0.449
            5         1.17e+04   1.11e+04   0.182   0.166
            10        1.14e+04   1.09e+04   0.116   0.101
            15         1.1e+04   1.05e+04  0.0893  0.0793

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10263.858 K
            Expected t_inner for next iteration = 11064.077 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10263.858 K
            Expected t_inner for next iteration = 11064.077 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]               
    Packets:   ########                                                                        10102/100000 [00:00<00:02, 33087.91it/s]
    Packets:   ##########7                                                                     13412/100000 [00:00<00:02, 33061.35it/s]
    Packets:   #############5                                                                  16886/100000 [00:00<00:02, 33548.14it/s]
    Packets:   ################2                                                               20272/100000 [00:00<00:02, 33632.62it/s]
    Packets:   ##################9                                                             23652/100000 [00:00<00:02, 33054.37it/s]
    Packets:   #####################7                                                          27162/100000 [00:00<00:02, 33666.16it/s]
    Packets:   ########################4                                                       30540/100000 [00:00<00:02, 33495.79it/s]
    Packets:   ###########################1                                                    33916/100000 [00:01<00:01, 33572.48it/s]
    Packets:   #############################8                                                  37278/100000 [00:01<00:01, 33094.50it/s]
    Packets:   ################################4                                               40590/100000 [00:01<00:01, 32594.15it/s]
    Packets:   ###################################                                             43872/100000 [00:01<00:01, 32654.21it/s]
    Packets:   #####################################7                                          47140/100000 [00:01<00:01, 31282.90it/s]
    Packets:   ########################################3                                       50378/100000 [00:01<00:01, 31596.45it/s]
    Packets:   ##########################################9                                     53712/100000 [00:01<00:01, 32103.48it/s]
    Packets:   #############################################6                                  57024/100000 [00:01<00:01, 32400.09it/s]
    Packets:   ################################################2                               60338/100000 [00:01<00:01, 32618.09it/s]
    Packets:   ##################################################9                             63748/100000 [00:01<00:01, 33055.44it/s]
    Packets:   #####################################################6                          67112/100000 [00:02<00:00, 33227.87it/s]
    Packets:   ########################################################4                       70556/100000 [00:02<00:00, 33589.27it/s]
    Packets:   ###########################################################1                    73918/100000 [00:02<00:00, 33357.14it/s]
    Packets:   #############################################################8                  77256/100000 [00:02<00:00, 33289.68it/s]
    Packets:   ################################################################6               80790/100000 [00:02<00:00, 33900.17it/s]
    Packets:   ###################################################################4            84254/100000 [00:02<00:00, 34116.29it/s]
    Packets:   #######################################################################5        89476/100000 [00:02<00:00, 39527.82it/s]
    Packets:   ############################################################################2   95250/100000 [00:02<00:00, 44976.23it/s]    Iterations:################################################################################20/20 [00:14<00:00,  1.43s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.230e+43 erg / s
            Luminosity absorbed  = 4.008e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.230e+43 erg / s
            Luminosity absorbed  = 4.008e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 40.88 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 40.88 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:22<00:00, 44976.23it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  52.289 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
