
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ###################3                                                            9682/40000 [00:00<00:00, 96816.40it/s]
    Packets:   ######################################8                                         19410/40000 [00:00<00:00, 97086.57it/s]
    Packets:   ###########################################################2                    29610/40000 [00:00<00:00, 99317.27it/s]    Iterations:####                                                                            1/20 [00:00<00:08,  2.22it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.508
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.508
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0869

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################8                                                            9932/40000 [00:00<00:00, 96455.16it/s]
    Packets:   #######################################4                                        19742/40000 [00:00<00:00, 97406.08it/s]
    Packets:   ###########################################################3                    29698/40000 [00:00<00:00, 98382.07it/s]    Iterations:########                                                                        2/20 [00:01<00:10,  1.80it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.801e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.801e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.508  0.547 
            5         1.02e+04   1.15e+04   0.197  0.224 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.508  0.547 
            5         1.02e+04   1.15e+04   0.197  0.224 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0869  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9961.583 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9961.583 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################6                                                            9840/40000 [00:00<00:00, 89456.38it/s]
    Packets:   #####################################9                                          18988/40000 [00:00<00:00, 90596.19it/s]
    Packets:   ########################################################2                       28118/40000 [00:00<00:00, 90906.69it/s]    Iterations:############                                                                    3/20 [00:01<00:10,  1.68it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.172e+42 erg / s
            Luminosity absorbed  = 2.552e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.172e+42 erg / s
            Luminosity absorbed  = 2.552e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547   0.441
            5         1.15e+04   1.08e+04  0.224   0.164
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0791
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.547   0.441
            5         1.15e+04   1.08e+04  0.224   0.164
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.02e+04  0.101  0.0791

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9961.583 K
            Expected t_inner for next iteration = 11341.574 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9961.583 K
            Expected t_inner for next iteration = 11341.574 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################1                                                             9094/40000 [00:00<00:00, 74770.99it/s]
    Packets:   ####################################2                                           18118/40000 [00:00<00:00, 83123.25it/s]
    Packets:   #######################################################2                        27642/40000 [00:00<00:00, 88391.60it/s]    Iterations:################                                                                4/20 [00:02<00:09,  1.61it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.355e+43 erg / s
            Luminosity absorbed  = 4.463e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.355e+43 erg / s
            Luminosity absorbed  = 4.463e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.441   0.498
            5         1.08e+04   1.17e+04   0.164   0.199
            10        1.06e+04   1.14e+04   0.102   0.126
            15        1.02e+04    1.1e+04  0.0791  0.0956
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.441   0.498
            5         1.08e+04   1.17e+04   0.164   0.199
            10        1.06e+04   1.14e+04   0.102   0.126
            15        1.02e+04    1.1e+04  0.0791  0.0956

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11341.574 K
            Expected t_inner for next iteration = 10028.841 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11341.574 K
            Expected t_inner for next iteration = 10028.841 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   #################8                                                              8930/40000 [00:00<00:00, 89289.23it/s]
    Packets:   ####################################                                            18032/40000 [00:00<00:00, 90302.64it/s]
    Packets:   ######################################################1                         27064/40000 [00:00<00:00, 85275.68it/s]
    Packets:   ##############################################################################1 39052/40000 [00:00<00:00, 98460.87it/s]    Iterations:####################                                                            5/20 [00:03<00:09,  1.56it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.334e+42 erg / s
            Luminosity absorbed  = 2.678e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.334e+42 erg / s
            Luminosity absorbed  = 2.678e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.498   0.439
            5         1.17e+04    1.1e+04   0.199    0.16
            10        1.14e+04   1.08e+04   0.126  0.0993
            15         1.1e+04   1.04e+04  0.0956  0.0763
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.498   0.439
            5         1.17e+04    1.1e+04   0.199    0.16
            10        1.14e+04   1.08e+04   0.126  0.0993
            15         1.1e+04   1.04e+04  0.0956  0.0763

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10028.841 K
            Expected t_inner for next iteration = 11306.348 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10028.841 K
            Expected t_inner for next iteration = 11306.348 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################8                                                            9914/40000 [00:00<00:00, 85440.45it/s]
    Packets:   ######################################7                                         19380/40000 [00:00<00:00, 90521.21it/s]
    Packets:   #########################################################5                      28766/40000 [00:00<00:00, 91992.37it/s]    Iterations:########################                                                        6/20 [00:03<00:08,  1.56it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.334e+43 erg / s
            Luminosity absorbed  = 4.441e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.334e+43 erg / s
            Luminosity absorbed  = 4.441e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.16e+04   0.439     0.5
            5          1.1e+04   1.17e+04    0.16   0.201
            10        1.08e+04   1.14e+04  0.0993   0.124
            15        1.04e+04    1.1e+04  0.0763  0.0963
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.16e+04   0.439     0.5
            5          1.1e+04   1.17e+04    0.16   0.201
            10        1.08e+04   1.14e+04  0.0993   0.124
            15        1.04e+04    1.1e+04  0.0763  0.0963

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11306.348 K
            Expected t_inner for next iteration = 10074.657 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11306.348 K
            Expected t_inner for next iteration = 10074.657 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################8                                                             9428/40000 [00:00<00:00, 94272.90it/s]
    Packets:   #####################################7                                          18856/40000 [00:00<00:00, 93325.88it/s]
    Packets:   ########################################################5                       28284/40000 [00:00<00:00, 93756.34it/s]
    Packets:   ###############################################################################339690/40000 [00:00<00:00, 101741.79it/s]    Iterations:############################                                                    7/20 [00:04<00:08,  1.56it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.515e+42 erg / s
            Luminosity absorbed  = 2.703e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.515e+42 erg / s
            Luminosity absorbed  = 2.703e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04     0.5   0.442
            5         1.17e+04    1.1e+04   0.201   0.159
            10        1.14e+04   1.07e+04   0.124   0.102
            15         1.1e+04   1.04e+04  0.0963  0.0767
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04     0.5   0.442
            5         1.17e+04    1.1e+04   0.201   0.159
            10        1.14e+04   1.07e+04   0.124   0.102
            15         1.1e+04   1.04e+04  0.0963  0.0767

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10074.657 K
            Expected t_inner for next iteration = 11236.867 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10074.657 K
            Expected t_inner for next iteration = 11236.867 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ####################3                                                           10178/40000 [00:00<00:00, 94599.49it/s]
    Packets:   #######################################2                                        19638/40000 [00:00<00:00, 92950.82it/s]
    Packets:   #########################################################8                      28932/40000 [00:00<00:00, 92171.48it/s]    Iterations:################################                                                8/20 [00:04<00:07,  1.56it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.310e+43 erg / s
            Luminosity absorbed  = 4.256e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.310e+43 erg / s
            Luminosity absorbed  = 4.256e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.442   0.498
            5          1.1e+04   1.17e+04   0.159   0.192
            10        1.07e+04   1.14e+04   0.102   0.123
            15        1.04e+04    1.1e+04  0.0767  0.0924
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.442   0.498
            5          1.1e+04   1.17e+04   0.159   0.192
            10        1.07e+04   1.14e+04   0.102   0.123
            15        1.04e+04    1.1e+04  0.0767  0.0924

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11236.867 K
            Expected t_inner for next iteration = 10104.869 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11236.867 K
            Expected t_inner for next iteration = 10104.869 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################4                                                             9216/40000 [00:00<00:00, 83169.00it/s]
    Packets:   ####################################4                                           18232/40000 [00:00<00:00, 87097.61it/s]
    Packets:   ######################################################1                         27060/40000 [00:00<00:00, 87618.81it/s]    Iterations:####################################                                            9/20 [00:05<00:07,  1.55it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.585e+42 erg / s
            Luminosity absorbed  = 2.767e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.585e+42 erg / s
            Luminosity absorbed  = 2.767e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.498   0.442
            5         1.17e+04   1.09e+04   0.192   0.166
            10        1.14e+04   1.08e+04   0.123   0.101
            15         1.1e+04   1.05e+04  0.0924  0.0745
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.498   0.442
            5         1.17e+04   1.09e+04   0.192   0.166
            10        1.14e+04   1.08e+04   0.123   0.101
            15         1.1e+04   1.05e+04  0.0924  0.0745

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10104.869 K
            Expected t_inner for next iteration = 11224.530 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10104.869 K
            Expected t_inner for next iteration = 11224.530 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ##################7                                                             9372/40000 [00:00<00:00, 93713.16it/s]
    Packets:   #####################################4                                          18744/40000 [00:00<00:00, 92786.71it/s]
    Packets:   ########################################################                        28024/40000 [00:00<00:00, 90626.55it/s]    Iterations:########################################                                        10/20 [00:06<00:06,  1.55it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.311e+43 erg / s
            Luminosity absorbed  = 4.170e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.311e+43 erg / s
            Luminosity absorbed  = 4.170e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.442  0.507 
            5         1.09e+04   1.17e+04   0.166  0.196 
            10        1.08e+04   1.15e+04   0.101  0.121 
            15        1.05e+04   1.11e+04  0.0745  0.091 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.442  0.507 
            5         1.09e+04   1.17e+04   0.166  0.196 
            10        1.08e+04   1.15e+04   0.101  0.121 
            15        1.05e+04   1.11e+04  0.0745  0.091 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11224.530 K
            Expected t_inner for next iteration = 10089.677 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11224.530 K
            Expected t_inner for next iteration = 10089.677 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################                                                             9536/40000 [00:00<00:00, 95345.32it/s]
    Packets:   ######################################6                                         19300/40000 [00:00<00:00, 96692.52it/s]
    Packets:   ##########################################################3                     29182/40000 [00:00<00:00, 97658.12it/s]    Iterations:############################################                                    11/20 [00:06<00:05,  1.57it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.559e+42 erg / s
            Luminosity absorbed  = 2.725e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.559e+42 erg / s
            Luminosity absorbed  = 2.725e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.14e+04   1.06e+04  0.507   0.447
            5         1.17e+04   1.09e+04  0.196   0.165
            10        1.15e+04   1.08e+04  0.121     0.1
            15        1.11e+04   1.04e+04  0.091  0.0753
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.14e+04   1.06e+04  0.507   0.447
            5         1.17e+04   1.09e+04  0.196   0.165
            10        1.15e+04   1.08e+04  0.121     0.1
            15        1.11e+04   1.04e+04  0.091  0.0753

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10089.677 K
            Expected t_inner for next iteration = 11224.735 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10089.677 K
            Expected t_inner for next iteration = 11224.735 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################7                                                            9880/40000 [00:00<00:00, 98770.42it/s]
    Packets:   #######################################6                                        19828/40000 [00:00<00:00, 99187.69it/s]
    Packets:   ###########################################################4                    29748/40000 [00:00<00:00, 97567.15it/s]    Iterations:################################################                                12/20 [00:07<00:05,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.219e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.306e+43 erg / s
            Luminosity absorbed  = 4.219e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.16e+04   0.447   0.487
            5         1.09e+04   1.18e+04   0.165   0.188
            10        1.08e+04   1.14e+04     0.1   0.124
            15        1.04e+04   1.12e+04  0.0753  0.0881
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.16e+04   0.447   0.487
            5         1.09e+04   1.18e+04   0.165   0.188
            10        1.08e+04   1.14e+04     0.1   0.124
            15        1.04e+04   1.12e+04  0.0753  0.0881

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11224.735 K
            Expected t_inner for next iteration = 10108.954 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11224.735 K
            Expected t_inner for next iteration = 10108.954 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################5                                                            9760/40000 [00:00<00:00, 96957.91it/s]
    Packets:   ######################################9                                         19456/40000 [00:00<00:00, 95895.85it/s]
    Packets:   ##########################################################                      29048/40000 [00:00<00:00, 95494.82it/s]    Iterations:####################################################                            13/20 [00:08<00:04,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.662e+42 erg / s
            Luminosity absorbed  = 2.708e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.662e+42 erg / s
            Luminosity absorbed  = 2.708e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.487   0.443
            5         1.18e+04   1.11e+04   0.188   0.159
            10        1.14e+04   1.08e+04   0.124     0.1
            15        1.12e+04   1.06e+04  0.0881  0.0737
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.487   0.443
            5         1.18e+04   1.11e+04   0.188   0.159
            10        1.14e+04   1.08e+04   0.124     0.1
            15        1.12e+04   1.06e+04  0.0881  0.0737

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10108.954 K
            Expected t_inner for next iteration = 11178.833 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10108.954 K
            Expected t_inner for next iteration = 11178.833 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################3                                                            9692/40000 [00:00<00:00, 96911.77it/s]
    Packets:   #######################################                                         19534/40000 [00:00<00:00, 97790.90it/s]
    Packets:   ##########################################################6                     29314/40000 [00:00<00:00, 97602.89it/s]    Iterations:########################################################                        14/20 [00:08<00:03,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.286e+43 erg / s
            Luminosity absorbed  = 4.144e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.286e+43 erg / s
            Luminosity absorbed  = 4.144e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.443   0.497
            5         1.11e+04   1.17e+04   0.159   0.192
            10        1.08e+04   1.14e+04     0.1   0.121
            15        1.06e+04    1.1e+04  0.0737  0.0918
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.14e+04   0.443   0.497
            5         1.11e+04   1.17e+04   0.159   0.192
            10        1.08e+04   1.14e+04     0.1   0.121
            15        1.06e+04    1.1e+04  0.0737  0.0918

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11178.833 K
            Expected t_inner for next iteration = 10146.034 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11178.833 K
            Expected t_inner for next iteration = 10146.034 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################5                                                            9762/40000 [00:00<00:00, 94629.79it/s]
    Packets:   ######################################4                                         19238/40000 [00:00<00:00, 94703.75it/s]
    Packets:   #########################################################4                      28710/40000 [00:00<00:00, 94451.10it/s]    Iterations:############################################################                    15/20 [00:09<00:03,  1.58it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.710e+42 erg / s
            Luminosity absorbed  = 2.825e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.710e+42 erg / s
            Luminosity absorbed  = 2.825e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.497   0.45 
            5         1.17e+04    1.1e+04   0.192  0.167 
            10        1.14e+04   1.09e+04   0.121    0.1 
            15         1.1e+04   1.04e+04  0.0918  0.077 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.497   0.45 
            5         1.17e+04    1.1e+04   0.192  0.167 
            10        1.14e+04   1.09e+04   0.121    0.1 
            15         1.1e+04   1.04e+04  0.0918  0.077 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10146.034 K
            Expected t_inner for next iteration = 11189.181 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10146.034 K
            Expected t_inner for next iteration = 11189.181 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################1                                                            9566/40000 [00:00<00:00, 95656.21it/s]
    Packets:   ######################################7                                         19380/40000 [00:00<00:00, 97105.99it/s]
    Packets:   ##########################################################1                     29098/40000 [00:00<00:00, 97133.90it/s]    Iterations:################################################################                16/20 [00:10<00:02,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.282e+43 erg / s
            Luminosity absorbed  = 4.234e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.282e+43 erg / s
            Luminosity absorbed  = 4.234e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.07e+04   1.14e+04   0.45   0.503
            5          1.1e+04   1.17e+04  0.167   0.187
            10        1.09e+04   1.14e+04    0.1    0.12
            15        1.04e+04   1.11e+04  0.077  0.0887
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.07e+04   1.14e+04   0.45   0.503
            5          1.1e+04   1.17e+04  0.167   0.187
            10        1.09e+04   1.14e+04    0.1    0.12
            15        1.04e+04   1.11e+04  0.077  0.0887

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11189.181 K
            Expected t_inner for next iteration = 10169.023 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11189.181 K
            Expected t_inner for next iteration = 10169.023 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################4                                                            9714/40000 [00:00<00:00, 97090.79it/s]
    Packets:   ######################################8                                         19424/40000 [00:00<00:00, 95856.62it/s]
    Packets:   ##########################################################                      29012/40000 [00:00<00:00, 94566.69it/s]    Iterations:####################################################################            17/20 [00:10<00:01,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.842e+42 erg / s
            Luminosity absorbed  = 2.801e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.842e+42 erg / s
            Luminosity absorbed  = 2.801e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.503   0.444
            5         1.17e+04   1.11e+04   0.187   0.161
            10        1.14e+04    1.1e+04    0.12   0.096
            15        1.11e+04   1.05e+04  0.0887  0.0761
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04   0.503   0.444
            5         1.17e+04   1.11e+04   0.187   0.161
            10        1.14e+04    1.1e+04    0.12   0.096
            15        1.11e+04   1.05e+04  0.0887  0.0761

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10169.023 K
            Expected t_inner for next iteration = 11130.446 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10169.023 K
            Expected t_inner for next iteration = 11130.446 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################                                                             9548/40000 [00:00<00:00, 95465.30it/s]
    Packets:   ######################################1                                         19096/40000 [00:00<00:00, 94934.94it/s]
    Packets:   #########################################################2                      28636/40000 [00:00<00:00, 95146.57it/s]    Iterations:########################################################################        18/20 [00:11<00:01,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.262e+43 erg / s
            Luminosity absorbed  = 4.088e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.262e+43 erg / s
            Luminosity absorbed  = 4.088e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.444  0.495 
            5         1.11e+04   1.16e+04   0.161  0.189 
            10         1.1e+04   1.14e+04   0.096  0.119 
            15        1.05e+04    1.1e+04  0.0761  0.091 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.444  0.495 
            5         1.11e+04   1.16e+04   0.161  0.189 
            10         1.1e+04   1.14e+04   0.096  0.119 
            15        1.05e+04    1.1e+04  0.0761  0.091 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11130.446 K
            Expected t_inner for next iteration = 10197.251 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11130.446 K
            Expected t_inner for next iteration = 10197.251 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]               
    Packets:   ###################                                                             9516/40000 [00:00<00:00, 94714.33it/s]
    Packets:   ######################################5                                         19264/40000 [00:00<00:00, 96335.94it/s]
    Packets:   #########################################################9                      28962/40000 [00:00<00:00, 96622.72it/s]    Iterations:############################################################################    19/20 [00:11<00:00,  1.59it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.930e+42 erg / s
            Luminosity absorbed  = 2.844e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.930e+42 erg / s
            Luminosity absorbed  = 2.844e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.14e+04   1.07e+04  0.495   0.443
            5         1.16e+04    1.1e+04  0.189   0.166
            10        1.14e+04   1.09e+04  0.119  0.0996
            15         1.1e+04   1.04e+04  0.091  0.0784
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.14e+04   1.07e+04  0.495   0.443
            5         1.16e+04    1.1e+04  0.189   0.166
            10        1.14e+04   1.09e+04  0.119  0.0996
            15         1.1e+04   1.04e+04  0.091  0.0784

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10197.251 K
            Expected t_inner for next iteration = 11106.023 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10197.251 K
            Expected t_inner for next iteration = 11106.023 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]              
    Packets:   #######7                                                                        9664/100000 [00:00<00:03, 29380.23it/s]
    Packets:   ##########                                                                      12604/100000 [00:00<00:02, 29257.63it/s]
    Packets:   ############4                                                                   15520/100000 [00:00<00:02, 28700.51it/s]
    Packets:   ##############6                                                                 18360/100000 [00:00<00:02, 28549.33it/s]
    Packets:   #################1                                                              21422/100000 [00:00<00:02, 29162.89it/s]
    Packets:   ###################5                                                            24378/100000 [00:00<00:02, 29280.52it/s]
    Packets:   #####################8                                                          27308/100000 [00:00<00:02, 27663.03it/s]
    Packets:   ########################                                                        30080/100000 [00:01<00:02, 27627.65it/s]
    Packets:   ##########################3                                                     32994/100000 [00:01<00:02, 28064.91it/s]
    Packets:   ############################7                                                   35954/100000 [00:01<00:02, 28511.78it/s]
    Packets:   ###############################1                                                38892/100000 [00:01<00:02, 28765.03it/s]
    Packets:   #################################5                                              41932/100000 [00:01<00:01, 29248.86it/s]
    Packets:   ###################################9                                            44904/100000 [00:01<00:01, 29386.12it/s]
    Packets:   ######################################2                                         47848/100000 [00:01<00:01, 29232.99it/s]
    Packets:   ########################################6                                       50786/100000 [00:01<00:01, 29273.18it/s]
    Packets:   ##########################################9                                     53736/100000 [00:01<00:01, 29329.98it/s]
    Packets:   #############################################3                                  56672/100000 [00:01<00:01, 29226.28it/s]
    Packets:   ###############################################7                                59686/100000 [00:02<00:01, 29496.34it/s]
    Packets:   ##################################################1                             62652/100000 [00:02<00:01, 29543.14it/s]
    Packets:   ####################################################5                           65732/100000 [00:02<00:01, 29917.83it/s]
    Packets:   ######################################################9                         68726/100000 [00:02<00:01, 29871.23it/s]
    Packets:   #########################################################3                      71714/100000 [00:02<00:00, 29531.06it/s]
    Packets:   ###########################################################7                    74696/100000 [00:02<00:00, 29606.83it/s]
    Packets:   ##############################################################1                 77676/100000 [00:02<00:00, 29663.55it/s]
    Packets:   ################################################################5               80664/100000 [00:02<00:00, 29722.58it/s]
    Packets:   ##################################################################9             83662/100000 [00:02<00:00, 29796.41it/s]
    Packets:   ######################################################################5         88154/100000 [00:02<00:00, 34319.28it/s]
    Packets:   ##########################################################################9     93746/100000 [00:03<00:00, 40786.35it/s]
    Packets:   ###############################################################################499296/100000 [00:03<00:00, 45189.34it/s]    Iterations:################################################################################20/20 [00:15<00:00,  1.55s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.246e+43 erg / s
            Luminosity absorbed  = 4.101e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.246e+43 erg / s
            Luminosity absorbed  = 4.101e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 41.67 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 41.67 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:20<00:00, 45189.34it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  54.976 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
