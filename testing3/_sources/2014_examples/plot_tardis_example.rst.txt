
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2014_examples/plot_tardis_example.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2014_examples_plot_tardis_example.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2014_examples_plot_tardis_example.py:


Tardis 2014 Example
==========================

This is the example output

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: default



    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /usr/share/miniconda3/envs/tardis/lib/python3.8/site-packages/setuptools_scm/git.py:135: UserWarning: "/home/runner/work/tardis-setups/tardis-setups/tardis" is shallow and may cause errors
      warnings.warn(f'"{wd.path}" is shallow and may cause errors')
    Iterations:                                                                                0/? [00:00<?, ?it/s]
    Packets:                                                                                   0/? [00:00<?, ?it/s]



.. GENERATED FROM PYTHON SOURCE LINES 20-21

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 21-25

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Configuration File /home/runner/.astropy/config/tardis_internal_config.yml does not exist - creating new one from default
    CRITICAL:root:
    ********************************************************************************

    TARDIS will download different kinds of data (e.g. atomic) to its data directory /home/runner/Downloads/tardis-data

    TARDIS DATA DIRECTORY not specified in /home/runner/.astropy/config/tardis_internal_config.yml:

    ASSUMING DEFAULT DATA DIRECTORY /home/runner/Downloads/tardis-data
     YOU CAN CHANGE THIS AT ANY TIME IN /home/runner/.astropy/config/tardis_internal_config.yml 

    ******************************************************************************** 






.. GENERATED FROM PYTHON SOURCE LINES 26-27

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 27-33

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2014/2014_kerzendorf_sim/appendix_A1/tardis_example.yml"
    )
    conf = config_modifier(conf)








.. GENERATED FROM PYTHON SOURCE LINES 34-37

.. code-block:: default

    sim = run_tardis(conf)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    [tardis.plasma.standard_plasmas][INFO   ]  
        
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5 (standard_plasmas.py:93)
    INFO:tardis.plasma.standard_plasmas:
            Reading Atomic Data from /home/runner/Downloads/tardis-data/kurucz_cd23_chianti_H_He.h5
    [tardis.io.atom_data.base][INFO   ]  
            Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace  (base.py:249)
    INFO:tardis.io.atom_data.base:Reading Atom Data with: UUID = 6f7b09e887a311e7a06b246e96350010 MD5  = 864f1753714343c41f99cb065710cace 
    [tardis.io.atom_data.base][INFO   ]  
            Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data (base.py:253)
    INFO:tardis.io.atom_data.base:Non provided Atomic Data: synpp_refs, photoionization_data, yg_data, two_photon_data
    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 1 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 1 of 20
    Iterations:                                                                                0/20 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:                                                                                   0/40000 [00:00<?, ?it/s]
    Packets:   ########################1                                                       12098/40000 [00:00<00:00, 120974.92it/s]
    Packets:   #################################################1                              24590/40000 [00:00<00:00, 123292.82it/s]
    Packets:   ##############################################################################1 39072/40000 [00:00<00:00, 133118.08it/s]    Iterations:####                                                                            1/20 [00:00<00:06,  2.89it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 7.942e+42 erg / s
            Luminosity absorbed  = 2.659e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.506
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0868
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         9.93e+03   1.01e+04    0.4   0.506
            5         9.85e+03   1.02e+04  0.211   0.197
            10        9.78e+03   1.01e+04  0.143   0.117
            15        9.71e+03   9.87e+03  0.105  0.0868

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9933.952 K
            Expected t_inner for next iteration = 11472.471 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 2 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 2 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################6                                                     13312/40000 [00:00<00:00, 127191.32it/s]
    Packets:   ####################################################                            26032/40000 [00:00<00:00, 127131.67it/s]    Iterations:########                                                                        2/20 [00:00<00:07,  2.34it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.796e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.405e+43 erg / s
            Luminosity absorbed  = 4.796e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.506  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0868  0.101 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.01e+04   1.15e+04   0.506  0.546 
            5         1.02e+04   1.15e+04   0.197  0.223 
            10        1.01e+04   1.13e+04   0.117  0.135 
            15        9.87e+03    1.1e+04  0.0868  0.101 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9959.727 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11472.471 K
            Expected t_inner for next iteration = 9959.727 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 3 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 3 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################4                                                      12714/40000 [00:00<00:00, 124089.87it/s]
    Packets:   ##################################################4                             25206/40000 [00:00<00:00, 124565.58it/s]    Iterations:############                                                                    3/20 [00:01<00:07,  2.20it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.184e+42 erg / s
            Luminosity absorbed  = 2.534e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.184e+42 erg / s
            Luminosity absorbed  = 2.534e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.439
            5         1.15e+04   1.08e+04  0.223   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.03e+04  0.101  0.0771
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.15e+04   1.05e+04  0.546   0.439
            5         1.15e+04   1.08e+04  0.223   0.166
            10        1.13e+04   1.06e+04  0.135   0.102
            15         1.1e+04   1.03e+04  0.101  0.0771

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 9959.727 K
            Expected t_inner for next iteration = 11331.306 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 9959.727 K
            Expected t_inner for next iteration = 11331.306 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 4 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 4 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################8                                                      12922/40000 [00:00<00:00, 129199.18it/s]
    Packets:   ###################################################6                            25842/40000 [00:00<00:00, 128197.82it/s]    Iterations:################                                                                4/20 [00:01<00:07,  2.15it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.350e+43 erg / s
            Luminosity absorbed  = 4.450e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.350e+43 erg / s
            Luminosity absorbed  = 4.450e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.439   0.499
            5         1.08e+04   1.17e+04   0.166   0.196
            10        1.06e+04   1.14e+04   0.102   0.127
            15        1.03e+04   1.11e+04  0.0771  0.0931
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.05e+04   1.16e+04   0.439   0.499
            5         1.08e+04   1.17e+04   0.166   0.196
            10        1.06e+04   1.14e+04   0.102   0.127
            15        1.03e+04   1.11e+04  0.0771  0.0931

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11331.306 K
            Expected t_inner for next iteration = 10039.098 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11331.306 K
            Expected t_inner for next iteration = 10039.098 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 5 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 5 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################6                                                      12822/40000 [00:00<00:00, 120807.17it/s]
    Packets:   #################################################8                              24904/40000 [00:00<00:00, 120757.61it/s]
    Packets:   ###############################################################################639832/40000 [00:00<00:00, 133601.30it/s]    Iterations:####################                                                            5/20 [00:02<00:07,  2.10it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.366e+42 erg / s
            Luminosity absorbed  = 2.691e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.366e+42 erg / s
            Luminosity absorbed  = 2.691e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.499   0.444
            5         1.17e+04   1.09e+04   0.196   0.166
            10        1.14e+04   1.07e+04   0.127   0.101
            15        1.11e+04   1.04e+04  0.0931  0.0758
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.16e+04   1.06e+04   0.499   0.444
            5         1.17e+04   1.09e+04   0.196   0.166
            10        1.14e+04   1.07e+04   0.127   0.101
            15        1.11e+04   1.04e+04  0.0931  0.0758

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10039.098 K
            Expected t_inner for next iteration = 11296.518 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10039.098 K
            Expected t_inner for next iteration = 11296.518 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 6 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 6 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################7                                                     13380/40000 [00:00<00:00, 124083.60it/s]
    Packets:   ###################################################5                            25790/40000 [00:00<00:00, 123584.42it/s]    Iterations:########################                                                        6/20 [00:02<00:06,  2.08it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.332e+43 erg / s
            Luminosity absorbed  = 4.398e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.332e+43 erg / s
            Luminosity absorbed  = 4.398e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.444   0.502
            5         1.09e+04   1.17e+04   0.166   0.201
            10        1.07e+04   1.14e+04   0.101   0.124
            15        1.04e+04   1.11e+04  0.0758  0.0938
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.444   0.502
            5         1.09e+04   1.17e+04   0.166   0.201
            10        1.07e+04   1.14e+04   0.101   0.124
            15        1.04e+04   1.11e+04  0.0758  0.0938

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11296.518 K
            Expected t_inner for next iteration = 10072.761 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11296.518 K
            Expected t_inner for next iteration = 10072.761 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 7 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 7 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################7                                                       12358/40000 [00:00<00:00, 121636.22it/s]
    Packets:   #################################################                               24522/40000 [00:00<00:00, 121528.78it/s]
    Packets:   ###########################################################################8    37940/40000 [00:00<00:00, 127276.99it/s]    Iterations:############################                                                    7/20 [00:03<00:06,  2.06it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.513e+42 erg / s
            Luminosity absorbed  = 2.697e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.513e+42 erg / s
            Luminosity absorbed  = 2.697e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.502   0.443
            5         1.17e+04    1.1e+04   0.201    0.16
            10        1.14e+04   1.07e+04   0.124   0.102
            15        1.11e+04   1.04e+04  0.0938  0.0767
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.502   0.443
            5         1.17e+04    1.1e+04   0.201    0.16
            10        1.14e+04   1.07e+04   0.124   0.102
            15        1.11e+04   1.04e+04  0.0938  0.0767

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10072.761 K
            Expected t_inner for next iteration = 11235.872 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10072.761 K
            Expected t_inner for next iteration = 11235.872 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 8 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 8 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################4                                                      12730/40000 [00:00<00:00, 124435.69it/s]
    Packets:   ##################################################3                             25174/40000 [00:00<00:00, 124303.92it/s]    Iterations:################################                                                8/20 [00:03<00:05,  2.06it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.309e+43 erg / s
            Luminosity absorbed  = 4.256e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.309e+43 erg / s
            Luminosity absorbed  = 4.256e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.505
            5          1.1e+04   1.17e+04    0.16   0.194
            10        1.07e+04   1.14e+04   0.102   0.125
            15        1.04e+04    1.1e+04  0.0767  0.0934
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.443   0.505
            5          1.1e+04   1.17e+04    0.16   0.194
            10        1.07e+04   1.14e+04   0.102   0.125
            15        1.04e+04    1.1e+04  0.0767  0.0934

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11235.872 K
            Expected t_inner for next iteration = 10106.648 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11235.872 K
            Expected t_inner for next iteration = 10106.648 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 9 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 9 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################                                                       12546/40000 [00:00<00:00, 125444.57it/s]
    Packets:   ##################################################9                             25482/40000 [00:00<00:00, 127732.13it/s]
    Packets:   ###############################################################################739868/40000 [00:00<00:00, 135092.74it/s]    Iterations:####################################                                            9/20 [00:04<00:05,  2.06it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.606e+42 erg / s
            Luminosity absorbed  = 2.755e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.606e+42 erg / s
            Luminosity absorbed  = 2.755e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505  0.446 
            5         1.17e+04   1.09e+04   0.194  0.169 
            10        1.14e+04   1.08e+04   0.125  0.102 
            15         1.1e+04   1.04e+04  0.0934  0.076 
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.06e+04   0.505  0.446 
            5         1.17e+04   1.09e+04   0.194  0.169 
            10        1.14e+04   1.08e+04   0.125  0.102 
            15         1.1e+04   1.04e+04  0.0934  0.076 

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10106.648 K
            Expected t_inner for next iteration = 11212.950 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10106.648 K
            Expected t_inner for next iteration = 11212.950 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 10 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 10 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ###########################                                                     13510/40000 [00:00<00:00, 127076.18it/s]
    Packets:   ####################################################6                           26336/40000 [00:00<00:00, 127751.30it/s]    Iterations:########################################                                        10/20 [00:04<00:04,  2.07it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.304e+43 erg / s
            Luminosity absorbed  = 4.166e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.304e+43 erg / s
            Luminosity absorbed  = 4.166e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.06e+04   1.14e+04  0.446   0.504
            5         1.09e+04   1.16e+04  0.169   0.199
            10        1.08e+04   1.14e+04  0.102   0.122
            15        1.04e+04   1.11e+04  0.076  0.0919
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w   next_w
            0         1.06e+04   1.14e+04  0.446   0.504
            5         1.09e+04   1.16e+04  0.169   0.199
            10        1.08e+04   1.14e+04  0.102   0.122
            15        1.04e+04   1.11e+04  0.076  0.0919

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11212.950 K
            Expected t_inner for next iteration = 10105.930 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11212.950 K
            Expected t_inner for next iteration = 10105.930 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 11 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 11 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################5                                                      12778/40000 [00:00<00:00, 124283.31it/s]
    Packets:   ##################################################8                             25400/40000 [00:00<00:00, 125403.83it/s]    Iterations:############################################                                    11/20 [00:05<00:04,  2.07it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.650e+42 erg / s
            Luminosity absorbed  = 2.708e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.650e+42 erg / s
            Luminosity absorbed  = 2.708e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.504   0.451
            5         1.16e+04   1.09e+04   0.199   0.168
            10        1.14e+04   1.08e+04   0.122   0.101
            15        1.11e+04   1.04e+04  0.0919  0.0785
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.06e+04   0.504   0.451
            5         1.16e+04   1.09e+04   0.199   0.168
            10        1.14e+04   1.08e+04   0.122   0.101
            15        1.11e+04   1.04e+04  0.0919  0.0785

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10105.930 K
            Expected t_inner for next iteration = 11183.480 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10105.930 K
            Expected t_inner for next iteration = 11183.480 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 12 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 12 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################                                                       12542/40000 [00:00<00:00, 124368.08it/s]
    Packets:   #################################################9                              24980/40000 [00:00<00:00, 124362.62it/s]    Iterations:################################################                                12/20 [00:05<00:03,  2.06it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.279e+43 erg / s
            Luminosity absorbed  = 4.233e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.279e+43 erg / s
            Luminosity absorbed  = 4.233e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.451   0.489
            5         1.09e+04   1.17e+04   0.168   0.192
            10        1.08e+04   1.14e+04   0.101   0.121
            15        1.04e+04   1.11e+04  0.0785  0.0899
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.06e+04   1.15e+04   0.451   0.489
            5         1.09e+04   1.17e+04   0.168   0.192
            10        1.08e+04   1.14e+04   0.101   0.121
            15        1.04e+04   1.11e+04  0.0785  0.0899

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11183.480 K
            Expected t_inner for next iteration = 10177.243 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11183.480 K
            Expected t_inner for next iteration = 10177.243 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 13 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 13 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################8                                                       12438/40000 [00:00<00:00, 121659.65it/s]
    Packets:   #################################################2                              24604/40000 [00:00<00:00, 121425.54it/s]
    Packets:   ##############################################################################5 39254/40000 [00:00<00:00, 132798.96it/s]    Iterations:####################################################                            13/20 [00:06<00:03,  2.05it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.849e+42 erg / s
            Luminosity absorbed  = 2.830e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.849e+42 erg / s
            Luminosity absorbed  = 2.830e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.489   0.444
            5         1.17e+04   1.11e+04   0.192   0.164
            10        1.14e+04   1.08e+04   0.121   0.103
            15        1.11e+04   1.05e+04  0.0899  0.0772
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.15e+04   1.07e+04   0.489   0.444
            5         1.17e+04   1.11e+04   0.192   0.164
            10        1.14e+04   1.08e+04   0.121   0.103
            15        1.11e+04   1.05e+04  0.0899  0.0772

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10177.243 K
            Expected t_inner for next iteration = 11134.933 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10177.243 K
            Expected t_inner for next iteration = 11134.933 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 14 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 14 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################5                                                     13288/40000 [00:00<00:00, 121096.44it/s]
    Packets:   ###################################################                             25502/40000 [00:00<00:00, 121679.50it/s]    Iterations:########################################################                        14/20 [00:06<00:02,  2.05it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.267e+43 erg / s
            Luminosity absorbed  = 4.065e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.267e+43 erg / s
            Luminosity absorbed  = 4.065e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.444    0.49
            5         1.11e+04   1.16e+04   0.164   0.195
            10        1.08e+04   1.13e+04   0.103   0.122
            15        1.05e+04   1.09e+04  0.0772  0.0926
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.444    0.49
            5         1.11e+04   1.16e+04   0.164   0.195
            10        1.08e+04   1.13e+04   0.103   0.122
            15        1.05e+04   1.09e+04  0.0772  0.0926

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11134.933 K
            Expected t_inner for next iteration = 10179.565 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11134.933 K
            Expected t_inner for next iteration = 10179.565 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 15 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 15 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################5                                                       12282/40000 [00:00<00:00, 122815.14it/s]
    Packets:   #################################################1                              24570/40000 [00:00<00:00, 122847.85it/s]
    Packets:   ##############################################################################7 39390/40000 [00:00<00:00, 134416.97it/s]    Iterations:############################################################                    15/20 [00:07<00:02,  2.05it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.818e+42 erg / s
            Luminosity absorbed  = 2.871e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.818e+42 erg / s
            Luminosity absorbed  = 2.871e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04    0.49   0.456
            5         1.16e+04   1.11e+04   0.195   0.162
            10        1.13e+04   1.09e+04   0.122  0.0998
            15        1.09e+04   1.04e+04  0.0926  0.0787
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04    0.49   0.456
            5         1.16e+04   1.11e+04   0.195   0.162
            10        1.13e+04   1.09e+04   0.122  0.0998
            15        1.09e+04   1.04e+04  0.0926  0.0787

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10179.565 K
            Expected t_inner for next iteration = 11156.981 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10179.565 K
            Expected t_inner for next iteration = 11156.981 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 16 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 16 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ##########################8                                                     13442/40000 [00:00<00:00, 124760.37it/s]
    Packets:   ###################################################8                            25920/40000 [00:00<00:00, 124478.27it/s]    Iterations:################################################################                16/20 [00:07<00:01,  2.05it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.271e+43 erg / s
            Luminosity absorbed  = 4.159e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.271e+43 erg / s
            Luminosity absorbed  = 4.159e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.456   0.494
            5         1.11e+04   1.17e+04   0.162   0.188
            10        1.09e+04   1.14e+04  0.0998   0.119
            15        1.04e+04    1.1e+04  0.0787  0.0901
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.07e+04   1.14e+04   0.456   0.494
            5         1.11e+04   1.17e+04   0.162   0.188
            10        1.09e+04   1.14e+04  0.0998   0.119
            15        1.04e+04    1.1e+04  0.0787  0.0901

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11156.981 K
            Expected t_inner for next iteration = 10186.462 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11156.981 K
            Expected t_inner for next iteration = 10186.462 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 17 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 17 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ########################8                                                       12448/40000 [00:00<00:00, 124442.44it/s]
    Packets:   #################################################8                              24908/40000 [00:00<00:00, 124532.56it/s]
    Packets:   ###############################################################################439724/40000 [00:00<00:00, 135318.64it/s]    Iterations:####################################################################            17/20 [00:08<00:01,  2.05it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 8.888e+42 erg / s
            Luminosity absorbed  = 2.835e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 8.888e+42 erg / s
            Luminosity absorbed  = 2.835e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.494   0.438
            5         1.17e+04   1.11e+04   0.188   0.163
            10        1.14e+04   1.09e+04   0.119  0.0994
            15         1.1e+04   1.05e+04  0.0901  0.0757
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.08e+04   0.494   0.438
            5         1.17e+04   1.11e+04   0.188   0.163
            10        1.14e+04   1.09e+04   0.119  0.0994
            15         1.1e+04   1.05e+04  0.0901  0.0757

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10186.462 K
            Expected t_inner for next iteration = 11120.747 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10186.462 K
            Expected t_inner for next iteration = 11120.747 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 18 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 18 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   ###########################                                                     13532/40000 [00:00<00:00, 126152.33it/s]
    Packets:   ####################################################2                           26148/40000 [00:00<00:00, 125936.24it/s]    Iterations:########################################################################        18/20 [00:08<00:00,  2.06it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.254e+43 erg / s
            Luminosity absorbed  = 4.106e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.254e+43 erg / s
            Luminosity absorbed  = 4.106e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.14e+04   0.438    0.49
            5         1.11e+04   1.17e+04   0.163   0.187
            10        1.09e+04   1.14e+04  0.0994   0.119
            15        1.05e+04    1.1e+04  0.0757  0.0903
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.08e+04   1.14e+04   0.438    0.49
            5         1.11e+04   1.17e+04   0.163   0.187
            10        1.09e+04   1.14e+04  0.0994   0.119
            15        1.05e+04    1.1e+04  0.0757  0.0903

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 11120.747 K
            Expected t_inner for next iteration = 10220.063 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 11120.747 K
            Expected t_inner for next iteration = 10220.063 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 19 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 19 of 20

    Packets:                                                                                   0/40000 [00:00<?, ?it/s]                
    Packets:   #########################1                                                      12594/40000 [00:00<00:00, 122367.39it/s]
    Packets:   #################################################8                              24926/40000 [00:00<00:00, 122916.05it/s]
    Packets:   ###############################################################################539794/40000 [00:00<00:00, 134597.60it/s]    Iterations:############################################################################    19/20 [00:09<00:00,  2.06it/s][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 9.022e+42 erg / s
            Luminosity absorbed  = 2.858e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 9.022e+42 erg / s
            Luminosity absorbed  = 2.858e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Plasma stratification: (base.py:539)
    INFO:tardis.simulation.base:
            Plasma stratification:
    [tardis.simulation.base][INFO   ]  
        
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04    0.49   0.448
            5         1.17e+04   1.11e+04   0.187   0.161
            10        1.14e+04   1.09e+04   0.119     0.1
            15         1.1e+04   1.05e+04  0.0903  0.0786
     (base.py:540)
    INFO:tardis.simulation.base:
            Shell No.   t_rad   next_t_rad    w    next_w
            0         1.14e+04   1.07e+04    0.49   0.448
            5         1.17e+04   1.11e+04   0.187   0.161
            10        1.14e+04   1.09e+04   0.119     0.1
            15         1.1e+04   1.05e+04  0.0903  0.0786

    [tardis.simulation.base][INFO   ]  
        
            Current t_inner = 10220.063 K
            Expected t_inner for next iteration = 11074.241 K
     (base.py:542)
    INFO:tardis.simulation.base:
            Current t_inner = 10220.063 K
            Expected t_inner for next iteration = 11074.241 K

    [py.warnings         ][WARNING]  
            /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
     (warnings.py:109)
    WARNING:py.warnings:/home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)

    [tardis.simulation.base][INFO   ]  
        
            Starting iteration 20 of 20 (base.py:378)
    INFO:tardis.simulation.base:
            Starting iteration 20 of 20

    Packets:                                                                                   0/100000 [00:00<?, ?it/s]               
    Packets:   ##########7                                                                     13468/100000 [00:00<00:02, 40408.78it/s]
    Packets:   ##############                                                                  17510/100000 [00:00<00:02, 40411.90it/s]
    Packets:   #################2                                                              21552/100000 [00:00<00:01, 40241.60it/s]
    Packets:   ####################4                                                           25576/100000 [00:00<00:01, 40239.01it/s]
    Packets:   #######################6                                                        29602/100000 [00:00<00:01, 40242.26it/s]
    Packets:   ##########################9                                                     33676/100000 [00:00<00:01, 40389.15it/s]
    Packets:   ##############################1                                                 37716/100000 [00:00<00:01, 40113.27it/s]
    Packets:   #################################3                                              41726/100000 [00:01<00:01, 39903.14it/s]
    Packets:   ####################################5                                           45724/100000 [00:01<00:01, 39923.03it/s]
    Packets:   #######################################7                                        49724/100000 [00:01<00:01, 39939.47it/s]
    Packets:   ##########################################9                                     53746/100000 [00:01<00:01, 40023.18it/s]
    Packets:   ##############################################2                                 57772/100000 [00:01<00:01, 40090.55it/s]
    Packets:   #################################################4                              61782/100000 [00:01<00:00, 40025.42it/s]
    Packets:   ####################################################6                           65786/100000 [00:01<00:00, 39947.57it/s]
    Packets:   #######################################################8                        69838/100000 [00:01<00:00, 40113.44it/s]
    Packets:   ###########################################################                     73850/100000 [00:01<00:00, 39431.76it/s]
    Packets:   ##############################################################2                 77872/100000 [00:01<00:00, 39664.43it/s]
    Packets:   #################################################################4              81842/100000 [00:02<00:00, 39671.53it/s]
    Packets:   ####################################################################6           85812/100000 [00:02<00:00, 39132.95it/s]
    Packets:   ########################################################################2       90258/100000 [00:02<00:00, 40706.78it/s]
    Packets:   #############################################################################3  96714/100000 [00:02<00:00, 47788.70it/s]    Iterations:################################################################################20/20 [00:11<00:00,  1.18s/it][tardis.simulation.base][INFO   ]  
        
            Luminosity emitted   = 1.235e+43 erg / s
            Luminosity absorbed  = 4.023e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s
     (base.py:547)
    INFO:tardis.simulation.base:
            Luminosity emitted   = 1.235e+43 erg / s
            Luminosity absorbed  = 4.023e+42 erg / s
            Luminosity requested = 1.059e+43 erg / s

    [tardis.simulation.base][INFO   ]  
        
            Simulation finished in 20 iterations 
            Simulation took 34.31 s
     (base.py:468)
    INFO:tardis.simulation.base:
            Simulation finished in 20 iterations 
            Simulation took 34.31 s





.. GENERATED FROM PYTHON SOURCE LINES 38-54

.. code-block:: default

    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")

    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2014_examples/images/sphx_glr_plot_tardis_example_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:356: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(

    Packets:   ################################################################################100000/100000 [00:18<00:00, 47788.70it/s]




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 1 minutes  38.348 seconds)


.. _sphx_glr_download_2014_examples_plot_tardis_example.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_tardis_example.py <plot_tardis_example.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_tardis_example.ipynb <plot_tardis_example.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
