
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "2020_examples/plot_22d.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_2020_examples_plot_22d.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_2020_examples_plot_22d.py:


Williamson et al. (2020) Figure 2 t_explosion=22 days
==========================


Article: Williamson, Marc, Kerzendorf, Wolfgang, Modjaz, Maryam 2021, ApJ,
“Modeling Type Ic Supernovae with TARDIS: Hidden Helium in SN 1994I?” (`ADS Link`_).

Original Input Files: `YAML`_, `CSVY`_

Original Atomic Dataset: Data missing

Original Spectra: Data missing

Notes: Please note that the spectra obtained below is obtained by using a slightly
modified configuration file. This is done to ensure that the spectra can be
obtained using the computers hosted by us.

.. _ADS Link: https://ui.adsabs.harvard.edu/abs/2021ApJ...908..150W
.. _YAML: https://github.com/tardis-sn/tardis-setups/blob/master/2020/2020_williamson_94I/code_comp_setups/22d.yml
.. _CSVY: https://github.com/tardis-sn/tardis-setups/blob/master/2020/2020_williamson_94I/code_comp_setups/hach_exact_csvy_22d.csvy

.. GENERATED FROM PYTHON SOURCE LINES 23-34

.. code-block:: default


    from tardis import run_tardis
    from tardis.io.config_reader import Configuration
    from tardis.io.atom_data.util import download_atom_data
    import matplotlib.pyplot as plt

    import sys

    sys.path.append("../")
    from setup_utils import config_modifier








.. GENERATED FROM PYTHON SOURCE LINES 35-36

Uncomment this line if you need to download the dataset.

.. GENERATED FROM PYTHON SOURCE LINES 36-40

.. code-block:: default



    download_atom_data("kurucz_cd23_chianti_H_He")








.. GENERATED FROM PYTHON SOURCE LINES 41-42

Runs the example

.. GENERATED FROM PYTHON SOURCE LINES 42-47

.. code-block:: default


    conf = Configuration.from_yaml(
        "../../2020/2020_williamson_94I/code_comp_setups/22d.yml"
    )
    conf = config_modifier(conf)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Config
    None




.. GENERATED FROM PYTHON SOURCE LINES 48-77

.. code-block:: default

    sim = run_tardis(conf)


    spectrum = sim.runner.spectrum
    spectrum_virtual = sim.runner.spectrum_virtual
    spectrum_integrated = sim.runner.spectrum_integrated

    plt.figure(figsize=(10, 6.5))

    spectrum.plot(label="Normal packets")
    spectrum_virtual.plot(label="Virtual packets")
    spectrum_integrated.plot(label="Formal integral")
    import numpy as np

    t1 = np.loadtxt("codecomp_spectra.txt", unpack=True)
    print(t1)
    from astropy import units as u

    conversion = 4 * np.pi * 9.55 * 9.55 * u.Mpc.to(u.cm) ** 2.0

    plt.plot(t1[0], t1[2] * conversion, label="Original result", color="black")


    plt.xlim(500, 9000)
    plt.title("TARDIS example model spectrum")
    plt.xlabel("Wavelength [$\AA$]")
    plt.ylabel("Luminosity density [erg/s/$\AA$]")
    plt.legend()
    plt.show()



.. image-sg:: /2020_examples/images/sphx_glr_plot_22d_001.png
   :alt: TARDIS example model spectrum
   :srcset: /2020_examples/images/sphx_glr_plot_22d_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: divide by zero encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/plasma/properties/radiative_properties.py:93: RuntimeWarning: invalid value encountered in true_divide
      (g_lower * n_upper) / (g_upper * n_lower)
    /home/runner/work/tardis-setups/tardis-setups/tardis/tardis/montecarlo/montecarlo_numba/formal_integral.py:357: UserWarning: The number of interpolate_shells was not specified. The value was set to 80.
      warnings.warn(
    [[2.50000000e+04 2.48780973e+04 2.47573777e+04 ... 5.00147043e+02
      5.00098019e+02 5.00049005e+02]
     [5.09797220e-16 5.26054737e-16 5.25035476e-16 ... 0.00000000e+00
      0.00000000e+00 0.00000000e+00]
     [1.95892059e-16 1.98354698e-16 1.97070300e-16 ... 0.00000000e+00
      0.00000000e+00 0.00000000e+00]
     [9.38409828e-17 8.77762554e-17 9.17587028e-17 ... 0.00000000e+00
      0.00000000e+00 0.00000000e+00]
     [7.17473089e-17 6.79728236e-17 6.98210722e-17 ... 0.00000000e+00
      6.12779770e-17 5.54853710e-17]]





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 9 minutes  46.986 seconds)


.. _sphx_glr_download_2020_examples_plot_22d.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_22d.py <plot_22d.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_22d.ipynb <plot_22d.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
